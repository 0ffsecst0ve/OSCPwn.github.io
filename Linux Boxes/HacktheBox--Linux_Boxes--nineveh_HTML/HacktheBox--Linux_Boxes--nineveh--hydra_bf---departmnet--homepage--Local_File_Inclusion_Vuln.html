<!doctype html><html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Local File Inclusion Vuln</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="styles.css" type="text/css" />
</head>
<body><div class="main"><div class="tree">
<p><strong>Index</strong></p>
<p><a href="HacktheBox--Linux_Boxes--nineveh.html">nineveh</a></p>

<ol>
<li><a href="HacktheBox--Linux_Boxes--nineveh--nmap.html">nmap</a></li>
<li><a href="HacktheBox--Linux_Boxes--nineveh--http-https.html">http/https</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--nineveh--http-https--cert.html">cert</a></li>
<li><a href="HacktheBox--Linux_Boxes--nineveh--http-https--gobuster.html">gobuster</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--nineveh--http-https--gobuster--http.html">http</a></li>
<li><a href="HacktheBox--Linux_Boxes--nineveh--http-https--gobuster--https.html">https</a></li>
</ol>
</ol>
<li><a href="HacktheBox--Linux_Boxes--nineveh--hydra_bf.html">hydra bf</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--nineveh--hydra_bf---departmnet.html">/departmnet</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--nineveh--hydra_bf---departmnet--homepage.html">homepage</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--nineveh--hydra_bf---departmnet--homepage--notes.html">notes</a></li>
<li><a href="HacktheBox--Linux_Boxes--nineveh--hydra_bf---departmnet--homepage--Local_File_Inclusion_Vuln.html">Local File Inclusion Vuln</a></li>
</ol>
</ol>
<li><a href="HacktheBox--Linux_Boxes--nineveh--hydra_bf---db.html">/db</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--nineveh--hydra_bf---db--pass.html">pass</a></li>
</ol>
</ol>
<li><a href="HacktheBox--Linux_Boxes--nineveh--initial_foothold.html">initial foothold</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--nineveh--initial_foothold--create_database_and_table_w-_malicious_php_system_call.html">create database and table w/ malicious php system call</a></li>
<li><a href="HacktheBox--Linux_Boxes--nineveh--initial_foothold--LFI_to_RCE.html">LFI to RCE</a></li>
<li><a href="HacktheBox--Linux_Boxes--nineveh--initial_foothold--RCE_through_burp.html">RCE through burp</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--nineveh--initial_foothold--RCE_through_burp--reverse_shell.html">reverse shell</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--nineveh--initial_foothold--RCE_through_burp--reverse_shell--listener.html">listener</a></li>
</ol>
</ol>
</ol>
<li><a href="HacktheBox--Linux_Boxes--nineveh--privesc_to_root.html">privesc to root</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--nineveh--privesc_to_root--LinEnum.sh.html">LinEnum.sh</a></li>
<li><a href="HacktheBox--Linux_Boxes--nineveh--privesc_to_root--PSPY.html">PSPY</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--nineveh--privesc_to_root--PSPY--pspy64.html">pspy64</a></li>
<li><a href="HacktheBox--Linux_Boxes--nineveh--privesc_to_root--PSPY--custom_ippsec_procmon_script.html">custom ippsec procmon script</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--nineveh--privesc_to_root--PSPY--custom_ippsec_procmon_script--output.html">output</a></li>
</ol>
</ol>
<li><a href="HacktheBox--Linux_Boxes--nineveh--privesc_to_root--chkrootkit.html">chkrootkit</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--nineveh--privesc_to_root--chkrootkit--exploit-db.com-exploits-33899.html">exploit-db.com/exploits/33899</a></li>
</ol>
<li><a href="HacktheBox--Linux_Boxes--nineveh--privesc_to_root---tmp-update.html">/tmp/update</a></li>
</ol>
<li><a href="HacktheBox--Linux_Boxes--nineveh--additional_foothold.html">additional foothold</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--nineveh--additional_foothold--binwalk.html">binwalk</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--nineveh--additional_foothold--binwalk--nineveh.priv.html">nineveh.priv</a></li>
<li><a href="HacktheBox--Linux_Boxes--nineveh--additional_foothold--binwalk--nineveh.pub.html">nineveh.pub</a></li>
</ol>
<li><a href="HacktheBox--Linux_Boxes--nineveh--additional_foothold---etc-knockd.html">/etc/knockd</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--nineveh--additional_foothold---etc-knockd--nmap_port_knocking.html">nmap port knocking</a></li>
<li><a href="HacktheBox--Linux_Boxes--nineveh--additional_foothold---etc-knockd--nmap_scan.html">nmap scan</a></li>
</ol>
<li><a href="HacktheBox--Linux_Boxes--nineveh--additional_foothold--ssh.html">ssh</a></li>
</ol>
<li><a href="HacktheBox--Linux_Boxes--nineveh--user-root.html">user/root</a></li>
<li><a href="HacktheBox--Linux_Boxes--nineveh--lessons_learned.html">lessons learned</a></li>
</ol></div>
<div class="page"><h1><b><u>Local File Inclusion Vuln</u></b></h1><span style="color:#24ff00;">It is safe to assume the webserver has a LFI vulnerability due to a notes variable that points to the location of the file the webpage displays </span><br /><img src="images/512-1.png" alt="images/512-1.png" /><br /><br /><br /><span style="color:#24ff00;">Since most webservers are run within the </span><span style="color:#ffa500;">/var/www/html</span><span style="color:#24ff00;"> directory, lets try to find and list the /</span><span style="color:#ffa500;">etc/passwd </span><span style="color:#24ff00;">file through the LFI</span><br /><br /><span style="color:#ffa500;">../../../../../../../etc/passwd</span><br /><img src="images/512-2.png" alt="images/512-2.png" /><br /><a href="http://10.10.10.43/department/manage.php?notes=../../../../../../../etc/passwd">http://10.10.10.43/department/manage.php?notes=../../../../../../../etc/passwd</a><br />No Note is selected. is the message we get, lets try another LFI string<br /><img src="images/512-3.png" alt="images/512-3.png" /><br /><br /><span style="color:#24ff00;">we see the webserver uses </span><span style="color:#ffa500;">phpinclude() </span><span style="color:#24ff00;">to grab local files but we failed the file path, seems the site is vulnerable to LFI!</span><br /><img src="images/512-4.png" alt="images/512-4.png" /><br /><img src="images/512-5.png" alt="images/512-5.png" /><br /><span style="color:#24ff00;">we also see that the</span><span style="color:#ffa500;"> manage.php</span><span style="color:#24ff00;"> code that is handling our URL web requests is located in </span><span style="color:#ffa500;">/var/www/html/department</span><span style="color:#24ff00;"> directory, which means the webserver's working directory is approximately</span><span style="color:#ffff00;"> 4 directories</span><span style="color:#24ff00;"> deep within the box </span><br /><span style="color:#24ff00;">we can use this info to properly guess how many </span><span style="color:#ffff00;">directories</span><span style="color:#24ff00;"> we need to backtrack out of to get to the</span><span style="color:#ffa500;"> / </span><span style="color:#24ff00;">directory!</span><br /><br /><br /><span style="color:#24ff00;">Bingo! we gotthe webserver to list </span><span style="color:#ffa500;">/etc/passwd</span><span style="color:#24ff00;"> for us</span><br /><a href="http://10.10.10.43/department/manage.php?notes=/ninevehNotes../../../etc/passwd">http://10.10.10.43/department/manage.php?notes=/ninevehNotes../../../etc/passwd</a><br /><img src="images/512-6.png" alt="images/512-6.png" /><br /><br /><span style="color:#24ff00;">When it comes to </span><span style="color:#ffff00;">LFIs</span><span style="color:#24ff00;">, you usually need to chain it to another vulnerability in order to get remote code execution. Therefore, lets start enumerating the next port to see if I can find another vulnerability that I can chain this one to.</span><br /></div></div>
</body></html>