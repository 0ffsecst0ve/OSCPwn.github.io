<!doctype html><html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>exploit-db.com/exploits/33899</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="styles.css" type="text/css" />
</head>
<body><div class="main"><div class="tree">
<p><a href="../HacktheBox--Linux_Boxes.html">Linux Boxes</a></p>
<p><a href="HacktheBox--Linux_Boxes--nineveh.html">nineveh</a></p>

<ol>
<li><a href="HacktheBox--Linux_Boxes--nineveh--nmap.html">nmap</a></li>
<li><a href="HacktheBox--Linux_Boxes--nineveh--http-https.html">http/https</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--nineveh--http-https--cert.html">cert</a></li>
<li><a href="HacktheBox--Linux_Boxes--nineveh--http-https--gobuster.html">gobuster</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--nineveh--http-https--gobuster--http.html">http</a></li>
<li><a href="HacktheBox--Linux_Boxes--nineveh--http-https--gobuster--https.html">https</a></li>
</ol>
</ol>
<li><a href="HacktheBox--Linux_Boxes--nineveh--hydra_bf.html">hydra bf</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--nineveh--hydra_bf---departmnet.html">/departmnet</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--nineveh--hydra_bf---departmnet--homepage.html">homepage</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--nineveh--hydra_bf---departmnet--homepage--notes.html">notes</a></li>
<li><a href="HacktheBox--Linux_Boxes--nineveh--hydra_bf---departmnet--homepage--Local_File_Inclusion_Vuln.html">Local File Inclusion Vuln</a></li>
</ol>
</ol>
<li><a href="HacktheBox--Linux_Boxes--nineveh--hydra_bf---db.html">/db</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--nineveh--hydra_bf---db--pass.html">pass</a></li>
</ol>
</ol>
<li><a href="HacktheBox--Linux_Boxes--nineveh--initial_foothold.html">initial foothold</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--nineveh--initial_foothold--create_database_and_table_w-_malicious_php_system_call.html">create database and table w/ malicious php system call</a></li>
<li><a href="HacktheBox--Linux_Boxes--nineveh--initial_foothold--LFI_to_RCE.html">LFI to RCE</a></li>
<li><a href="HacktheBox--Linux_Boxes--nineveh--initial_foothold--RCE_through_burp.html">RCE through burp</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--nineveh--initial_foothold--RCE_through_burp--reverse_shell.html">reverse shell</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--nineveh--initial_foothold--RCE_through_burp--reverse_shell--listener.html">listener</a></li>
</ol>
</ol>
</ol>
<li><a href="HacktheBox--Linux_Boxes--nineveh--privesc_to_root.html">privesc to root</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--nineveh--privesc_to_root--LinEnum.sh.html">LinEnum.sh</a></li>
<li><a href="HacktheBox--Linux_Boxes--nineveh--privesc_to_root--PSPY.html">PSPY</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--nineveh--privesc_to_root--PSPY--pspy64.html">pspy64</a></li>
<li><a href="HacktheBox--Linux_Boxes--nineveh--privesc_to_root--PSPY--custom_ippsec_procmon_script.html">custom ippsec procmon script</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--nineveh--privesc_to_root--PSPY--custom_ippsec_procmon_script--output.html">output</a></li>
</ol>
</ol>
<li><a href="HacktheBox--Linux_Boxes--nineveh--privesc_to_root--chkrootkit.html">chkrootkit</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--nineveh--privesc_to_root--chkrootkit--exploit-db.com-exploits-33899.html">exploit-db.com/exploits/33899</a></li>
</ol>
<li><a href="HacktheBox--Linux_Boxes--nineveh--privesc_to_root---tmp-update.html">/tmp/update</a></li>
</ol>
<li><a href="HacktheBox--Linux_Boxes--nineveh--additional_foothold.html">additional foothold</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--nineveh--additional_foothold--binwalk.html">binwalk</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--nineveh--additional_foothold--binwalk--nineveh.priv.html">nineveh.priv</a></li>
<li><a href="HacktheBox--Linux_Boxes--nineveh--additional_foothold--binwalk--nineveh.pub.html">nineveh.pub</a></li>
</ol>
<li><a href="HacktheBox--Linux_Boxes--nineveh--additional_foothold---etc-knockd.html">/etc/knockd</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--nineveh--additional_foothold---etc-knockd--nmap_port_knocking.html">nmap port knocking</a></li>
<li><a href="HacktheBox--Linux_Boxes--nineveh--additional_foothold---etc-knockd--nmap_scan.html">nmap scan</a></li>
</ol>
<li><a href="HacktheBox--Linux_Boxes--nineveh--additional_foothold--ssh.html">ssh</a></li>
</ol>
<li><a href="HacktheBox--Linux_Boxes--nineveh--user-root.html">user/root</a></li>
<li><a href="HacktheBox--Linux_Boxes--nineveh--lessons_learned.html">lessons learned</a></li>
</ol></div>
<div class="page"><h1><b><u>exploit-db.com/exploits/33899</u></b></h1>We just found a serious vulnerability in the chkrootkit package, which<br />may allow local attackers to gain root access to a box in certain<br />configurations (/tmp not mounted noexec).<br /><br />The vulnerability is located in the function slapper() in the<br />shellscript chkrootkit:<br /><br />#<br /># SLAPPER.{A,B,C,D} and the multi-platform variant<br />#<br />slapper (){<br />   SLAPPER_FILES="${ROOTDIR}tmp/.bugtraq ${ROOTDIR}tmp/.bugtraq.c"<br />   SLAPPER_FILES="$SLAPPER_FILES ${ROOTDIR}tmp/.unlock ${ROOTDIR}tmp/httpd \<br />   ${ROOTDIR}tmp/update ${ROOTDIR}tmp/.cinik ${ROOTDIR}tmp/.b"a<br />   SLAPPER_PORT="0.0:2002 |0.0:4156 |0.0:1978 |0.0:1812 |0.0:2015 "<br />   OPT=-an<br />   STATUS=0<br />   file_port=<br /><br />   if ${netstat} "${OPT}"|${egrep} "^tcp"|${egrep} "${SLAPPER_PORT}"&gt;<br />/dev/null 2&gt;&amp;1<br />      then<br />      STATUS=1<br />      [ "$SYSTEM" = "Linux" ] &amp;&amp; file_port=`netstat -p ${OPT} | \<br />         $egrep ^tcp|$egrep "${SLAPPER_PORT}" | ${awk} '{ print  $7 }' |<br />tr -d :`<br />   fi<br />   for i in ${SLAPPER_FILES}; do<br />      if [ -f ${i} ]; then<br />         file_port=$file_port $i<br />         STATUS=1<br />      fi<br />   done<br />   if [ ${STATUS} -eq 1 ] ;then<br />      echo "Warning: Possible Slapper Worm installed ($file_port)"<br />   else<br />      if [ "${QUIET}" != "t" ]; then echo "not infected"; fi<br />         return ${NOT_INFECTED}<br />   fi<br />}<br /><br /><br />The line 'file_port=$file_port $i' will execute all files specified in<br />$SLAPPER_FILES as the user chkrootkit is running (usually root), if<br />$file_port is empty, because of missing quotation marks around the<br />variable assignment.<br /><br />Steps to reproduce:<br /><br />- Put an executable file named 'update' with non-root owner in /tmp (not<br />mounted noexec, obviously)<br />- Run chkrootkit (as uid 0)<br /><br />Result: The file /tmp/update will be executed as root, thus effectively<br />rooting your box, if malicious content is placed inside the file.<br /><br />If an attacker knows you are periodically running chkrootkit (like in<br />cron.daily) and has write access to /tmp (not mounted noexec), he may<br />easily take advantage of this.<br /><br /><br />Suggested fix: Put quotation marks around the assignment.<br /><br />file_port="$file_port $i"<br /><br /><br />I will also try to contact upstream, although the latest version of<br />chkrootkit dates back to 2009 - will have to see, if I reach a dev there.</div></div>
</body></html>