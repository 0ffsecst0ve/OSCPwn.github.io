<!doctype html><html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>privesc via sudoers config file</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="styles.css" type="text/css" />
</head>
<body><div class="main"><div class="tree">
<p><a href="../HacktheBox--Linux_Boxes.html">Linux Boxes</a></p>
<p><a href="HacktheBox--Linux_Boxes--lightweight.html">lightweight</a></p>

<ol>
<li><a href="HacktheBox--Linux_Boxes--lightweight--nmapAuto.html">nmapAuto</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--lightweight--nmapAuto--nmap_vulns.html">nmap vulns</a></li>
</ol>
<li><a href="HacktheBox--Linux_Boxes--lightweight--ldap.html">ldap</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--lightweight--ldap--ldapsearch_with_DC.html">ldapsearch with DC</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--lightweight--ldap--ldapsearch_with_DC--passwords.html">passwords</a></li>
<li><a href="HacktheBox--Linux_Boxes--lightweight--ldap--ldapsearch_with_DC--$6$x_module.html">$6$x module</a></li>
</ol>
</ol>
<li><a href="HacktheBox--Linux_Boxes--lightweight--http.html">http</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--lightweight--http--info.php.html">info.php</a></li>
<li><a href="HacktheBox--Linux_Boxes--lightweight--http--status.php.html">status.php</a></li>
<li><a href="HacktheBox--Linux_Boxes--lightweight--http--user.php.html">user.php</a></li>
</ol>
<li><a href="HacktheBox--Linux_Boxes--lightweight--ssh.html">ssh</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--lightweight--ssh---etc-passwd.html">/etc/passwd</a></li>
<li><a href="HacktheBox--Linux_Boxes--lightweight--ssh--LinEnum.html">LinEnum</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--lightweight--ssh--LinEnum--report.html">report</a></li>
</ol>
</ol>
<li><a href="HacktheBox--Linux_Boxes--lightweight--wireshark.html">wireshark</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--lightweight--wireshark--tcpdmp.html">tcpdmp</a></li>
<li><a href="HacktheBox--Linux_Boxes--lightweight--wireshark--lightweight.ens33.cap.html">lightweight.ens33.cap</a></li>
<li><a href="HacktheBox--Linux_Boxes--lightweight--wireshark--refresh_all_the_webpages_and_intercept_LDAP_packets.html">refresh all the webpages and intercept LDAP packets</a></li>
<li><a href="HacktheBox--Linux_Boxes--lightweight--wireshark--privesc_to_ldapuser2.html">privesc to ldapuser2</a></li>
</ol>
<li><a href="HacktheBox--Linux_Boxes--lightweight--privesc_to_ldapuser1.html">privesc to ldapuser1</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--lightweight--privesc_to_ldapuser1--7z2John.html">7z2John</a></li>
<li><a href="HacktheBox--Linux_Boxes--lightweight--privesc_to_ldapuser1--hashcat_the_7z2john_hash.html">hashcat the 7z2john hash</a></li>
<li><a href="HacktheBox--Linux_Boxes--lightweight--privesc_to_ldapuser1--unzip_7z_w-_pass.html">unzip 7z w/ pass</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--lightweight--privesc_to_ldapuser1--unzip_7z_w-_pass--status.php.html">status.php</a></li>
</ol>
<li><a href="HacktheBox--Linux_Boxes--lightweight--privesc_to_ldapuser1--privesc.html">privesc</a></li>
</ol>
<li><a href="HacktheBox--Linux_Boxes--lightweight--privesc_to_root.html">privesc to root</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--lightweight--privesc_to_root--gtfo_bins_openssl.html">gtfo bins openssl</a></li>
<li><a href="HacktheBox--Linux_Boxes--lightweight--privesc_to_root--testing_openssl_to_view_-etc-shadow.html">testing openssl to view /etc/shadow</a></li>
<li><a href="HacktheBox--Linux_Boxes--lightweight--privesc_to_root--privesc_via_sudoers_config_file.html">privesc via sudoers config file</a></li>
</ol>
<li><a href="HacktheBox--Linux_Boxes--lightweight--user-root.html">user/root</a></li>
<li><a href="HacktheBox--Linux_Boxes--lightweight--lessons_learned.html">lessons learned</a></li>
</ol></div>
<div class="page"><h1><b><u>privesc via sudoers config file</u></b></h1><img src="images/1511-1.png" alt="images/1511-1.png" /><br /><span style="color:#24ff00;">so first we update our </span><span style="color:#ffff00;">sudoers</span><span style="color:#24ff00;"> file we copied to ldapuser1's home directory, give him permission to use any and all commands and then sudo - to root from there</span><br /><br /><span style="color:#24ff00;">first print out the contents of our </span><span style="color:#ffa500;">/etc/sudoers</span><span style="color:#24ff00;"> file </span><br /><span style="color:#ffa500;">./openssl enc -in /etc/sudoers</span><br /><img src="images/1511-2.png" alt="images/1511-2.png" /><br /><span style="color:#24ff00;">and copy it to a file in our</span> <span style="color:#ffff00;">ldapuser1</span><span style="color:#24ff00;"> directory:</span><br /><img src="images/1511-3.png" alt="images/1511-3.png" /><br /><br /><img src="images/1511-4.png" alt="images/1511-4.png" /><br /><br /><span style="color:#ffa500;">vi /etc/sudoers</span> <span style="color:#24ff00;">- we want to add the same permissions root has to</span><span style="color:#ffff00;"> ldapuser1</span><br /><img src="images/1511-5.png" alt="images/1511-5.png" /><br /><span style="color:#24ff00;">which looks like this:</span><br /><img src="images/1511-6.png" alt="images/1511-6.png" /><br /><br /><span style="color:#24ff00;">now </span><span style="color:#ffa500;">cat</span><span style="color:#24ff00;"> our copied sudoers file and have our privileged openssl binary overwrite it to /etc/sudoers</span><br /><span style="color:#ffa500;">cat ./sudoers | ./openssl enc -out /etc/sudoers </span><br /><img src="images/1511-7.png" alt="images/1511-7.png" /><br /><br /><span style="color:#24ff00;">now simply elevate to </span><span style="color:#ffff00;">root</span><span style="color:#24ff00;"> with</span><span style="color:#ffff00;"> ldaps'</span><span style="color:#24ff00;"> newly configured permissions and..</span><br />Note: <span style="color:#24ff00;">you may need to exit out of</span><span style="color:#ffff00;"> ldapuser1's</span><span style="color:#24ff00;"> session before the changes to the sudoer file take effect!</span><br /><img src="images/1511-8.png" alt="images/1511-8.png" /><br /><br /><span style="color:#ffa500;">sudo su -</span><br /><span style="color:#24ff00;">we're </span><span style="color:#ffff00;">root</span><span style="color:#24ff00;">!</span><br /><img src="images/1511-9.png" alt="images/1511-9.png" /><br /></div></div>
</body></html>