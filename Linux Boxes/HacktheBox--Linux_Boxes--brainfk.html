<!doctype html><html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>brainfk</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="styles.css" type="text/css" />
</head>
<body><div class="main"><div class="tree">
<p><a href="HacktheBox--Linux_Boxes.html">Linux Boxes</a></p>
<p><a href="#brainfk">brainfk</a></p>

<ol>
<li><a href="#nmap">nmap</a></li>
<li><a href="#http">http</a></li>
<ol>
<li><a href="#certficate">certficate</a></li>
<ol>
<li><a href="#General">General</a></li>
<li><a href="#Details">Details</a></li>
<ol>
<li><a href="#email">email</a></li>
<li><a href="#/etc/hosts">/etc/hosts</a></li>
</ol>
</ol>
</ol>
<li><a href="#brainfuck.htb is wordpress">brainfuck.htb is wordpress</a></li>
<ol>
<li><a href="#wpsscan">wpsscan</a></li>
<ol>
<li><a href="#enumerate users">enumerate users</a></li>
<li><a href="#Report">Report</a></li>
<li><a href="#ticket response searchsploit">ticket response searchsploit</a></li>
<ol>
<li><a href="#vi exploit.html">vi exploit.html</a></li>
<li><a href="#host exploit.html">host exploit.html</a></li>
<li><a href="#burp suite">burp suite</a></li>
<li><a href="#admin login page">admin login page</a></li>
<ol>
<li><a href="#cannot edit template files">cannot edit template files</a></li>
</ol>
</ol>
</ol>
</ol>
<li><a href="#SMTP Integration is ready">SMTP Integration is ready</a></li>
<ol>
<li><a href="#Easy WP-SMTP">Easy WP-SMTP</a></li>
<ol>
<li><a href="#smtp password">smtp password</a></li>
</ol>
<li><a href="#thunderbird email">thunderbird email</a></li>
<ol>
<li><a href="#sup3rs3cr3t creds">sup3rs3cr3t creds</a></li>
</ol>
</ol>
<li><a href="#Sup3rs3cr3t.htb">Sup3rs3cr3t.htb</a></li>
<ol>
<li><a href="#SSH Access Forum">SSH Access Forum</a></li>
<li><a href="#key thread">key thread</a></li>
<ol>
<li><a href="#orestis cipher">orestis cipher</a></li>
<li><a href="#rumkin one time pad">rumkin one time pad</a></li>
<li><a href="#keyed vigenere cipher">keyed vigenere cipher</a></li>
<ol>
<li><a href="#decoded convo">decoded convo</a></li>
</ol>
</ol>
</ol>
<li><a href="#id_rsa">id_rsa</a></li>
<ol>
<li><a href="#bruteforce with ssh2john">bruteforce with ssh2john</a></li>
</ol>
<li><a href="#ssh orestis">ssh orestis</a></li>
<ol>
<li><a href="#debug.txt">debug.txt</a></li>
<li><a href="#output.txt">output.txt</a></li>
<li><a href="#encrypt.sage">encrypt.sage</a></li>
<ol>
<li><a href="#rsa with p q and e">rsa with p q and e </a></li>
<ol>
<li><a href="#decrypt">decrypt</a></li>
</ol>
<li><a href="#script">script</a></li>
</ol>
<li><a href="#decrypt.sage">decrypt.sage</a></li>
<ol>
<li><a href="#python">python</a></li>
<li><a href="#decode root.txt">decode root.txt</a></li>
</ol>
</ol>
<li><a href="#user/root">user/root</a></li>
<li><a href="#lessons learned">lessons learned</a></li>
</ol></div>
<div class="page", id="brainfk"><h1><b><u>brainfk</u></b></h1><img src="images/438-1.png" alt="images/438-1.png" /><br /><img src="images/438-2.png" alt="images/438-2.png" /></div>

<div class="page", id="nmap"><h1><b><u>nmap</u></b></h1><img src="images/439-1.png" alt="images/439-1.png" /><br /><span style="color:#24ff00;">Take note of the services running <br /></span><span style="color:#ffa500;">ssh</span><span style="color:#24ff00;"> on port 22<br /></span><span style="color:#ffa500;">smtp</span><span style="color:#24ff00;"> on port 25<br /></span><span style="color:#ffa500;">imap</span><span style="color:#24ff00;"> on port 143<br /></span><span style="color:#ffa500;">https</span><span style="color:#24ff00;"> on port 443</span><h2><br /><br /></h2></div>

<div class="page", id="http"><h1><b><u>http</u></b></h1><br /><img src="images/1949-1.png" alt="images/1949-1.png" /><br /><br /><img src="images/1949-2.png" alt="images/1949-2.png" /></div>

<div class="page", id="certficate"><h1><b><u>certficate</u></b></h1><img src="images/441-1.png" alt="images/441-1.png" /></div>

<div class="page", id="General"><h1><b><u>General</u></b></h1><img src="images/442-1.png" alt="images/442-1.png" /></div>


<div class="page", id="Details"><h1><b><u>Details</u></b></h1><img src="images/443-1.png" alt="images/443-1.png" /></div>


<div class="page", id="email"><h1><b><u>email</u></b></h1><span style="color:#24ff00;">We have an email to take note of in the Subject certificate field </span><span style="color:#ffff00;">orestis@brainfuck.htb</span><br /><img src="images/445-1.png" alt="images/445-1.png" />a<br /></div>


<div class="page", id="/etc/hosts"><h1><b><u>/etc/hosts</u></b></h1><img src="images/444-1.png" alt="images/444-1.png" /><br /><span style="color:#ffa500;"><span style="color:#24ff00;">Adding the DNS hosts we found out about from our Certificate Details:</span></span><br /><br /><img src="images/444-2.png" alt="images/444-2.png" /></div>

<div class="page", id="brainfuck.htb is wordpress"><h1><b><u>brainfuck.htb is wordpress</u></b></h1><span style="color:#ffa500;">https://brainfuck.htb</span><br /><span style="color:#24ff00;">Brainfuck Ltd. is running on wordpress and there is a note that that the smtp mail server integration is finished, lets run wordpress scan from here and keep note of the smtp service</span><br /><br /><img src="images/446-1.png" alt="images/446-1.png" /><br /><img src="images/446-2.png" alt="images/446-2.png" /><br /><img src="images/446-3.png" alt="images/446-3.png" /></div>

<div class="page", id="wpsscan"><h1><b><u>wpsscan</u></b></h1><img src="images/447-1.png" alt="images/447-1.png" /><br /><br /><span style="color:#24ff00;">Get an error claiming peer cert or SSH key was not OK, lets try disabling tls checks to bypass this...</span><br /><span style="color:#ffa500;">wpscan --url https://www.brainfuck.htb --disable-tls-checks</span><br /><br /><img src="images/447-2.png" alt="images/447-2.png" /><br /><br /><span style="color:#ffa500;">wpscan </span> <span style="color:#24ff00;">finds the </span><span style="color:#ffa500;">ticket system </span><span style="color:#24ff00;">is out of date, lets see if theres a vuln searchable on </span><span style="color:#ffa500;">searchsploit</span><span style="color:#24ff00;">...</span><br /><span style="color:#ffa500;">searchsploit wp support plus</span><br /><img src="images/447-3.png" alt="images/447-3.png" /></div>

<div class="page", id="enumerate users"><h1><b><u>enumerate users</u></b></h1><span style="color:#24ff00;">we can also use wpscan to enumerate user accounts attached to the website with</span><br /><span style="color:#ffa500;">wpscan --url https://www.brainfuck.htb  -e u --disable-tls-checks</span><br /><span style="color:#24ff00;">where </span><span style="color:#ffa500;">-e u </span><span style="color:#24ff00;">stands for </span><span style="color:#ffff00;">enumerate users</span><br /><img src="images/450-1.png" alt="images/450-1.png" /><br /><br /><span style="color:#24ff00;">wpscan found users </span><span style="color:#ffff00;">admin</span><span style="color:#24ff00;"> and </span><span style="color:#ffff00;">administrator</span><span style="color:#24ff00;">!</span></div>

<div class="page", id="Report"><h1><b><u>Report</u></b></h1><img src="images/448-1.png" alt="images/448-1.png" />+<br /><img src="images/448-2.png" alt="images/448-2.png" /><br /><img src="images/448-3.png" alt="images/448-3.png" /><br /></div>

<div class="page", id="ticket response searchsploit"><h1><b><u>ticket response searchsploit</u></b></h1><span style="color:#24ff00;">Since the <span style="color:#ffa500;">WPScan</span><span style="color:#24ff00;"> reported that </span><img src="images/449-1.png" alt="images/449-1.png" /><br />was out of date, lets use searchsploit and see if there's anything interesting:<br /><br /><img src="images/449-2.png" alt="images/449-2.png" /><br /><br />There's a priv esc exploit that matches with the version we enumerated through <span style="color:#ffa500;">WPScan</span><span style="color:#24ff00;"> </span><img src="images/449-3.png" alt="images/449-3.png" />, lets take a look at the exploit<br /><br /><img src="images/449-4.png" alt="images/449-4.png" /><br /><br /></span></div>

<div class="page", id="vi exploit.html"><h1><b><u>vi exploit.html</u></b></h1><span style="color:#24ff00;">We use</span><span style="color:#ffff00;"> Orestis@brainfuck.htb</span><span style="color:#24ff00;"> email we found from the certificate:</span><h1></h1><img src="images/451-1.png" alt="images/451-1.png" /><br /><span style="color:#24ff00;">Since it's a form post through html we need to </span><span style="color:#ffa500;">host</span><span style="color:#24ff00;"> the file </span><br /><br /></div>

<div class="page", id="host exploit.html"><h1><b><u>host exploit.html</u></b></h1><span style="color:#24ff00;">spin up a webserver with<br /><span style="color:#ffa500;">python -m SimpleHTTPServer</span><br /><img src="images/452-1.png" alt="images/452-1.png" /><br /><br />and navigate to your webpage and try plugging in the 2 usernames we found<br /><img src="images/452-2.png" alt="images/452-2.png" /></span></div>

<div class="page", id="burp suite"><h1><b><u>burp suite</u></b></h1><span style="color:#24ff00;">We can see from the server response that the exploit simply </span><span style="color:#ffff00;">sets our cookies identical to that of a webpage admin</span><span style="color:#24ff00;"><br /><br /></span><img src="images/453-1.png" alt="images/453-1.png" /></div>

<div class="page", id="admin login page"><h1><b><u>admin login page</u></b></h1><span style="color:#24ff00;">Navigate back to the brainfk webpage and like magic, we're logged in as </span><span style="color:#ffff00;">admin</span><span style="color:#24ff00;">!</span><br /><br /><img src="images/454-1.png" alt="images/454-1.png" /><img src="images/454-2.png" alt="images/454-2.png" /><br /><img src="images/454-3.png" alt="images/454-3.png" /><br /><br /><span style="color:#24ff00;">If we can edit any <span style="color:#ffa500;">PHP file</span><span style="color:#24ff00;"> we have a direct SHELL or call back a reverse shell!!!<br /><br />lets look at the admin dashboard: We can edit template files in </span><span style="color:#ffa500;">Appearance-&gt;Editor</span><span style="color:#24ff00;">:<br /><br /></span><img src="images/454-4.png" alt="images/454-4.png" /><br /><br />from here if we have privilege to manipulate the<span style="color:#ffa500;"> template php files</span><span style="color:#24ff00;"> on the webpage we would easily be able to run a </span><span style="color:#ffa500;">reverse shell</span><span style="color:#24ff00;"> back to our attacking machine so lets check that first...</span></span></div>

<div class="page", id="cannot edit template files"><h1><b><u>cannot edit template files</u></b></h1><span style="color:#24ff00;">Unfortunately this is a dead end because the template files are </span><span style="color:#ff0000;">only readable</span><span style="color:#24ff00;">:</span><br /><br /><img src="images/455-1.png" alt="images/455-1.png" /><br /><img src="images/455-2.png" alt="images/455-2.png" /></div>

<div class="page", id="SMTP Integration is ready"><h1><b><u>SMTP Integration is ready</u></b></h1><img src="images/456-1.png" alt="images/456-1.png" /><br /><span style="color:#24ff00;">there is a </span><span style="color:#ffa500;">mail server </span><span style="color:#24ff00;">set up that we can also look into:<br /><br />There is an </span><span style="color:#ffff00;">EASY WP-SMTP tab</span><span style="color:#24ff00;"> under the settings tab in the admin panel:</span><br /><img src="images/456-2.png" alt="images/456-2.png" /></div>

<div class="page", id="Easy WP-SMTP"><h1><b><u>Easy WP-SMTP</u></b></h1><img src="images/457-1.png" alt="images/457-1.png" /></div>

<div class="page", id="smtp password"><h1><b><u>smtp password</u></b></h1><span style="color:#24ff00;">The password on the webpage is </span><span style="color:#ff0000;">obfuscated</span><span style="color:#24ff00;">, however, We can </span><span style="color:#ffff00;">inspect</span><span style="color:#24ff00;"> the smtp password with our </span><span style="color:#ffa500;">browser's web tools</span><span style="color:#24ff00;"> to reveal orestis' smtp password by inspecting the SMTP variable! <br /></span><br /><img src="images/458-1.png" alt="images/458-1.png" /><br /><br /><span style="color:#24ff00;">Lets take these credentials and see if theres anything interesting in his emails...</span><br /><img src="images/458-2.png" alt="images/458-2.png" /><br /><span style="color:#24ff00;">Password is: </span><span style="color:#ffff00;">kHGuERB29DNiNE</span></div>

<div class="page", id="thunderbird email"><h1><b><u>thunderbird email</u></b></h1><span style="color:#24ff00;">im going to use </span><span style="color:#ffa500;">thunderbird</span><span style="color:#24ff00;"> to log into </span><span style="color:#ffff00;">orestis'</span><span style="color:#24ff00;"> account, feel free to follow along with any mail application of your choosing</span><img src="images/459-1.png" alt="images/459-1.png" /><h1></h1></div>

<div class="page", id="sup3rs3cr3t creds"><h1><b><u>sup3rs3cr3t creds</u></b></h1><span style="color:#24ff00;">Voila! We see an email with credentials to the</span><span style="color:#ffa500;"> s3cr3t.brainfuck.htb</span><span style="color:#24ff00;"> forum!</span><br /><br /><span style="color:#ffff00;">Orestis<br />kIEnnfEKJ#9UmdO</span><br /><img src="images/460-1.png" alt="images/460-1.png" /></div>

<div class="page", id="Sup3rs3cr3t.htb"><h1><b><u>Sup3rs3cr3t.htb</u></b></h1><span style="color:#24ff00;">Remember the </span><span style="color:#ffff00;">sup3rs3cr3t webpage</span><span style="color:#24ff00;"> we saw while inspecting brainfk's </span><span style="color:#ffa500;">ssl certificate</span><span style="color:#24ff00;">? Time to navigate there and test our newly discovered </span><span style="color:#ffff00;">credentials</span><span style="color:#24ff00;"> from orestis' email:</span><br /><br /><img src="images/461-1.png" alt="images/461-1.png" /><br /><img src="images/461-2.png" alt="images/461-2.png" /></div>

<div class="page", id="SSH Access Forum"><h1><b><u>SSH Access Forum</u></b></h1><img src="images/462-1.png" alt="images/462-1.png" /></div>

<div class="page", id="key thread"><h1><b><u>key thread</u></b></h1><span style="color:#24ff00;">unfortunately we see the discussion between orestis and admin is in </span><span style="color:#ff0000;">unreadable</span><span style="color:#24ff00;"> cipher text</span><br /><img src="images/463-1.png" alt="images/463-1.png" /><br /><br /><span style="color:#24ff00;">But Notice how </span><span style="color:#ffff00;">Orestis</span><span style="color:#24ff00;"> uses the same sign-off in all his posts that also never changes... we use what we know to</span><span style="color:#ffa500;"> reverse engineer it</span><br /><br /></div>

<div class="page", id="orestis cipher"><h1><b><u>orestis cipher</u></b></h1><img src="images/464-1.png" alt="images/464-1.png" /><img src="images/464-2.png" alt="images/464-2.png" /><h1><br /><br /></h1><span style="color:#24ff00;text-decoration:underline;">Notice these have same characters</span><span style="color:#24ff00;">:<br /></span><span style="color:#ffff00;">Orestis - Hacking for fun and profit<br />Pieagnm - Jkoijeg nbw zwx mle grwsnn</span><span style="color:#24ff00;"><br /> <br /></span><br /></div>

<div class="page", id="rumkin one time pad"><h1><b><u>rumkin one time pad</u></b></h1><span style="color:#ffa500;">Rumkin.com</span><span style="color:#24ff00;"> has a </span><span style="color:#ffff00;">one-time-pad decipher tool </span><span style="color:#24ff00;">that can be found </span><a href="http://rumkin.com/tools/cipher/otp.php">here</a><span style="color:#24ff00;">, lets take </span><span style="color:#ffff00;">Orestis' </span><span style="color:#24ff00;">encoded signoff and his plaintext signoff and plug them in<br /></span><br /><img src="images/466-1.png" alt="images/466-1.png" /><br /><span style="color:#24ff00;">You'll notice the key is just “</span><span style="color:#ffff00;">fuckmybrain</span><span style="color:#24ff00;">” repeated over and over</span><br /><br /><span style="color:#000000;">Note: decoding these conversations is eerily reminiscent of how the allies broke the german enigma code during ww2</span></div>

<div class="page", id="keyed vigenere cipher"><h1><b><u>keyed vigenere cipher</u></b></h1><span style="color:#24ff00;">now that we have the Passphrase, we can use the</span><span style="color:#ffa500;"> keyed vigenere cipher </span><span style="color:#24ff00;">to decode their conversation</span><br /><img src="images/467-1.png" alt="images/467-1.png" /></div>

<div class="page", id="decoded convo"><h1><b><u>decoded convo</u></b></h1><br /><span style="color:#ffff00;">Oretis: </span><img src="images/468-1.png" alt="images/468-1.png" /><br /><br />Admin: <img src="images/468-2.png" alt="images/468-2.png" /><br /><br /><br />Oretis: <img src="images/468-3.png" alt="images/468-3.png" /><br /><br /><br />Admin: <img src="images/468-4.png" alt="images/468-4.png" /><br /><br />Orestis: <img src="images/468-5.png" alt="images/468-5.png" /><br /><br /><br /><span style="color:#24ff00;">We find out admin stored </span><span style="color:#ffff00;">orestis' key</span><span style="color:#24ff00;"> at</span><br /><strong><span style="color:#ffa500;">https://10.10.10.17/8ba5aa10e915218697d1c658cdee0bb8/orestis/id_rsa</span></strong><br /><img src="images/468-6.png" alt="images/468-6.png" /><br /><br /><br /></div>

<div class="page", id="id_rsa"><h1><b><u>id_rsa</u></b></h1><span style="color:#24ff00;">Encrypted key! <br /></span><img src="images/469-1.png" alt="images/469-1.png" /></div>

<div class="page", id="bruteforce with ssh2john"><h1><b><u>bruteforce with ssh2john</u></b></h1><span style="color:#24ff00;">download </span><span style="color:#ffff00;">jumbojohn</span><span style="color:#24ff00;"> into /opt folder if you haven't already, I like to save repo's from the internet into the /opt directory for organization purposes<br /></span><img src="images/470-1.png" alt="images/470-1.png" /><br /><img src="images/470-2.png" alt="images/470-2.png" /><br /><br />use ssh2john on the id-rsa file downloaded <img src="images/470-3.png" alt="images/470-3.png" /><br /><br /><br /><br />output to brainfk-crack<br /><img src="images/470-4.png" alt="images/470-4.png" /><br /><br />now run john on the crack<br /><img src="images/470-5.png" alt="images/470-5.png" /><br /><br /><span style="text-decoration:underline;">Eureika! we have our password, time to ssh in</span><br /><span style="color:#ffff00;">3poulakia!</span><br /><br /></div>

<div class="page", id="ssh orestis"><h1><b><u>ssh orestis</u></b></h1><img src="images/471-1.png" alt="images/471-1.png" /><br /><br /><span style="color:#24ff00;">have to change permissions on key in order for it to be accepted:</span><br /><span style="color:#ffa500;">chmod 600 &lt;key file&gt;</span><br /><img src="images/471-2.png" alt="images/471-2.png" /><br /><br /><img src="images/471-3.png" alt="images/471-3.png" /><br /><br /><span style="color:#24ff00;">checking the directory we see a few interesting files</span><br /><img src="images/471-4.png" alt="images/471-4.png" /><br /><br /><br /><br /></div>

<div class="page", id="debug.txt"><h1><b><u>debug.txt</u></b></h1><span style="color:#24ff00;">file containing 3 large numbers, potentially p,q and e<br /></span><img src="images/475-1.png" alt="images/475-1.png" /><br /><br /><span style="color:#ffa500;">P</span><span style="color:#24ff00;"> = 7493025776465062819629921475535241674460826792785520881387158343265274170009282504884941039852933109163193651830303308312565580445669284847225535166520307<br /><br /></span><span style="color:#ffa500;">Q </span><span style="color:#24ff00;">= 7020854527787566735458858381555452648322845008266612906844847937070333480373963284146649074252278753696897245898433245929775591091774274652021374143174079<br /><br /></span><span style="color:#ffa500;">E</span><span style="color:#24ff00;"> = 30802007917952508422792869021689193927485016332713622527025219105154254472344627284947779726280995431947454292782426313255523137610532323813714483639434257536830062768286377920010841850346837238015571464755074669373110411870331706974573498912126641409821855678581804467608824177508976254759319210955977053997</span></div>

<div class="page", id="output.txt"><h1><b><u>output.txt</u></b></h1><img src="images/476-1.png" alt="images/476-1.png" /><span style="color:#24ff00;"><br /><br /></span><span style="color:#ffa500;">ct (ciphertxt) </span><span style="color:#24ff00;">= 44641914821074071930297814589851746700593470770417111804648920018396305246956127337150936081144106405284134845851392541080862652386840869768622438038690803472550278042463029816028777378141217023336710545449512973950591755053735796799773369044083673911035030605581144977552865771395578778515514288930832915182<br /></span></div>

<div class="page", id="encrypt.sage"><h1><b><u>encrypt.sage</u></b></h1><span style="color:#24ff00;">seems to be an </span><span style="color:#ffa500;">rsa_encryption </span><span style="color:#24ff00;">algorithm on</span><span style="color:#ffff00;"> root.txt</span><span style="color:#24ff00;">, we'll have to decode it to get our root flag...no wonder this box is insane.</span><br /><br /><img src="images/474-1.png" alt="images/474-1.png" /><br /><div class="codebox"><div style="background-color:#001b33" class="clear_fix">nbits = 1024<br /><br />password = open("/root/root.txt").read().strip()<br />enc_pass = open("output.txt","w")<br />debug = open("debug.txt","w")<br />m = Integer(int(password.encode('hex'),16))<br /><br />p = random_prime(2^floor(nbits/2)-1, lbound=2^floor(nbits/2-1), proof=False)<br />q = random_prime(2^floor(nbits/2)-1, lbound=2^floor(nbits/2-1), proof=False)<br />n = p*q<br />phi = (p-1)*(q-1)<br />e = ZZ.random_element(phi)<br />while gcd(e, phi) != 1:<br />    e = ZZ.random_element(phi)<br /><br /><br /><br />c = pow(m, e, n)<br />enc_pass.write('Encrypted Password: '+str(c)+'\n')<br />debug.write(str(p)+'\n')<br />debug.write(str(q)+'\n')<br />debug.write(str(e)+'\n')<br /></div></div></div>

<div class="page", id="rsa with p q and e"><h1><b><u>rsa with p q and e </u></b></h1><span style="color:#24ff00;">Let's see if google can help us find the sage code that will </span><span style="color:#ffff00;">decrypt</span><span style="color:#24ff00;"> our rsa ciphertext<br /><br /><br /></span><img src="images/477-1.png" alt="images/477-1.png" /><br /><br />lets search google<br /><img src="images/477-2.png" alt="images/477-2.png" /></div>

<div class="page", id="decrypt"><h1><b><u>decrypt</u></b></h1><img src="images/480-1.png" alt="images/480-1.png" /><br /><br /><img src="images/480-2.png" alt="images/480-2.png" /><br /><br /><span style="color:#24ff00;">the decrypt function has the same variables </span><span style="color:#ffa500;">p q e</span><span style="color:#24ff00;"> from our encrypt script and happens also to be a sage file!</span><br /><br /><img src="images/480-3.png" alt="images/480-3.png" /></div>

<div class="page", id="script"><h1><b><u>script</u></b></h1><img src="images/478-1.png" alt="images/478-1.png" /><span style="color:#24ff00;"><br />sub </span><span style="color:#ffa500;">P</span><span style="color:#24ff00;">, </span><span style="color:#ffa500;">Q</span><span style="color:#24ff00;"> and</span><span style="color:#ffa500;"> E</span><span style="color:#24ff00;"> in from </span><span style="color:#ffa500;">debug.txt</span><span style="color:#24ff00;">  and CT for ciphertext from </span><span style="color:#ffa500;">output.txt</span><span style="color:#24ff00;">:<br /><br /></span><img src="images/478-2.png" alt="images/478-2.png" /><br /><br /></div>

<div class="page", id="decrypt.sage"><h1><b><u>decrypt.sage</u></b></h1><br /><br /><img src="images/479-1.png" alt="images/479-1.png" /></div>

<div class="page", id="python"><h1><b><u>python</u></b></h1><span style="color:#24ff00;">number string will be too long so we need to convert to hex and then to ASCII</span><br /><img src="images/481-1.png" alt="images/481-1.png" /><br /></div>

<div class="page", id="decode root.txt"><h1><b><u>decode root.txt</u></b></h1><span style="color:#24ff00;"><br />First we need to shave off the ‘<span style="color:#ffa500;">0x</span><span style="color:#24ff00;">’ and the </span><span style="color:#ffa500;">L</span><span style="color:#24ff00;"> from the output before we decode it with<br /></span><span style="color:#ffa500;">str(hex(pt)[2:-1])</span><br /><img src="images/482-1.png" alt="images/482-1.png" /><br /><br /><br />now we have to decode the number out of the hex we encoded it in with<br /><span style="color:#ffa500;">str(hex(pt)[2:-1]).decode('hex')</span><br /><img src="images/482-2.png" alt="images/482-2.png" /><br /><br /><br />there we have it! <span style="color:#ffff00;">root.txt </span><span style="color:#24ff00;">is <br /></span><span style="color:#ffff00;">6efc1a5dbb8904751ce6566a305bb8ef</span></span></div>

<div class="page", id="user/root"><h1><b><u>user/root</u></b></h1><img src="images/483-1.png" alt="images/483-1.png" /><span style="color:#ffff00;"><br />2c11cfbc5b959f73ac15a3310bd097c9<br /><br /><img src="images/483-2.png" alt="images/483-2.png" /><br />6efc1a5dbb8904751ce6566a305bb8ef<br /></span></div>


<div class="page", id="lessons learned"><h1><b><u>lessons learned</u></b></h1><span style="color:#24ff00;">Check out Rana Khalil's OSCP writeups and prep at</span> <a href="https://rana-khalil.gitbook.io/hack-the-box-oscp-preparation/">https://rana-khalil.gitbook.io/hack-the-box-oscp-preparation/</a><br /><br /><img src="images/1951-1.png" alt="images/1951-1.png" /></div>
</div>
</body></html>