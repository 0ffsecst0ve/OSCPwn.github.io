<!doctype html><html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>initial foothold</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="styles.css" type="text/css" />
</head>
<body><div class="main"><div class="tree">
<p><a href="../HacktheBox--Linux_Boxes.html">Linux Boxes</a></p>
<p><a href="HacktheBox--Linux_Boxes--safe_(linux_BoF).html">safe (linux BoF)</a></p>

<ol>
<li><a href="HacktheBox--Linux_Boxes--safe_(linux_BoF)--nmapAutomator.html">nmapAutomator</a></li>
<li><a href="HacktheBox--Linux_Boxes--safe_(linux_BoF)--http.html">http</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--safe_(linux_BoF)--http--port_1337.html">port 1337</a></li>
</ol>
<li><a href="HacktheBox--Linux_Boxes--safe_(linux_BoF)--initial_foothold.html">initial foothold</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--safe_(linux_BoF)--initial_foothold--ghidra.html">ghidra</a></li>
<li><a href="HacktheBox--Linux_Boxes--safe_(linux_BoF)--initial_foothold--buffer_overflow.html">buffer overflow</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--safe_(linux_BoF)--initial_foothold--buffer_overflow--checksec.html">checksec</a></li>
<li><a href="HacktheBox--Linux_Boxes--safe_(linux_BoF)--initial_foothold--buffer_overflow--step_1_crash_the_application.html">step 1: crash the application</a></li>
<li><a href="HacktheBox--Linux_Boxes--safe_(linux_BoF)--initial_foothold--buffer_overflow--step_2_find_the_offset.html">step 2: find the offset</a></li>
<ol>
<li><a href="afe_(linux_BoF)--initial_foothold--buffer_overflow--step_2_find_the_offset--overwriting_$rsp_register_to_test_calling_main_function_twice.html">overwriting $rsp register to test calling main function twice</a></li>
</ol>
<li><a href="HacktheBox--Linux_Boxes--safe_(linux_BoF)--initial_foothold--buffer_overflow--step_3_hijack_system_call.html">step 3: hijack system call</a></li>
<li><a href="ox--Linux_Boxes--safe_(linux_BoF)--initial_foothold--buffer_overflow--step_4_collect_all_the_necessary_parameters_for_a_ROP_chain_exploit.html">step 4: collect all the necessary parameters for a ROP chain exploit</a></li>
<ol>
<li><a href="es--safe_(linux_BoF)--initial_foothold--buffer_overflow--step_4_collect_all_the_necessary_parameters_for_a_ROP_chain_exploit--disass_main.html">disass main</a></li>
<li><a href="es--safe_(linux_BoF)--initial_foothold--buffer_overflow--step_4_collect_all_the_necessary_parameters_for_a_ROP_chain_exploit--disass_test.html">disass test</a></li>
</ol>
<li><a href="HacktheBox--Linux_Boxes--safe_(linux_BoF)--initial_foothold--buffer_overflow--step_5_write_exploit.py.html">step 5 write exploit.py</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--safe_(linux_BoF)--initial_foothold--buffer_overflow--step_5_write_exploit.py--tweak_for_safe_box.html">tweak for safe box</a></li>
<li><a href="HacktheBox--Linux_Boxes--safe_(linux_BoF)--initial_foothold--buffer_overflow--step_5_write_exploit.py--run.html">run</a></li>
</ol>
<li><a href="HacktheBox--Linux_Boxes--safe_(linux_BoF)--initial_foothold--buffer_overflow--obj_dump_system_&_test.html">obj dump system & test</a></li>
</ol>
</ol>
<li><a href="HacktheBox--Linux_Boxes--safe_(linux_BoF)--privilege_escalation.html">privilege escalation</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--safe_(linux_BoF)--privilege_escalation--dropping_ssh_key.html">dropping ssh key</a></li>
<li><a href="HacktheBox--Linux_Boxes--safe_(linux_BoF)--privilege_escalation--exfiltrate_keepass.html">exfiltrate keepass</a></li>
<li><a href="HacktheBox--Linux_Boxes--safe_(linux_BoF)--privilege_escalation--crack_keepass.html">crack keepass</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--safe_(linux_BoF)--privilege_escalation--crack_keepass--organize_picture_files_hashes.html">organize picture files hashes</a></li>
<li><a href="HacktheBox--Linux_Boxes--safe_(linux_BoF)--privilege_escalation--crack_keepass--hashcat.html">hashcat</a></li>
</ol>
<li><a href="HacktheBox--Linux_Boxes--safe_(linux_BoF)--privilege_escalation--kpcli.html">kpcli</a></li>
<li><a href="HacktheBox--Linux_Boxes--safe_(linux_BoF)--privilege_escalation--sudo_into_root.html">sudo into root</a></li>
</ol>
<li><a href="HacktheBox--Linux_Boxes--safe_(linux_BoF)--user-root.html">user/root</a></li>
<li><a href="HacktheBox--Linux_Boxes--safe_(linux_BoF)--lessons_learned.html">lessons learned</a></li>
</ol></div>
<div class="page"><h1><b><u>initial foothold</u></b></h1><span style="color:#24ff00;">we're going to use a combination of </span><span style="color:#ffff00;">ghidra</span><span style="color:#24ff00;"> </span><span style="color:#ffff00;">Software Reverse Engineering Framework </span><span style="color:#24ff00;">and</span><span style="color:#ffff00;"> GDB Enhanced Features </span><span style="color:#24ff00;">(</span><span style="color:#ffa500;">GEF</span><span style="color:#24ff00;">) to analyze myapp for vulnerabilities<br /><br />you can grab </span><span style="color:#ffff00;">ghidra</span><span style="color:#24ff00;"> releases from the official NSA github page </span><a href="https://github.com/NationalSecurityAgency/ghidra/releases">here</a><span style="color:#24ff00;"> <br /><br />to install </span><span style="color:#ffa500;">GEF</span><span style="color:#24ff00;">, first we'll need </span><span style="color:#ffff00;">cmake</span><span style="color:#24ff00;"> since it is a dependency<br /></span><span style="color:#ffa500;">sudo apt-get install cmake</span><span style="color:#24ff00;"><br /><br />then google </span><span style="color:#ffff00;">gef</span><span style="color:#24ff00;"> github</span> <a href="https://github.com/hugsy/gef">here</a><span style="color:#24ff00;"><br />and follow the </span><span style="color:#ffff00;">instant setup</span><span style="color:#24ff00;"> section of the README file</span><br /><img src="images/1469-1.png" alt="images/1469-1.png" /><br /><br /><span style="color:#ffa500;">wget -O ~/.gdbinit-gef.py -q http://gef.blah.cat/py<br />echo source ~/.gdbinit-gef.py &gt;&gt; ~/.gdbinit</span><br /><img src="images/1469-2.png" alt="images/1469-2.png" /><br /><br /><br /><span style="color:#24ff00;">to fire up ghidra, navigate to the directory you cloned it in and execute </span><span style="color:#ffa500;">./ghidrarun</span><br /><img src="images/1469-3.png" alt="images/1469-3.png" /><br /><br /><img src="images/1469-4.png" alt="images/1469-4.png" /><br /><br /><span style="color:#24ff00;">make a new project (and a new directory ghidra in your safe directory to hold it)</span><br /><img src="images/1469-5.png" alt="images/1469-5.png" /><br /><br /><span style="color:#24ff00;">next, </span><span style="color:#ffa500;">import</span><span style="color:#24ff00;"> the myapp file</span><br /><img src="images/1469-6.png" alt="images/1469-6.png" /><img src="images/1469-7.png" alt="images/1469-7.png" /><br /><br /><span style="color:#24ff00;">click OK and make not ghidra knows the file is an </span><span style="color:#ffa500;">ELF</span><span style="color:#24ff00;"> file</span><br /><img src="images/1469-8.png" alt="images/1469-8.png" /><br />OK through the import summary<br /><img src="images/1469-9.png" alt="images/1469-9.png" /><br /><img src="images/1469-10.png" alt="images/1469-10.png" /><br /><br /><br /><span style="color:#24ff00;">finally click the </span><span style="color:#ffff00;">dragon icon</span><span style="color:#24ff00;"> to load it into </span><span style="color:#ffa500;">ghidra</span><br /><br /><span style="color:#24ff00;">you may need to go navigate to</span><span style="color:#ffa500;"> file-&gt;open-&gt;myapp</span><span style="color:#24ff00;"> as well after </span><span style="color:#ffa500;">ghidra</span><span style="color:#24ff00;"> runs if you see </span><span style="color:#ff0000;">no programs </span><span style="color:#24ff00;">in ghidra initially</span><br /><img src="images/1469-11.png" alt="images/1469-11.png" /><br /><br /><span style="color:#24ff00;">finally, click the </span><span style="color:#ffff00;">select all </span><span style="color:#24ff00;">bujtton on the analysis options page and you're good to go!</span><br /><img src="images/1469-12.png" alt="images/1469-12.png" /><br /><br /><br /><br /><br /><br /><br /><br /><br /></div></div>
</body></html>