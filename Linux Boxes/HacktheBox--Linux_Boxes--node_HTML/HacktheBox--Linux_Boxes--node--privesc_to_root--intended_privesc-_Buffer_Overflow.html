<!doctype html><html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>intended privesc- Buffer Overflow</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="styles.css" type="text/css" />
</head>
<body><div class="main"><div class="tree">
<p><strong>Index</strong></p>
<p><a href="HacktheBox--Linux_Boxes--node.html">node</a></p>

<ol>
<li><a href="HacktheBox--Linux_Boxes--node--nmap.html">nmap</a></li>
<li><a href="HacktheBox--Linux_Boxes--node--http.html">http</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--node--http--page_source.html">page source</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--node--http--page_source--home.js.html">home.js</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--node--http--page_source--home.js---api-users-latest.html">/api/users/latest</a></li>
</ol>
<li><a href="HacktheBox--Linux_Boxes--node--http--page_source--admin.js.html">admin.js</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--node--http--page_source--admin.js---api-admin-backup.html">/api/admin/backup</a></li>
</ol>
<li><a href="HacktheBox--Linux_Boxes--node--http--page_source--profile.js.html">profile.js</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--node--http--page_source--profile.js---api-users.html">/api/users </a></li>
</ol>
<li><a href="HacktheBox--Linux_Boxes--node--http--page_source--login.js.html">login.js</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--node--http--page_source--login.js---api-session-authenticate.html">/api/session/authenticate</a></li>
</ol>
</ol>
<li><a href="HacktheBox--Linux_Boxes--node--http--crackstation.html">crackstation</a></li>
</ol>
<li><a href="HacktheBox--Linux_Boxes--node--initial_foothold_on_mark.html">initial foothold on mark</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--node--initial_foothold_on_mark--backup_download.html">backup download</a></li>
<li><a href="HacktheBox--Linux_Boxes--node--initial_foothold_on_mark--fcrack.html">fcrack</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--node--initial_foothold_on_mark--fcrack--fcrack_brute_force.html">fcrack brute force</a></li>
<li><a href="HacktheBox--Linux_Boxes--node--initial_foothold_on_mark--fcrack--unzip_myplace.decode.backup.html">unzip myplace.decode.backup</a></li>
</ol>
<li><a href="HacktheBox--Linux_Boxes--node--initial_foothold_on_mark--ssh_mark.html">ssh mark</a></li>
</ol>
<li><a href="HacktheBox--Linux_Boxes--node--privesc_to_Tom.html">privesc to Tom</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--node--privesc_to_Tom--linEnum.sh.html">linEnum.sh</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--node--privesc_to_Tom--linEnum.sh--report.html">report</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--node--privesc_to_Tom--linEnum.sh--report--system.html">system</a></li>
<li><a href="HacktheBox--Linux_Boxes--node--privesc_to_Tom--linEnum.sh--report--USER-GROUP.html">USER/GROUP</a></li>
<li><a href="HacktheBox--Linux_Boxes--node--privesc_to_Tom--linEnum.sh--report--Environmental.html">Environmental</a></li>
<li><a href="HacktheBox--Linux_Boxes--node--privesc_to_Tom--linEnum.sh--report--JOBS-TASKS.html">JOBS/TASKS</a></li>
<li><a href="HacktheBox--Linux_Boxes--node--privesc_to_Tom--linEnum.sh--report--Networking.html">Networking</a></li>
<li><a href="HacktheBox--Linux_Boxes--node--privesc_to_Tom--linEnum.sh--report--Services.html">Services</a></li>
<li><a href="HacktheBox--Linux_Boxes--node--privesc_to_Tom--linEnum.sh--report--Interesting_Files.html">Interesting Files</a></li>
</ol>
<li><a href="HacktheBox--Linux_Boxes--node--privesc_to_Tom--linEnum.sh--LinEnum_finds.html">LinEnum finds:</a></li>
</ol>
<li><a href="HacktheBox--Linux_Boxes--node--privesc_to_Tom--escalation_method_1_mongo_db_rev_shell.html">escalation method 1: mongo_db rev shell</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--node--privesc_to_Tom--escalation_method_1_mongo_db_rev_shell--pentest_monkey_reverse_shell.html">pentest monkey reverse shell </a></li>
<li><a href="HacktheBox--Linux_Boxes--node--privesc_to_Tom--escalation_method_1_mongo_db_rev_shell--excalating_to_Tom_w-_reverse_shell.html">excalating to Tom w/ reverse shell</a></li>
</ol>
<li><a href="HacktheBox--Linux_Boxes--node--privesc_to_Tom--escalating_method_2_copy_privileged_shell_(ippsec).html">escalating method 2: copy privileged shell (ippsec)</a></li>
</ol>
<li><a href="HacktheBox--Linux_Boxes--node--privesc_to_root.html">privesc to root</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--node--privesc_to_root--find_-_-perm_-4000_2-dev-null.html">find / -perm -4000 2>/dev/null</a></li>
<li><a href="HacktheBox--Linux_Boxes--node--privesc_to_root---usr-local-bin-backup.html">/usr/local/bin/backup</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--node--privesc_to_root---usr-local-bin-backup--strace_.-backup.html">strace ./backup</a></li>
<li><a href="HacktheBox--Linux_Boxes--node--privesc_to_root---usr-local-bin-backup--radar_2.html">radar 2</a></li>
<li><a href="HacktheBox--Linux_Boxes--node--privesc_to_root---usr-local-bin-backup--takes_3_arguments.html">takes 3 arguments</a></li>
<li><a href="HacktheBox--Linux_Boxes--node--privesc_to_root---usr-local-bin-backup--strace.html">strace</a></li>
<li><a href="HacktheBox--Linux_Boxes--node--privesc_to_root---usr-local-bin-backup--.-backup_(trolled).html">./backup (trolled)</a></li>
</ol>
<li><a href="HacktheBox--Linux_Boxes--node--privesc_to_root--badchars.html">badchars</a></li>
<li><a href="HacktheBox--Linux_Boxes--node--privesc_to_root--intended_privesc-_Buffer_Overflow.html">intended privesc- Buffer Overflow</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--node--privesc_to_root--intended_privesc-_Buffer_Overflow--check_for_overflowed_buffer.html">check for overflowed buffer</a></li>
<li><a href="HacktheBox--Linux_Boxes--node--privesc_to_root--intended_privesc-_Buffer_Overflow--pattern_create.html">pattern create</a></li>
<li><a href="HacktheBox--Linux_Boxes--node--privesc_to_root--intended_privesc-_Buffer_Overflow--python_-c_'print_A520'.html">python -c 'print "A"*520'</a></li>
<li><a href="HacktheBox--Linux_Boxes--node--privesc_to_root--intended_privesc-_Buffer_Overflow--buf.py.html">buf.py</a></li>
<li><a href="eBox--Linux_Boxes--node--privesc_to_root--intended_privesc-_Buffer_Overflow--find_libc,_system_off,_exit_off_and_arg_off_starting_address.html">find libc, system_off, exit_off and arg_off starting address</a></li>
<ol>
<li><a href="xes--node--privesc_to_root--intended_privesc-_Buffer_Overflow--find_libc,_system_off,_exit_off_and_arg_off_starting_address---lib32_files.html">/lib32 files</a></li>
</ol>
<li><a href="HacktheBox--Linux_Boxes--node--privesc_to_root--intended_privesc-_Buffer_Overflow--update_ret.html">update ret</a></li>
<li><a href="HacktheBox--Linux_Boxes--node--privesc_to_root--intended_privesc-_Buffer_Overflow--run_buf.py_win.html">run buf.py win</a></li>
</ol>
<li><a href="HacktheBox--Linux_Boxes--node--privesc_to_root--unintended_privesc_methods.html">unintended privesc methods</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--node--privesc_to_root--unintended_privesc_methods--avoiding_bad_characters_to_extract_root.txt.html">avoiding bad characters to extract root.txt</a></li>
<ol>
<li><a href="ox--Linux_Boxes--node--privesc_to_root--unintended_privesc_methods--avoiding_bad_characters_to_extract_root.txt--decode_and_unzip_and.....html">decode and unzip and....</a></li>
</ol>
<li><a href="HacktheBox--Linux_Boxes--node--privesc_to_root--unintended_privesc_methods--creating_a_symlink.html">creating a symlink</a></li>
<li><a href="HacktheBox--Linux_Boxes--node--privesc_to_root--unintended_privesc_methods--wildcards.html">wildcards</a></li>
<li><a href="HacktheBox--Linux_Boxes--node--privesc_to_root--unintended_privesc_methods--command_injection.html">command injection</a></li>
</ol>
</ol>
<li><a href="HacktheBox--Linux_Boxes--node--user-root.html">user/root</a></li>
<li><a href="HacktheBox--Linux_Boxes--node--lessons_learned.html">lessons learned</a></li>
</ol></div>
<div class="page"><h1><b><u>intended privesc- Buffer Overflow</u></b></h1><span style="color:#24ff00;">to be added when I know wtf im doing<br />okay a few hours later and I'm feeling at least confident enough to follow ippsec's walkthrough, fyi my butt is fully clenched<br /><br />lets fire up gdb (btw install </span><span style="color:#ffa500;">PEDA - Python Exploit Development Assistance</span><span style="color:#24ff00;"> for GDB first through this link  <br /></span><a href="https://github.com/longld/peda">https://github.com/longld/peda</a><span style="color:#24ff00;"> ) <br /><br /></span><strong><span style="color:#24ff00;">NOTE</span></strong><span style="color:#24ff00;">: you need to create the a file in </span><span style="color:#ffa500;">/etc/myplace/keys</span><span style="color:#24ff00;"> with one of the 3 backup keys in order for</span><span style="color:#ffa500;"> ./backup </span><span style="color:#24ff00;">to run propely on the attacking machine because it uses that directory in the source code, and you need to be able to run ./backup on your attacking machine in order to pull the overflow off through GDB<br /><br />(lets swap our local key file to have a short string like ‘</span><span style="color:#ffff00;">abc</span><span style="color:#24ff00;">’<br /></span><img src="images/838-1.png" alt="images/838-1.png" /><br /><img src="images/838-2.png" alt="images/838-2.png" /><br /><br /><img src="images/838-3.png" alt="images/838-3.png" /><br /><img src="images/838-4.png" alt="images/838-4.png" /><br /><br />first order of business is to check which compile-time protections are enabled:<br /><span style="color:#ffa500;">checksec</span><br /><img src="images/838-5.png" alt="images/838-5.png" /><br /><br />lets delete any breakpoints<br /><img src="images/838-6.png" alt="images/838-6.png" />...none were placed but its good to check<br /><br /><br />and put a breakpoint on main:<br />looking at binary ninja, we find <span style="color:#ffff00;">strcopy</span><span style="color:#24ff00;">, which is an outdated function and should actually be strncopy <br />we'll pick a function that calls </span><span style="color:#ffff00;">strcopy</span><span style="color:#24ff00;"> to target<br /></span><img src="images/838-7.png" alt="images/838-7.png" /><br /><br />there's a function right before it so lets run our backup script twice to see if it will display what we're archiving and prove it overflows<br /><img src="images/838-8.png" alt="images/838-8.png" /><br /><br /><br /><br /><br /><br /><br /><br /></div></div>
</body></html>