<!doctype html><html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>find libc, system_off, exit_off and arg_off starting address</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="styles.css" type="text/css" />
</head>
<body><div class="main"><div class="tree">
<p><strong>Index</strong></p>
<p><a href="HacktheBox--Linux_Boxes--node.html">node</a></p>

<ol>
<li><a href="HacktheBox--Linux_Boxes--node--nmap.html">nmap</a></li>
<li><a href="HacktheBox--Linux_Boxes--node--http.html">http</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--node--http--page_source.html">page source</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--node--http--page_source--home.js.html">home.js</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--node--http--page_source--home.js---api-users-latest.html">/api/users/latest</a></li>
</ol>
<li><a href="HacktheBox--Linux_Boxes--node--http--page_source--admin.js.html">admin.js</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--node--http--page_source--admin.js---api-admin-backup.html">/api/admin/backup</a></li>
</ol>
<li><a href="HacktheBox--Linux_Boxes--node--http--page_source--profile.js.html">profile.js</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--node--http--page_source--profile.js---api-users.html">/api/users </a></li>
</ol>
<li><a href="HacktheBox--Linux_Boxes--node--http--page_source--login.js.html">login.js</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--node--http--page_source--login.js---api-session-authenticate.html">/api/session/authenticate</a></li>
</ol>
</ol>
<li><a href="HacktheBox--Linux_Boxes--node--http--crackstation.html">crackstation</a></li>
</ol>
<li><a href="HacktheBox--Linux_Boxes--node--initial_foothold_on_mark.html">initial foothold on mark</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--node--initial_foothold_on_mark--backup_download.html">backup download</a></li>
<li><a href="HacktheBox--Linux_Boxes--node--initial_foothold_on_mark--fcrack.html">fcrack</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--node--initial_foothold_on_mark--fcrack--fcrack_brute_force.html">fcrack brute force</a></li>
<li><a href="HacktheBox--Linux_Boxes--node--initial_foothold_on_mark--fcrack--unzip_myplace.decode.backup.html">unzip myplace.decode.backup</a></li>
</ol>
<li><a href="HacktheBox--Linux_Boxes--node--initial_foothold_on_mark--ssh_mark.html">ssh mark</a></li>
</ol>
<li><a href="HacktheBox--Linux_Boxes--node--privesc_to_Tom.html">privesc to Tom</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--node--privesc_to_Tom--linEnum.sh.html">linEnum.sh</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--node--privesc_to_Tom--linEnum.sh--report.html">report</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--node--privesc_to_Tom--linEnum.sh--report--system.html">system</a></li>
<li><a href="HacktheBox--Linux_Boxes--node--privesc_to_Tom--linEnum.sh--report--USER-GROUP.html">USER/GROUP</a></li>
<li><a href="HacktheBox--Linux_Boxes--node--privesc_to_Tom--linEnum.sh--report--Environmental.html">Environmental</a></li>
<li><a href="HacktheBox--Linux_Boxes--node--privesc_to_Tom--linEnum.sh--report--JOBS-TASKS.html">JOBS/TASKS</a></li>
<li><a href="HacktheBox--Linux_Boxes--node--privesc_to_Tom--linEnum.sh--report--Networking.html">Networking</a></li>
<li><a href="HacktheBox--Linux_Boxes--node--privesc_to_Tom--linEnum.sh--report--Services.html">Services</a></li>
<li><a href="HacktheBox--Linux_Boxes--node--privesc_to_Tom--linEnum.sh--report--Interesting_Files.html">Interesting Files</a></li>
</ol>
<li><a href="HacktheBox--Linux_Boxes--node--privesc_to_Tom--linEnum.sh--LinEnum_finds.html">LinEnum finds:</a></li>
</ol>
<li><a href="HacktheBox--Linux_Boxes--node--privesc_to_Tom--escalation_method_1_mongo_db_rev_shell.html">escalation method 1: mongo_db rev shell</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--node--privesc_to_Tom--escalation_method_1_mongo_db_rev_shell--pentest_monkey_reverse_shell.html">pentest monkey reverse shell </a></li>
<li><a href="HacktheBox--Linux_Boxes--node--privesc_to_Tom--escalation_method_1_mongo_db_rev_shell--excalating_to_Tom_w-_reverse_shell.html">excalating to Tom w/ reverse shell</a></li>
</ol>
<li><a href="HacktheBox--Linux_Boxes--node--privesc_to_Tom--escalating_method_2_copy_privileged_shell_(ippsec).html">escalating method 2: copy privileged shell (ippsec)</a></li>
</ol>
<li><a href="HacktheBox--Linux_Boxes--node--privesc_to_root.html">privesc to root</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--node--privesc_to_root--find_-_-perm_-4000_2-dev-null.html">find / -perm -4000 2>/dev/null</a></li>
<li><a href="HacktheBox--Linux_Boxes--node--privesc_to_root---usr-local-bin-backup.html">/usr/local/bin/backup</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--node--privesc_to_root---usr-local-bin-backup--strace_.-backup.html">strace ./backup</a></li>
<li><a href="HacktheBox--Linux_Boxes--node--privesc_to_root---usr-local-bin-backup--radar_2.html">radar 2</a></li>
<li><a href="HacktheBox--Linux_Boxes--node--privesc_to_root---usr-local-bin-backup--takes_3_arguments.html">takes 3 arguments</a></li>
<li><a href="HacktheBox--Linux_Boxes--node--privesc_to_root---usr-local-bin-backup--strace.html">strace</a></li>
<li><a href="HacktheBox--Linux_Boxes--node--privesc_to_root---usr-local-bin-backup--.-backup_(trolled).html">./backup (trolled)</a></li>
</ol>
<li><a href="HacktheBox--Linux_Boxes--node--privesc_to_root--badchars.html">badchars</a></li>
<li><a href="HacktheBox--Linux_Boxes--node--privesc_to_root--intended_privesc-_Buffer_Overflow.html">intended privesc- Buffer Overflow</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--node--privesc_to_root--intended_privesc-_Buffer_Overflow--check_for_overflowed_buffer.html">check for overflowed buffer</a></li>
<li><a href="HacktheBox--Linux_Boxes--node--privesc_to_root--intended_privesc-_Buffer_Overflow--pattern_create.html">pattern create</a></li>
<li><a href="HacktheBox--Linux_Boxes--node--privesc_to_root--intended_privesc-_Buffer_Overflow--python_-c_'print_A520'.html">python -c 'print "A"*520'</a></li>
<li><a href="HacktheBox--Linux_Boxes--node--privesc_to_root--intended_privesc-_Buffer_Overflow--buf.py.html">buf.py</a></li>
<li><a href="eBox--Linux_Boxes--node--privesc_to_root--intended_privesc-_Buffer_Overflow--find_libc,_system_off,_exit_off_and_arg_off_starting_address.html">find libc, system_off, exit_off and arg_off starting address</a></li>
<ol>
<li><a href="xes--node--privesc_to_root--intended_privesc-_Buffer_Overflow--find_libc,_system_off,_exit_off_and_arg_off_starting_address---lib32_files.html">/lib32 files</a></li>
</ol>
<li><a href="HacktheBox--Linux_Boxes--node--privesc_to_root--intended_privesc-_Buffer_Overflow--update_ret.html">update ret</a></li>
<li><a href="HacktheBox--Linux_Boxes--node--privesc_to_root--intended_privesc-_Buffer_Overflow--run_buf.py_win.html">run buf.py win</a></li>
</ol>
<li><a href="HacktheBox--Linux_Boxes--node--privesc_to_root--unintended_privesc_methods.html">unintended privesc methods</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--node--privesc_to_root--unintended_privesc_methods--avoiding_bad_characters_to_extract_root.txt.html">avoiding bad characters to extract root.txt</a></li>
<ol>
<li><a href="ox--Linux_Boxes--node--privesc_to_root--unintended_privesc_methods--avoiding_bad_characters_to_extract_root.txt--decode_and_unzip_and.....html">decode and unzip and....</a></li>
</ol>
<li><a href="HacktheBox--Linux_Boxes--node--privesc_to_root--unintended_privesc_methods--creating_a_symlink.html">creating a symlink</a></li>
<li><a href="HacktheBox--Linux_Boxes--node--privesc_to_root--unintended_privesc_methods--wildcards.html">wildcards</a></li>
<li><a href="HacktheBox--Linux_Boxes--node--privesc_to_root--unintended_privesc_methods--command_injection.html">command injection</a></li>
</ol>
</ol>
<li><a href="HacktheBox--Linux_Boxes--node--user-root.html">user/root</a></li>
<li><a href="HacktheBox--Linux_Boxes--node--lessons_learned.html">lessons learned</a></li>
</ol></div>
<div class="page"><h1><b><u>find libc, system_off, exit_off and arg_off starting address</u></b></h1><span style="color:#24ff00;">Next task is to find the memory addresses of </span><span style="color:#ffa500;">libc</span><span style="color:#24ff00;">, </span><span style="color:#ffa500;">system_off</span><span style="color:#24ff00;">, </span><span style="color:#ffa500;">exit_off </span><span style="color:#24ff00;">and </span><span style="color:#ffa500;">arg_off</span><span style="color:#24ff00;"><br /><br /></span><span style="color:#ffa500;">ldd /usr/local/bin/backup | grep libc .so.6</span><br /><img src="images/846-1.png" alt="images/846-1.png" /><br /><br />take (<span style="color:#ffff00;">0xf75c4000</span><span style="color:#24ff00;">)<br />and set </span><span style="color:#ffa500;">libc_base_addr </span><span style="color:#24ff00;">= </span><span style="color:#ffff00;">0xf75c4000</span><span style="color:#24ff00;"><br /><br /></span><strong><span style="color:#24ff00;">note:  the process address is randomized because of </span></strong><strong><span style="color:#ffff00;">ASLR</span></strong><br /><img src="images/846-2.png" alt="images/846-2.png" /> <br /><br /><br />----------------------------------------------------------------------------------------------------------------------------------------------------<br />next we need the <span style="color:#ffa500;">system_off</span><span style="color:#24ff00;"> bit address<br /><br /></span><span style="color:#ffa500;">readelf -s /lib32/libc.so.6 | grep </span><span style="color:#ffff00;">system</span><br /><img src="images/846-3.png" alt="images/846-3.png" /><br /><br /><br />take the address of the last one <span style="color:#ffff00;"> </span><span style="color:#24ff00;"><br />and  </span><span style="color:#ffa500;">set system_off</span><span style="color:#24ff00;"> </span><span style="color:#ffa500;">=</span><span style="color:#24ff00;"> </span><span style="color:#ffff00;">0003a940</span><br /><img src="images/846-4.png" alt="images/846-4.png" /><br /><br /><br /><br />----------------------------------------------------------------------------------------------------------------------------------------------------<br />next we need the <span style="color:#ffa500;">exit_off </span><span style="color:#24ff00;">address<br /></span><span style="color:#ffa500;">readelf -s /lib32/libc.so.6 | grep </span><span style="color:#ffff00;">exit</span><br /><img src="images/846-5.png" alt="images/846-5.png" /><br /><br />take the weak one <img src="images/846-6.png" alt="images/846-6.png" /><br />and <span style="color:#ffa500;">set exit_off = </span><span style="color:#ffff00;">0002e7d0</span><span style="color:#24ff00;"><br /><br /><br />----------------------------------------------------------------------------------------------------------------------------------------------------<br /><br />next we need the </span><span style="color:#ffa500;">arg_off</span><span style="color:#24ff00;"> bit address<br />which is a little different to retrieve, <br /></span><span style="color:#ffa500;">strings -a -t x /lib32/libc.so.6 | grep bin/sh</span><br /><img src="images/846-7.png" alt="images/846-7.png" /><br /><span style="color:#ffa500;">set arg_off </span><span style="color:#24ff00;">= </span><span style="color:#ffff00;">15900b</span><span style="color:#24ff00;"><br /><br />----------------------------------------------------------------------------------------------------------------------------------------------------<br />given our </span><span style="color:#ffff00;">libc</span><span style="color:#24ff00;">, </span><span style="color:#ffff00;">system_off</span><span style="color:#24ff00;">, </span><span style="color:#ffff00;">exit_off</span><span style="color:#24ff00;"> and </span><span style="color:#ffff00;">arg_off</span><span style="color:#24ff00;"> memory addresses our<br /></span><span style="color:#ffa500;">buff.py </span><span style="color:#24ff00;">should look like the following:<br /><br /></span><img src="images/846-8.png" alt="images/846-8.png" /><br /><br /><br /></div></div>
</body></html>