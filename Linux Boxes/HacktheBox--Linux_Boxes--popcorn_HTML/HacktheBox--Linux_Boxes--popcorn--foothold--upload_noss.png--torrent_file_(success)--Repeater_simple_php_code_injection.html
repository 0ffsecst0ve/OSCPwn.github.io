<!doctype html><html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Repeater simple php code injection</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="styles.css" type="text/css" />
</head>
<body><div class="main"><div class="tree">
<p><a href="../HacktheBox--Linux_Boxes.html">Linux Boxes</a></p>
<p><a href="HacktheBox--Linux_Boxes--popcorn.html">popcorn</a></p>

<ol>
<li><a href="HacktheBox--Linux_Boxes--popcorn--nmap.html">nmap</a></li>
<li><a href="HacktheBox--Linux_Boxes--popcorn--http.html">http</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--popcorn--http--dirbuster.html">dirbuster</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--popcorn--http--dirbuster---test.html">/test</a></li>
<li><a href="HacktheBox--Linux_Boxes--popcorn--http--dirbuster---torrent.html">/torrent</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--popcorn--http--dirbuster---torrent--register.html">register</a></li>
</ol>
</ol>
</ol>
<li><a href="HacktheBox--Linux_Boxes--popcorn--foothold.html">foothold </a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--popcorn--foothold--upload_save_directory.html">upload save directory</a></li>
<li><a href="HacktheBox--Linux_Boxes--popcorn--foothold--upload_noss.png.html">upload noss.png </a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--popcorn--foothold--upload_noss.png--kali_torrent_dl_and_upload_(fail).html">kali torrent dl and upload (fail)</a></li>
<li><a href="HacktheBox--Linux_Boxes--popcorn--foothold--upload_noss.png--test.torrent_(fail).html">test.torrent (fail)</a></li>
<li><a href="HacktheBox--Linux_Boxes--popcorn--foothold--upload_noss.png--torrent_file_(success).html">torrent file (success)</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--popcorn--foothold--upload_noss.png--torrent_file_(success)--edit_this_torrent-change_screenshot.html">edit this torrent/change screenshot</a></li>
<li><a href="HacktheBox--Linux_Boxes--popcorn--foothold--upload_noss.png--torrent_file_(success)--Repeater_simple_php_code_injection.html">Repeater simple php code injection</a></li>
<ol>
<li><a href="theBox--Linux_Boxes--popcorn--foothold--upload_noss.png--torrent_file_(success)--Repeater_simple_php_code_injection--wget_tcp_pty_handler.html">wget tcp_pty_handler</a></li>
<li><a href="HacktheBox--Linux_Boxes--popcorn--foothold--upload_noss.png--torrent_file_(success)--Repeater_simple_php_code_injection--reverse_shell.html">reverse shell</a></li>
</ol>
</ol>
</ol>
</ol>
<li><a href="HacktheBox--Linux_Boxes--popcorn--Privesc.html">Privesc</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--popcorn--Privesc--lse.sh.html">lse.sh</a></li>
<li><a href="HacktheBox--Linux_Boxes--popcorn--Privesc--MotD_Privesc.html">MotD Privesc</a></li>
<ol>
<li><a href="HacktheBox--Linux_Boxes--popcorn--Privesc--MotD_Privesc--14339.sh.html">14339.sh</a></li>
<li><a href="HacktheBox--Linux_Boxes--popcorn--Privesc--MotD_Privesc--14339.sh_raw_code.html">14339.sh raw code</a></li>
</ol>
<li><a href="HacktheBox--Linux_Boxes--popcorn--Privesc--root.html">root</a></li>
</ol></ol></div>
<div class="page"><h1><b><u>Repeater simple php code injection</u></b></h1><span style="color:#24ff00;">now we're going to take advantage of the server's poor file suffix sanitation check and upload a cmd.php and simply append a php command execution script at the very end of our .png magic byte sequence in order to trick the server into uploading our file to its </span><span style="color:#ffa500;">/upload </span><span style="color:#24ff00;">directory</span><br /><span style="color:#24ff00;">in repeater we tweak 2 things: our </span><span style="color:#ffff00;">filename</span><span style="color:#24ff00;"> </span><img src="images/12-1.png" alt="images/12-1.png" /><br /><br />and our picture metadata to add <span style="color:#ffa500;">&lt;?php echo system($_REQUEST[st0ve]); ?&gt;</span><span style="color:#24ff00;"> to allow Remote code execution once we visit the uploaded file</span><br /><img src="images/12-2.png" alt="images/12-2.png" /><br /><img src="images/12-3.png" alt="images/12-3.png" /><br /><br /><span style="color:#24ff00;">since the uploader doesn't check for file suffixes we can use what're known as ‘magic bytes’ which are the first line or two of special characters linux uses to decipher file types</span><br /><img src="images/12-4.png" alt="images/12-4.png" /><br /><br /><span style="color:#24ff00;">navigating to our .php file and setting our st0ve parameter to whoami yields:</span><br /><img src="images/12-5.png" alt="images/12-5.png" /><br /><span style="color:#24ff00;">command execution!</span><br /><img src="images/12-6.png" alt="images/12-6.png" /><br /><br />intercepting the web request on burp suite is a little easier to work with:<br /><img src="images/12-7.png" alt="images/12-7.png" /><br /><br /><img src="images/12-8.png" alt="images/12-8.png" /><br /></div></div>
</body></html>