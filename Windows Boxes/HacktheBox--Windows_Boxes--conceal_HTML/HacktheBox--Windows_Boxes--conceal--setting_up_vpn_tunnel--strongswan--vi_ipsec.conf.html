<!doctype html><html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>vi ipsec.conf</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="styles.css" type="text/css" />
</head>
<body><div class="main"><div class="tree">
<p><a href="../HacktheBox--Windows_Boxes.html">Windows Boxes</a></p>
<p><a href="HacktheBox--Windows_Boxes--conceal.html">conceal</a></p>

<ol>
<li><a href="HacktheBox--Windows_Boxes--conceal--nmap_Automator.html">nmap Automator</a></li>
<li><a href="HacktheBox--Windows_Boxes--conceal--setting_up_vpn_tunnel.html">setting up vpn tunnel</a></li>
<ol>
<li><a href="HacktheBox--Windows_Boxes--conceal--setting_up_vpn_tunnel--snmpwalk.html">snmpwalk</a></li>
<ol>
<li><a href="HacktheBox--Windows_Boxes--conceal--setting_up_vpn_tunnel--snmpwalk--crackstation.html">crackstation</a></li>
</ol>
<li><a href="HacktheBox--Windows_Boxes--conceal--setting_up_vpn_tunnel--snmp-check.html">snmp-check</a></li>
<li><a href="HacktheBox--Windows_Boxes--conceal--setting_up_vpn_tunnel--ike-scan.html">ike-scan</a></li>
<li><a href="HacktheBox--Windows_Boxes--conceal--setting_up_vpn_tunnel--strongswan.html">strongswan</a></li>
<ol>
<li><a href="HacktheBox--Windows_Boxes--conceal--setting_up_vpn_tunnel--strongswan--vi_-etc-ipsec.secrets.html">vi /etc/ipsec.secrets</a></li>
<li><a href="HacktheBox--Windows_Boxes--conceal--setting_up_vpn_tunnel--strongswan--vi_ipsec.conf.html">vi ipsec.conf</a></li>
<li><a href="HacktheBox--Windows_Boxes--conceal--setting_up_vpn_tunnel--strongswan--start_tunnel.html">start tunnel</a></li>
<ol>
<li><a href="HacktheBox--Windows_Boxes--conceal--setting_up_vpn_tunnel--strongswan--start_tunnel--troubleshooting_with_netgate.html">troubleshooting with netgate</a></li>
</ol>
</ol>
<li><a href="HacktheBox--Windows_Boxes--conceal--setting_up_vpn_tunnel--tunnel_success_verification.html">tunnel success verification</a></li>
</ol>
<li><a href="HacktheBox--Windows_Boxes--conceal--potential_tunnel_issue_fixes.html">potential tunnel issue fixes</a></li>
<li><a href="HacktheBox--Windows_Boxes--conceal--initial_foothold.html">initial foothold</a></li>
<ol>
<li><a href="HacktheBox--Windows_Boxes--conceal--initial_foothold--http.html">http</a></li>
<li><a href="HacktheBox--Windows_Boxes--conceal--initial_foothold--gobuster.html">gobuster</a></li>
<li><a href="HacktheBox--Windows_Boxes--conceal--initial_foothold--ftp.html">ftp</a></li>
<ol>
<li><a href="HacktheBox--Windows_Boxes--conceal--initial_foothold--ftp--test.aspx.html">test.aspx</a></li>
<li><a href="HacktheBox--Windows_Boxes--conceal--initial_foothold--ftp--test.asp.html">test.asp</a></li>
<ol>
<li><a href="HacktheBox--Windows_Boxes--conceal--initial_foothold--ftp--test.asp--revshell.asp.html">revshell.asp</a></li>
</ol>
</ol>
<li><a href="HacktheBox--Windows_Boxes--conceal--initial_foothold--tennc_webshell_github.html">tennc webshell github</a></li>
<ol>
<li><a href="HacktheBox--Windows_Boxes--conceal--initial_foothold--tennc_webshell_github--picking_webshell_payload.html">picking webshell payload</a></li>
<li><a href="HacktheBox--Windows_Boxes--conceal--initial_foothold--tennc_webshell_github--nishang_reverse_shell.html">nishang reverse shell</a></li>
<li><a href="HacktheBox--Windows_Boxes--conceal--initial_foothold--tennc_webshell_github--reverse_shell.html">reverse shell</a></li>
</ol>
</ol>
<li><a href="HacktheBox--Windows_Boxes--conceal--privesc.html">privesc</a></li>
<ol>
<li><a href="HacktheBox--Windows_Boxes--conceal--privesc--windows-exploit_suggester.html">windows-exploit suggester</a></li>
<ol>
<li><a href="HacktheBox--Windows_Boxes--conceal--privesc--windows-exploit_suggester--systeminfo.html">systeminfo</a></li>
</ol>
<li><a href="HacktheBox--Windows_Boxes--conceal--privesc--whoami_-priv.html">whoami /priv</a></li>
<li><a href="HacktheBox--Windows_Boxes--conceal--privesc--juicy_potato.html">juicy potato</a></li>
<ol>
<li><a href="HacktheBox--Windows_Boxes--conceal--privesc--juicy_potato--rerun_with_correct_CLSID.html">rerun with correct CLSID</a></li>
<li><a href="HacktheBox--Windows_Boxes--conceal--privesc--juicy_potato--rev_shell_to_nt_auth.html">rev shell to nt auth</a></li>
</ol>
</ol>
<li><a href="HacktheBox--Windows_Boxes--conceal--user-root.html">user/root</a></li>
<li><a href="HacktheBox--Windows_Boxes--conceal--lessons_learned.html">lessons learned</a></li>
</ol></div>
<div class="page"><h1><b><u>vi ipsec.conf</u></b></h1><span style="color:#24ff00;">to configure our </span><span style="color:#ffa500;">tunnel</span><span style="color:#24ff00;"> we're going to need to add a </span><span style="color:#ffff00;">connection profile</span><span style="color:#24ff00;"> to our </span><span style="color:#ffa500;">ipsec.conf </span><span style="color:#24ff00;">file<br /><br />first we declare our </span><span style="color:#ffff00;">tunnel name</span><span style="color:#24ff00;"> </span><span style="color:#ffa500;">conceal</span><br /><img src="images/1392-1.png" alt="images/1392-1.png" /><br /><br /><br /><img src="images/1392-2.png" alt="images/1392-2.png" /><br /><strong><span style="color:#ffa500;">type</span></strong>:<span style="color:#24ff00;"> we use </span><span style="color:#ffff00;">trial and error </span><span style="color:#24ff00;">on the tunnel being either </span><strong><span style="color:#ffa500;">tunnel</span></strong><span style="color:#24ff00;"> OR </span><strong><span style="color:#ffa500;">transport</span></strong><span style="color:#24ff00;"> type and see which one works<br /></span><img src="images/1392-3.png" alt="images/1392-3.png" /><br /><br />next we set <span style="color:#ffa500;">keyexchange</span><span style="color:#24ff00;"> <br />because our ike-scan reported </span><img src="images/1392-4.png" alt="images/1392-4.png" /><br /><img src="images/1392-5.png" alt="images/1392-5.png" /><br /><br /><br />next we set <span style="color:#ffa500;">left</span><span style="color:#24ff00;"> (think left side of the connection or our attacking machine IP)<br /></span><img src="images/1392-6.png" alt="images/1392-6.png" /><br /><br />next we set <span style="color:#ffa500;">right</span>,<span style="color:#24ff00;"> or conceal's IP address<br /></span><img src="images/1392-7.png" alt="images/1392-7.png" /><br /><br />next we set <span style="color:#ffff00;">authentication type</span><span style="color:#24ff00;"> which is </span><span style="color:#ffa500;">authby</span><span style="color:#24ff00;"> to </span><span style="color:#ffa500;">pre-shared key</span><span style="color:#24ff00;"> or '</span><span style="color:#ffa500;">psk</span><span style="color:#24ff00;">'<br /></span><img src="images/1392-8.png" alt="images/1392-8.png" /><br /><br />next we set the <span style="color:#ffff00;">encapsulting security payload </span><span style="color:#24ff00;">or ‘</span><span style="color:#ffa500;">esp</span><span style="color:#24ff00;">’ which is </span><img src="images/1392-9.png" alt="images/1392-9.png" /> and <img src="images/1392-10.png" alt="images/1392-10.png" /><br /><img src="images/1392-11.png" alt="images/1392-11.png" /><br /><br />next we set the<span style="color:#ffff00;"> internet key exchange </span><span style="color:#24ff00;">or</span><span style="color:#ffa500;"> IKE key</span><span style="color:#24ff00;"> which is </span><span style="color:#ffa500;">3des-sha1-modp24</span><span style="color:#24ff00;"> </span><img src="images/1392-12.png" alt="images/1392-12.png" /><br /><img src="images/1392-13.png" alt="images/1392-13.png" /><br /><br />next we do <span style="color:#ffa500;">lifetime</span><span style="color:#24ff00;"> </span><img src="images/1392-14.png" alt="images/1392-14.png" /> which we know is <span style="color:#ffff00;">8 hours</span><span style="color:#24ff00;"> from our hex to decimal to hours</span><br /><img src="images/1392-15.png" alt="images/1392-15.png" /><br /><br /><span style="color:#24ff00;">finally we add and </span><span style="color:#ffa500;">auto=start</span> <span style="color:#24ff00;">parameter</span><br /><br /><strong><span style="color:#24ff00;">our connection tunnel profile looks like this:</span></strong><br /><img src="images/1392-16.png" alt="images/1392-16.png" /><br /><br /><span style="color:#24ff00;">also its nice to add </span><span style="color:#ffa500;">fragmentation=yes</span><span style="color:#24ff00;"> since it is supported in the </span><span style="color:#ffa500;">ike-scan</span><br /><img src="images/1392-17.png" alt="images/1392-17.png" /><br /><br /><img src="images/1392-18.png" alt="images/1392-18.png" /><br /><br /></div></div>
</body></html>