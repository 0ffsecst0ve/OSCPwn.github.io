<!doctype html><html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>GPP Vuln</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="styles.css" type="text/css" />
</head>
<body><div class="main"><div class="tree">
<p><a href="../HacktheBox--Windows_Boxes.html">Windows Boxes</a></p>
<p><a href="HacktheBox--Windows_Boxes--Active.html">Active</a></p>

<ol>
<li><a href="HacktheBox--Windows_Boxes--Active--nmap.html">nmap</a></li>
<ol>
<li><a href="HacktheBox--Windows_Boxes--Active--nmap--all_ports_scan.html">all ports scan</a></li>
</ol>
<li><a href="HacktheBox--Windows_Boxes--Active--smbclient.html">smbclient</a></li>
<ol>
<li><a href="HacktheBox--Windows_Boxes--Active--smbclient--smbclient_bypass.html">smbclient bypass</a></li>
<li><a href="HacktheBox--Windows_Boxes--Active--smbclient--GPP_Vuln.html">GPP Vuln</a></li>
</ol>
<li><a href="HacktheBox--Windows_Boxes--Active--kerberoast.html">kerberoast</a></li>
<ol>
<li><a href="HacktheBox--Windows_Boxes--Active--kerberoast--hashcat_krb5tgs.html">hashcat krb5tgs</a></li>
<li><a href="HacktheBox--Windows_Boxes--Active--kerberoast--notes.html">notes</a></li>
</ol>
<li><a href="HacktheBox--Windows_Boxes--Active--Kerberost_to_Win_(smbexec_&_meta).html">Kerberost to Win (smbexec & meta)</a></li>
<li><a href="HacktheBox--Windows_Boxes--Active--User-Root.html">User/Root</a></li>
</ol></div>
<div class="page"><h1><b><u>GPP Vuln</u></b></h1><span style="color:#24ff00;">searching through Active's insecure smb share we come accross the file</span> <span style="color:#ffff00;">\active.htb\Policies\{31B2F340-016D-11D2-945F-00C04FB984F9}\MACHINE\Preferences\Groups\Groups.xml <br /></span><br /><span style="color:#24ff00;">and find there is a </span><span style="color:#ffa500;">GPP</span><span style="color:#24ff00;"> or </span><span style="color:#ffa500;">Group Policy Preferences</span><span style="color:#24ff00;"> </span><span style="color:#ffff00;">Password</span><span style="color:#24ff00;"> stored in cpassword variable<br /></span><img src="images/107-1.png" alt="images/107-1.png" /><br /><br />Crack password with <span style="color:#ffa500;">gpp-decrypt &lt;PW&gt;</span><br /><img src="images/107-2.png" alt="images/107-2.png" /><br /><span style="color:#24ff00;">Password is </span><span style="color:#ffff00;">GPPstillStandingStrong2k18</span><br /><br /><span style="color:#24ff00;">Notes:<br /></span>1. <span style="color:#191905;">we just decrypted not just any service account on this windows active directory but its Ticket granting service, bypassing our need to run AD network mapping software like sharphound/bloodhound, this is a huge find and a gaping vulnerability on this machine.<br />2. Owning the TGS service will allow an attacker to generate tickets that will authenticate any user they want at any privilege level they want...<br />3. GPP is an outdated and easily brute-forced encryption algorithum that needs to be upgraded for a more hardened network infrastructure</span></div></div>
</body></html>