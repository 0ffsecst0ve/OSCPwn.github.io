<!doctype html><html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>internal-01.bart.htb/log/log.php?filename=log.txt&username=harvey</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="styles.css" type="text/css" />
</head>
<body><div class="main"><div class="tree">
<p><a href="../HacktheBox--Windows_Boxes.html">Windows Boxes</a></p>
<p><a href="HacktheBox--Windows_Boxes--bart.html">bart</a></p>

<ol>
<li><a href="HacktheBox--Windows_Boxes--bart--note.html">note</a></li>
<li><a href="HacktheBox--Windows_Boxes--bart--nmap.html">nmap</a></li>
<li><a href="HacktheBox--Windows_Boxes--bart--http_enumeration.html">http enumeration</a></li>
<ol>
<li><a href="HacktheBox--Windows_Boxes--bart--http_enumeration--gobuster.html">gobuster</a></li>
<ol>
<li><a href="HacktheBox--Windows_Boxes--bart--http_enumeration--gobuster--forum.html">forum</a></li>
<ol>
<li><a href="HacktheBox--Windows_Boxes--bart--http_enumeration--gobuster--forum--source_code.html">source code</a></li>
</ol>
<li><a href="HacktheBox--Windows_Boxes--bart--http_enumeration--gobuster--monitor.html">monitor</a></li>
<ol>
<li><a href="HacktheBox--Windows_Boxes--bart--http_enumeration--gobuster--monitor--forgot_password_page.html">forgot password page</a></li>
<li><a href="HacktheBox--Windows_Boxes--bart--http_enumeration--gobuster--monitor--creds.html">creds</a></li>
<ol>
<li><a href="HacktheBox--Windows_Boxes--bart--http_enumeration--gobuster--monitor--creds--servers.html">servers</a></li>
</ol>
</ol>
</ol>
<li><a href="HacktheBox--Windows_Boxes--bart--http_enumeration--internal-01.bart.htb.html">internal-01.bart.htb</a></li>
<ol>
<li><a href="HacktheBox--Windows_Boxes--bart--http_enumeration--internal-01.bart.htb--gobuster_internal-01.bart.htb.html">gobuster internal-01.bart.htb</a></li>
<li><a href="HacktheBox--Windows_Boxes--bart--http_enumeration--internal-01.bart.htb--hydra.html">hydra</a></li>
<ol>
<li><a href="HacktheBox--Windows_Boxes--bart--http_enumeration--internal-01.bart.htb--hydra--bruteforced_user_harvey_login.html">bruteforced user harvey login</a></li>
</ol>
<li><a href="HacktheBox--Windows_Boxes--bart--http_enumeration--internal-01.bart.htb--simple_chat.html">simple_chat</a></li>
<ol>
<li><a href="HacktheBox--Windows_Boxes--bart--http_enumeration--internal-01.bart.htb--simple_chat--register_form.php.html">register_form.php</a></li>
<li><a href="HacktheBox--Windows_Boxes--bart--http_enumeration--internal-01.bart.htb--simple_chat--registered_user_st0ve_login.html">registered user st0ve login</a></li>
</ol>
</ol>
<li><a href="HacktheBox--Windows_Boxes--bart--http_enumeration--initial_foothold.html">initial foothold</a></li>
<ol>
<li><a href="HacktheBox--Windows_Boxes--bart--http_enumeration--initial_foothold--internal-01.bart.htb-log-log.phpfilename=log.txt&username=harvey.html">internal-01.bart.htb/log/log.php?filename=log.txt&username=harvey</a></li>
<li><a href="HacktheBox--Windows_Boxes--bart--http_enumeration--initial_foothold--log.txt_poison_w-_code_execution.html">log.txt poison w/ code execution</a></li>
<li><a href="HacktheBox--Windows_Boxes--bart--http_enumeration--initial_foothold--reverse_shell_w-_nishang.html">reverse shell w/ nishang</a></li>
</ol>
</ol>
<li><a href="HacktheBox--Windows_Boxes--bart--priv_esc.html">priv esc</a></li>
<ol>
<li><a href="HacktheBox--Windows_Boxes--bart--priv_esc--juicy_potato.html">juicy potato</a></li>
<li><a href="HacktheBox--Windows_Boxes--bart--priv_esc--download_jp.exe_&_shell.bat_to_victim.html">download jp.exe & shell.bat to victim</a></li>
<li><a href="HacktheBox--Windows_Boxes--bart--priv_esc--jp.exe.html">jp.exe</a></li>
</ol>
<li><a href="HacktheBox--Windows_Boxes--bart--user-root.html">user/root</a></li>
<li><a href="HacktheBox--Windows_Boxes--bart--lessons_learned.html">lessons learned</a></li>
</ol></div>
<div class="page"><h1><b><u>internal-01.bart.htb/log/log.php?filename=log.txt&username=harvey</u></b></h1><span style="color:#24ff00;">when we navigate to the page </span><br /><span style="color:#ffa500;">http://internal-01.bart.htb/log/log.php?filename=log.txt&amp;username=harvey</span> <img src="images/1679-1.png" alt="images/1679-1.png" /><br /><br /><span style="color:#24ff00;">we see that the page displays harvey's username but also displays OUR OWN User-agent </span><img src="images/1679-2.png" alt="images/1679-2.png" />, lets mess with it and see if we can<span style="color:#ffa500;"> inject remote code execution</span><span style="color:#24ff00;"> into the log.php file and run it </span><br /><img src="images/1679-3.png" alt="images/1679-3.png" /><br /><br /><img src="images/1679-4.png" alt="images/1679-4.png" /><br /><span style="color:#24ff00;">we get a strange response of only</span><span style="color:#ffa500;"> 1</span><span style="color:#24ff00;">, but we do see that there is a filename pointing to some file located on the server, so lets mess around with that</span><br /><br /><span style="color:#24ff00;">if we switch the </span><span style="color:#ffa500;">filename</span><span style="color:#24ff00;"> parameter equal to the file </span><span style="color:#ffa500;">log</span><span style="color:#24ff00;"> instead of </span><span style="color:#ffa500;">log.php</span><span style="color:#24ff00;">...</span><br /><img src="images/1679-5.png" alt="images/1679-5.png" /><br /><br /><span style="color:#24ff00;">we see the log output of the log.php get request we sent from before! and even more interesting....</span><br /><img src="images/1679-6.png" alt="images/1679-6.png" /><br /><br /><span style="color:#24ff00;">we see our </span><span style="color:#ffa500;">user-agent</span><span style="color:#24ff00;"> was saved in the log form</span><br /><img src="images/1679-7.png" alt="images/1679-7.png" /><br /><img src="images/1679-8.png" alt="images/1679-8.png" /><br /><br /><span style="color:#24ff00;">Meaning, we may be able to </span><span style="color:#ffff00;">poison</span><span style="color:#24ff00;"> the </span><span style="color:#ffa500;">log.txt</span><span style="color:#24ff00;"> file on Bart's server by altering our </span><span style="color:#ffa500;">user-agent field</span><span style="color:#24ff00;"> when sending </span><span style="color:#ffa500;">Get requests</span><span style="color:#24ff00;"> to the </span><span style="color:#ffa500;">log.php</span><span style="color:#24ff00;"> </span><span style="color:#ffa500;">file</span><span style="color:#24ff00;">!</span></div></div>
</body></html>